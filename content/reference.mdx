---
title: API reference
description: Complete reference documentation for the Knock API. Includes code snippets and examples for our Python, Elixir, PHP, Node.js, Go, Ruby, and .NET libraries.
showNav: false
layout: api
tags: ["api", "sdks", "api key", "keys", "errors"]
---

<a id="overview" className="absolute -top-8 invisible" />

<Section title="API reference" slug="overview">
<ContentColumn>
The Knock API enables you to add a complete notification engine to your product. This API provides
programmatic access to integrating Knock via a REST-ful API.

</ContentColumn>
<ExampleColumn>

```bash title="Base URL"
https://api.knock.app/v1
```

</ExampleColumn>

</Section>

<Section title="Client libraries" slug="client-libraries">
<ContentColumn>

Knock offers native SDKs in several popular programming languages:

- [Node JS](https://github.com/knocklabs/knock-node)
- [Python](https://github.com/knocklabs/knock-python)
- [Ruby](https://github.com/knocklabs/knock-ruby)
- [Go](https://github.com/knocklabs/knock-go)
- [PHP](https://github.com/knocklabs/knock-php)
- [Java](https://github.com/knocklabs/knock-java)
- [C# (dotnet)](https://github.com/knocklabs/knock-dotnet)
- [Elixir](https://github.com/knocklabs/knock-elixir)

</ContentColumn>
</Section>

<Section title="API keys" slug="api-keys">
<ContentColumn>

Knock authenticates your API requests using your account's API keys. API requests made without authentication or using an incorrect key will return a 401 error. Requests using a valid key but with insufficient permissions will return a 403 error.

You can view and manage your API keys in the Developer Dashboard. There are two types of API keys:

- Publishable keys are only meant to identify your account with Knock. They aren't secret, and can safely be made public in any of your client-side code. Publishable keys are prefixed with `pk_*`.

- Secret keys can perform any API request to Knock, they should be kept secure and private! Be sure to prevent secret keys from being made publicly accessible, such as in client-side code, GitHub, unsecured S3 buckets, and so forth. Secret keys are prefixed with `sk_*`.

Each Environment in your account has both a publishable and secret key pair. API requests will be scoped to the provided key's Environment.

</ContentColumn>
</Section>

<Section title="Authentication" slug="authentication">
<ContentColumn>

You must pass your API key to Knock as a Bearer token using the `Authorization` header.

</ContentColumn>
<ExampleColumn>

```bash title="Authentication header"
Authorization: Bearer sk_test_12345
```

</ExampleColumn>
</Section>

<Section title="Rate limits" slug="rate-limits">
<ContentColumn>

Each endpoint in the Knock API is rate limited. Knock uses a tier system to determine the rate limit scale for each endpoint. When your request has been rate limited, the Knock API will return a `429 Too Many Requests` error in response.

<Callout
  emoji="ðŸ’¡"
  title="Rate limit tiers are assigned per-endpoint."
  text={
    <>
      Knock does not have separate rate limit tiers for different accounts or
      pricing plans. Each endpoint in this reference has a rate limit tier label
      that indicates the scale of requests you can make to that endpoint.
    </>
  }
/>

Knock's default behavior scopes rate limits based on the authorizing credential used in your requests. When you use a public or private API key to authorize a request, Knock will scope the rate limit for each endpoint by the [environment](/concepts/environments) associated with the key. If you use a signed user token as your authorizing credential, Knock will scope the rate limit by both the key's environment and the signing user. See our guide on [enhanced security mode](/in-app-ui/security-and-authentication#authentication-with-enhanced-security) for more details on working with signed user tokens.

If you're concerned about exceeding a Knock rate limit, please [contact us](https://knock.app/contact-sales) and we can help figure out a usage rate that's right for your specific needs.

</ContentColumn>
<ExampleColumn>

<div className="prose-sm lg:prose dark:prose-invert">
  <table>
    <thead>
      <tr>
        <th>Scale</th>
        <th>Limit</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          <RateLimit tier={1} />
        </td>
        <td>1 request / second</td>
      </tr>
      <tr>
        <td>
          <RateLimit tier={2} />
        </td>
        <td>5 requests / second</td>
      </tr>
      <tr>
        <td>
          <RateLimit tier={3} />
        </td>
        <td>60 requests / second</td>
      </tr>
      <tr>
        <td>
          <RateLimit tier={4} />
        </td>
        <td>200 requests / second</td>
      </tr>
      <tr>
        <td>
          <RateLimit tier={5} />
        </td>
        <td>1,000 requests / second</td>
      </tr>
    </tbody>
  </table>
</div>

</ExampleColumn>
</Section>

<Section title="Batch and bulk endpoint deduplication rate limits" slug="batch-rate-limits">
<ContentColumn>

Knock's batch and bulk endpoints may also have an additional layer of rate limiting applied. For these cases, Knock will also limit the number of times you can update a specific entity over a given scale. These limits are in place to prevent too many duplicate modifications applied to the same set of entities.

When you exceed a batch deduplication rate limit, Knock will still return a success (`2xx`) response if it is able to handle the request. For any entities not updated due to a rate limit hit, Knock will return the data as it exists at request time. Knock will also include an `x-ratelimited-{param}` header. The `{param}` value will be the name of the request param within which the rate limit was applied. The value will be a comma-delimited string of the param values that were rejected due to a rate limit hit.

Knock can apply batch deduplication rate limits to all or part of a request. If Knock rejects a subset of your batch, you can expect to see the full set of requested entities in the response body, and the IDs of those that were rejected in the `x-ratelimited-{param}` header.

</ContentColumn>
<ExampleColumn>

<div className="prose-sm lg:prose dark:prose-invert mb-6">
  <table>
    <thead>
      <tr>
        <th>Scale</th>
        <th>Limit</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          <RateLimit isBatch tier={1} />
        </td>
        <td>1 update / second / entity</td>
      </tr>
    </tbody>
  </table>
</div>

```json title="Example request body"
{
  "message_ids": [1, 2, 3, 4]
}
```

```json title="Example response body"
[
  { "__typename": "Message", "id": 1 },
  { "__typename": "Message", "id": 2 },
  { "__typename": "Message", "id": 3 },
  { "__typename": "Message", "id": 4 }
]
```

```json title="Example response header"
{
  "x-ratelimited-message_ids": "2,4"
}
```

</ExampleColumn>
</Section>

<Section title="Idempotent requests" slug="idempotent-requests">
<ContentColumn>

Knock supports [idempotency](https://en.wikipedia.org/wiki/Idempotence) so that requests can be retried safely without unintended side effects.

To perform an idempotent request, set an `Idempotency-Key` header on your request. This idempotency key is a unique value that you generate for each request. It is used to identify and prevent the duplicate processing of requests. If you retry a request with the same idempotency key within 24 hours from the original request, Knock will return the same response as the original request. You may use any string up to 255 characters in length as an idempotency key.

Idempotency keys can be random UUIDs, or they can have some meaning in your application. For example, if you are sending a notification after a user has placed an order, you could use a key that is a combination of the reason for the notification, the user ID, and the order ID (e.g. `order-placed:user-123:order-456`). If your user then cancels the order, you could use an idempotency key like `order-cancelled:user-123:order-456`. This will ensure each type of notification is only sent once, even if your system retries the request multiple times.

If you are making calls to Knock from a job queue, the ID of the job can be a good choice for an idempotency key. If the job fails and is retried, the same idempotency key will be used.

<Callout
  emoji="ðŸ’¡"
  title="The default idempotency window for the Knock API is 24 hours."
  text={
    <>
      If you're interested in configuring a different idempotency window for
      your account, please contact us at{" "}
      <a href="mailto:support@knock.app">support@knock.app</a>.
    </>
  }
/>

</ContentColumn>
<ExampleColumn>

<Endpoints title="Supported endpoints">
  <Endpoint
    name="trigger-workflow"
    method="POST"
    path="/workflows/:key/trigger"
    withLink
  />
</Endpoints>

<MultiLangCodeBlock
  snippet="api.idempotency"
  title="Making an idempotent API call"
/>

```json title="Response headers"
{
  "idempotent-replayed": "true",
  "original-x-request-id": "F1FIj5XwD_m4h0sAASfi"
}
```

</ExampleColumn>
</Section>

<Section title="Data retention" slug="data-retention">
<ContentColumn>

Several V1 API endpoints return data that is subject to deletion according to the data retention policy associated with your account. These endpoints are tagged with the `Retention policy applied` badge.

For more information, see the [data retention docs](/manage-your-account/data-retention).

</ContentColumn>
</Section>

<Section title="Bulk endpoints" slug="bulk-endpoints">
<ContentColumn>

Knock exposes several endpoints that enqueue and return a `BulkOperation`. These endpoints perform their logic asynchronously, and you use the `BulkOperation` record to track progress.

In some cases, a bulk endpoint will accept a large set of entities to perform some action upon. In others, a bulk endpoint will accept a set of filter parameters and then execute an action across a large set of data on your account.

See the [Bulk operations section](#bulk-operations) for more information on parsing and polling bulk operation statuses.

</ContentColumn>
</Section>

<Section title="Trigger data filtering" slug="trigger-data-filtering">
<ContentColumn>

Some V1 API endpoints that return lists of message data accept a `trigger_data` parameter. Knock uses this parameter to scope results it returns down to messages generated with the trigger data you provide.

The trigger data that Knock filters against is the _**combined and truncated data from the time the message was generated**_.

If a batch step preceded the creation of your message, the trigger data available for filtering will be the combined data for all the workflow triggers bundled into your batch. If a fetch step preceded, then the filterable data will include any data pulled in via the fetch step request.

Knock truncates trigger data for filtering to ensure it can efficiently process your request. The current data truncation rules are:

- Nested data structures (objects and arrays) are removed. Trigger data for filtering will be a JSON object with a single level of key-value pairs.
- Supported values are the JSON scalars string, number, boolean, and `null`.
- String values are limited to 256 characters in length. Strings that exceed this limit are truncated to the maximum.

</ContentColumn>
</Section>

<Section title="Pagination" slug="pagination">
<ContentColumn>

All top-level API resources expose support for bulk fetches via a `list` method. For instance, you can [list users](#list-users), [list objects](#list-objects) in a collection, and [list subscriptions](#list-subscriptions).

Resources that return multiple entities support the same cursor-based pagination to interact with the resources, using `after`, `before`, and `page_size` parameters as well as returning a common format for the metadata associated with the page.

### Query parameters

<Attributes>
  <Attribute
    name="after"
    type="string"
    description="The pagination cursor to fetch items after. Usually derived from the after cursor in `PageInfo`."
  />
  <Attribute
    name="before"
    type="string"
    description="The pagination cursor to fetch items before. Usually derived from the before cursor in `PageInfo`."
  />
  <Attribute
    name="page_size"
    type="number (optional)"
    description="A number between 1 and 50 that represents the number of items to return in the response. Defaults to 50."
  />
</Attributes>

### Response format

<Attributes>
  <Attribute
    name="entries"
    type="object[]"
    description="A list of items contained in this response"
  />
  <Attribute
    name="page_info"
    type="PageInfo"
    description="Metadata about the page of data returned"
  />
</Attributes>

### PageInfo response details

<Attributes>
  <Attribute
    name="after"
    type="string"
    description="The cursor to use to fetch items after the last item in the list. May be null when there are no other items to retrieve."
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to use to fetch items before the first item in the list. May be null when there are no other items to retrieve."
  />
  <Attribute
    name="page_size"
    type="number"
    description="The maximum number of items requested in the page"
  />
  <Attribute
    name="total_count"
    type="number"
    description="The total number of items in this resource (up-to 10,000)"
  />
</Attributes>

</ContentColumn>

<ExampleColumn>

```json title="Response"
{
  "entries": [
    {
      "__typename": "User",
      "id": "user_1",
      "name": "User name",
      "email": "user-1@example.com",
      "created_at": null,
      "updated_at": "2021-03-05T12:00:00Z"
    },
    {
      "__typename": "User",
      "id": "user_2",
      "name": "User name",
      "email": "user-2@example.com",
      "created_at": null,
      "updated_at": "2021-03-05T12:00:00Z"
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "page_size": 50,
    "total_count": 2,
    "after": null,
    "before": null
  }
}
```

</ExampleColumn>
</Section>

<Section title="Errors" slug="errors" direction="column">
<ContentColumn>

Knock uses standard [HTTP response codes](https://developer.mozilla.org/en-US/Web/HTTP/Status) to indicate the success or failure of your API requests.

- `2xx` success status codes confirm that your request worked as expected.

- `4xx` error status codes indicate an error caused by incorrect or missing request information (e.g. providing an incorrect API key).

- `5xx` error status codes indicate a Knock server error.

</ContentColumn>
</Section>

<Section title="Error codes" slug="error-codes" direction="column">
<div className="w-full">

<span className="mb-6">
  {"Here's a list of common "}
  <span className="bg-code-background text-code rounded text-sm font-normal py-0.75 px-1.5 font-mono inline-block border-1 border-gray-200">
    4xx
  </span>
  {
    " error codes you may encounter while working with the Knock API. We also provide additional context on how to resolve them."
  }
</span>

<ErrorExample
  title="actor_missing"
  description="You called a workflow with an actor that has not yet been identified in Knock. To resolve, identify the actor prior to passing their ID in a workflow trigger."
/>

<ErrorExample
  title="api_key_expired"
  description="Your API key has expired. You can regenerate one on the developers page of the Knock dashboard."
/>

<ErrorExample
  title="api_key_missing"
  description="The API key you provided is invalid."
/>

<ErrorExample
  title="authentication_required"
  description="This endpoint requires authentication. Check the Authentication section of this API reference for more information."
/>

<ErrorExample
  title="channel_invalid"
  description="The channel you supplied in this request is invalid. A common cause of this error is that the channel you're referencing has not yet been configured in the current environment."
/>

<ErrorExample
  title="incorrect_token_type"
  description="You cannot call this endpoint with this token."
/>

<ErrorExample
  title="invalid_params"
  description="The parameters supplied in your request were invalid. Check the payload you're sending to Knock to make sure it's valid."
/>

<ErrorExample
  title="invalid_user_token"
  description="The user token supplied is invalid."
/>

<ErrorExample
  title="missing_jwt_signing_key"
  description={
    <p>
      <span>
        Your request needs a JWT signing key. You can learn more about JWT
        signing keys in our{" "}
      </span>
      <a
        href="/client-integration/authenticating-users"
        className="text-brand underline"
      >
        client authentication docs.
      </a>
    </p>
  }
/>

<ErrorExample
  title="missing_user_token"
  description={
    <p>
      This environment requires that you supply a `X-Knock-User-Token` header
      when using a public API key. You can learn more in our{" "}
      <a
        href="/client-integration/authenticating-users"
        className="text-brand underline"
      >
        client authentication docs.
      </a>
    </p>
  }
/>

<ErrorExample
  title="workflow_inactive"
  description={
    <p>
      The workflow you attempted to invoke is marked with an inactive{" "}
      <a
        href="/concepts/workflows#workflow-status"
        className="text-brand underline"
      >
        status
      </a>
      . To resolve this error, activate the workflow on its page in the dashboard.
    </p>
  }
/>

<ErrorExample
  title="workflow_missing"
  description="The workflow you attempted to invoke could not be found. To resolve this error, confirm that you're calling the correct environment and that your workflow has been committed to it."
/>

</div>
</Section>

<Section title="Workflows" slug="workflows">
<ContentColumn>

A [Workflow](/concepts/workflows) orchestrates the delivery of messages to your end users. When you configure a workflow you'll determine which channels its messages should route to, what those messages should look like on each channel, as well as any functionsâ€”batch, throttle, digestâ€”you want applied to the messages prior to delivery. A workflow is triggered by a `trigger` call, usually when something occurs in your product that you want your users to know about (e.g. a new comment.)

</ContentColumn>
<ExampleColumn>
<Endpoints>
  <Endpoint
    name="trigger-workflow"
    method="POST"
    path="/workflows/:key/trigger"
    withLink
  />
  <Endpoint
    name="cancel-workflow"
    method="POST"
    path="/workflows/:key/cancel"
    withLink
  />
</Endpoints>

</ExampleColumn>
</Section>

<Section isIdempotent title="Triggering a workflow" slug="trigger-workflow">
<ContentColumn>

Invokes the workflow with the given key for the given set of recipients. Each recipient will have a workflow run triggered for them against the latest committed version of the workflow in the environment.

Read more about [triggering a workflow](/send-notifications/triggering-workflows).

This endpoint will return errors in the following cases:

- The workflow does not exist, or has not been committed to the environment
- The workflow's [status](/concepts/workflows#workflow-status) is set to inactive
- The trigger data does not match the schema defined for the workflow ([learn more](/developer-tools/validating-trigger-data))

### Endpoint

<Endpoint method="POST" path="/workflows/:key/trigger" />

### Rate limit

<RateLimit tier={5} />

### Payload size limit

The workflow trigger endpoint enforces the following payload size limits:

- The `data` payload must be no more than `10MB`
- The `recipients` list must not exceed 1000 entries

### Path parameters

<Attributes>
  <Attribute
    name="key"
    type="string"
    description="The key of the workflow to call"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="recipients"
    type="RecipientIdentifier[] (required)"
    description="A list of user identifiers, object references, or inline recipient definitions to run this workflow for"
    typeSlug="/concepts/recipients#recipientidentifier-definition"
  />
  <Attribute
    name="actor"
    type="RecipientIdentifier (optional)"
    description="An identifier of who or what performed this action"
    typeSlug="/concepts/recipients#recipientidentifier-definition"
  />
  <Attribute
    name="cancellation_key"
    type="string (optional)"
    description="The key to use for canceling the workflow"
  />
  <Attribute
    name="tenant"
    type="string (optional)"
    description="The id of the tenant that this workflow run should be associated with"
  />
  <Attribute
    name="data"
    type="object (optional)"
    description="A set of key-value pairs to pass to the workflow trigger"
  />
</Attributes>

### Returns

<Attributes>
  <Attribute
    name="workflow_run_id"
    type="string"
    description="A unique UUID of this workflow run"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="workflows.trigger" title="Trigger a workflow" />

```json title="Response"
{
  "workflow_run_id": "550e8400-e29b-41d4-a716-446655440000"
}
```

</ExampleColumn>
</Section>

<Section title="Triggering a workflow with inline identifications" slug="trigger-workflow-inline-identify">
<ContentColumn>

In the `recipients` and `actor` fields in a trigger call, you can optionally include maps of properties describing a user or an object. These can be properties describing a brand new user/object, or properties describing an update to an existing one. When this data is present in a workflow trigger, Knock will persist it as part of processing the workflow. This is comparable to direct calls to the [identify user](#identify-user) or [set object](#set-object) APIs.

Each recipient and actor must have an `id` field set in addition to other properties (e.g. email, name, or phone number).

See our guides on inline identification [for users](/managing-recipients/identifying-recipients#inline-identifying-recipients) and [for objects](/concepts/objects#3-set-objects-inline) for more details on this use case.

### Endpoint

<Endpoint method="POST" path="/workflows/:key/trigger" />

### Rate limit

<RateLimit tier={5} />

### Payload size limit

The workflow trigger endpoint enforces the following payload size limits:

- The `data` payload must be no more than `10MB`
- The `recipients` list must not exceed 1000 entries

### Path parameters

<Attributes>
  <Attribute
    name="key"
    type="string"
    description="The key of the workflow to call"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="recipients"
    type="Recipient[] (required)"
    description="A list of maps of properties describing a user or an object to identify in Knock and trigger this workflow for"
  />
  <Attribute
    name="actor"
    type="Recipient (optional)"
    description="A map of properties describing a user or an object to identify in Knock and mark as who or what performed the action"
  />
  <Attribute
    name="cancellation_key"
    type="string (optional)"
    description="The key to use for canceling the workflow"
  />
  <Attribute
    name="tenant"
    type="string (optional)"
    description="The id of the tenant that this workflow run should be associated with"
  />
  <Attribute
    name="data"
    type="object (optional)"
    description="A set of key-value pairs to pass to the trigger call"
  />
</Attributes>

### Returns

<Attributes>
  <Attribute
    name="workflow_run_id"
    type="string"
    description="A unique UUID of this workflow run"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="workflows.trigger-with-identification"
  title="Trigger a workflow with inline identifications"
/>

```json title="Response"
{
  "workflow_run_id": "550e8400-e29b-41d4-a716-446655440000"
}
```

</ExampleColumn>
</Section>

<Section title="Canceling workflows" slug="cancel-workflow">
<ContentColumn>

Cancel a delayed workflow for one or more recipients.

[Read more about canceling workflows](/send-notifications/canceling-workflows).

### Endpoint

<Endpoint method="POST" path="/workflows/:key/cancel" />

### Rate limit

<RateLimit tier={5} />

### Payload size limit

The workflow cancellation endpoint enforces the following payload size limits:

- The `recipients` list must not exceed 1000 entries

### Path parameters

<Attributes>
  <Attribute name="key" type="string" description="The key of the workflow" />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="cancellation_key"
    type="string"
    description="The cancellation key unique to the trigger call"
  />
  <Attribute
    name="recipients"
    type="RecipientIdentifier[]"
    description="An optional list of user ids or object references to cancel the workflow for"
    typeSlug="/concepts/recipients#recipientidentifier-definition"
  />
</Attributes>

### Returns

`204`, with empty content.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="workflows.cancel" title="Cancel a workflow" />

</ExampleColumn>
</Section>

<Section title="Messages" slug="messages">
<ContentColumn>

A message is a notification delivered on a particular channel to a user.

### Attributes

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="The unique ID of this message"
  />
  <Attribute
    name="channel_id"
    type="string"
    description="The ID of the channel through which this message was delivered"
  />
  <Attribute
    name="recipient"
    type="RecipientIdentifier"
    description="The ID of the user who received the message. If the recipient is an object, the result will be an object containing its id and collection"
    typeSlug="/concepts/recipients#recipientidentifier-definition"
  />
  <Attribute
    name="actors"
    type="RecipientIdentifier[]"
    description="One or more actors that are associated with this message. Note: this is a list that can contain up to 10 actors if the message is produced from a batch."
    typeSlug="/concepts/recipients#recipientidentifier-definition"
  />
  <Attribute
    name="workflow"
    type="string"
    description="The key of the workflow that this message was generated from"
  />
  <Attribute
    name="tenant"
    type="string"
    description="The ID of the tenant that this message belongs to"
  />
  <Attribute
    name="status"
    type="string"
    description="The delivery status for the message. One of `queued`, `sent`, `delivered`, `delivery_attempted`, `undelivered`, `not_sent`, `bounced`."
  />
  <Attribute
    name="engagement_statuses"
    type="string[]"
    description="One or more engagement statuses for the message. Each engagement status can be one of `seen`, `read`, `interacted`, `link_clicked`, or `archived`."
  />
  <Attribute
    name="seen_at"
    type="string (optional)"
    description="When the message was last seen"
  />
  <Attribute
    name="read_at"
    type="string (optional)"
    description="When the message was last read"
  />
  <Attribute
    name="interacted_at"
    type="string (optional)"
    description="When the message was last interacted with"
  />
  <Attribute
    name="link_clicked_at"
    type="string (optional)"
    description="When a message link was last clicked"
  />
  <Attribute
    name="archived_at"
    type="string (optional)"
    description="When the message was archived"
  />
  <Attribute
    name="inserted_at"
    type="string"
    description="When the message was created"
  />
  <Attribute
    name="updated_at"
    type="string"
    description="When the message was last updated"
  />
  <Attribute
    name="source"
    type="object"
    description="The workflow which is the message source"
  />
  <Attribute
    name="data"
    type="object"
    description="Data from the activities linked to the message"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint method="GET" path="/messages" name="list-messages" withLink />
  <Endpoint method="GET" path="/messages/:id" name="get-a-message" withLink />
  <Endpoint
    method="GET"
    path="/messages/:id/events"
    name="get-message-events"
    withLink
  />
  <Endpoint
    method="GET"
    path="/messages/:id/activities"
    name="get-message-activities"
    withLink
  />
  <Endpoint
    method="GET"
    path="/messages/:id/content"
    name="get-message-content"
    withLink
  />
  <Endpoint
    method="GET"
    path="/messages/batch/content"
    name="batch-get-message-content"
    withLink
  />
  <Endpoint
    method="GET"
    path="/messages/:id/delivery_logs"
    name="get-message-delivery-logs"
    withLink
  />
  <Endpoint
    method="PUT"
    path="/messages/:id/:status"
    name="update-message-status"
    withLink
  />
  <Endpoint
    method="DELETE"
    path="/messages/:id/:status"
    name="undo-message-status"
    withLink
  />
  <Endpoint
    method="POST"
    path="/messages/batch/:status"
    name="batch-update-message-status"
    withLink
  />
  <Endpoint
    method="POST"
    path="/channels/:id/messages/bulk/:status"
    name="bulk-update-channel-message-status"
    withLink
  />
</Endpoints>

```json title="Message object"
{
  "__typename": "Message",
  "id": "1rjI9XBgWQ6EUA3D3Ul3VjUimOD",
  "channel_id": "0bfd9f86-56b0-41f0-ade3-dc5cc6a69bb8",
  "recipient": "user_12345",
  "actors": ["user_12345"],
  "workflow": "merged-changes",
  "tenant": null,
  "status": "delivered",
  "engagement_statuses": ["read", "interacted"],
  "seen_at": null,
  "read_at": "2021-05-11T00:00:00.00Z",
  "interacted_at": "2021-05-11T00:00:00.00Z",
  "link_clicked_at": null,
  "archived_at": null,
  "inserted_at": "2021-03-05T12:00:00Z",
  "updated_at": "2021-03-05T12:00:00Z",
  "source": {
    "__typename": "WorkflowSource",
    "key": "merged-changes",
    "version_id": "7251cd3f-0028-4d1a-9466-ee79522ba3de",
    "categories": ["reminders"]
  },
  "data": {
    "foo": "bar"
  },
  "metadata": {
    "external_id": "external_id_from_provider"
  }
}
```

</ExampleColumn>
</Section>

<Section isRetentionSubject title="Listing messages" slug="list-messages">
<ContentColumn>

Returns a paginated list of messages.

### Endpoint

<Endpoint method="GET" path="/messages" />

### Rate limit

<RateLimit tier={4} />

### Data retention rule

Messages outside the account's retention window will not be included in the results.

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
  <Attribute
    name="source"
    type="string (optional)"
    description="Limits the results to only items of the source workflow"
  />
  <Attribute
    name="tenant"
    type="string (optional)"
    description="Limits the results to items with the corresponding tenant, or where the tenant is empty"
  />
  <Attribute
    name="status"
    type="string[] (optional)"
    description="One or more of `queued`, `sent`, `delivered`, `delivery_attempted`, `undelivered`, `bounced`, `not_sent`. Limits results to messages with the given delivery status(es)."
  />
  <Attribute
    name="engagement_status"
    type="string[] (optional)"
    description="One or more of `read`, `unread`, `seen`, `unseen`, `archived`, `unarchived`, `interacted`, `link_clicked`. Limits results to messages with the given engagement status(es)."
  />
  <Attribute
    name="channel_id"
    type="string (optional)"
    description="Limits the results to only items that belong to the channel"
  />
  <Attribute
    name="message_ids[]"
    type="string[] (optional)"
    description="Limits the results to only the message ids given (max 50). Note: when using this option, the results will be subject to any other filters applied to the query."
  />
  <Attribute
    name="workflow_categories"
    type="string[] (optional)"
    description="Limits the results to only items related to any of the provided categories"
  />
  <Attribute
    name="workflow_run_id"
    type="string (optional)"
    description="Limits the results to messages triggered by the top-level workflow run ID"
  />
  <Attribute
    name="workflow_recipient_run_id"
    type="string (optional)"
    description="Limits the results to messages for a specific recipient's workflow run"
  />
  <Attribute
    name="trigger_data"
    type="JSON string (optional)"
    description="Limits the results to only items that were generated with the given data"
    nameSlug="#trigger-data-filtering"
  />
  <Attribute
    name="inserted_at.gt"
    type="datetime (optional)"
    description="Retrieves messages inserted after the given date"
  />
  <Attribute
    name="inserted_at.gte"
    type="datetime (optional)"
    description="Retrieves messages inserted after or equal to the given date"
  />
  <Attribute
    name="inserted_at.lt"
    type="datetime (optional)"
    description="Retrieves messages inserted before the given date"
  />
  <Attribute
    name="inserted_at.lte"
    type="datetime (optional)"
    description="Retrieves messages inserted before or equal to the given date"
  />
</Attributes>

### Returns

A paginated list of Message records

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="messages.list" title="List messages" />

```json title="Response"
{
  "items": [
    {
      "__typename": "Message",
      "__cursor": "g3QAAAABZAACaWRtAAAAGzFzTXRJc1J2WnRZZjg2YU9ma00yUENwQzZYYw==",
      "id": "1rjI9XBgWQ6EUA3D3Ul3VjUimOD",
      "channel_id": "0bfd9f86-56b0-41f0-ade3-dc5cc6a69bb8",
      "recipient": {
        "id": "project_1",
        "collection": "projects"
      },
      "actors": [],
      "workflow": "merged-changes",
      "tenant": null,
      "status": "delivered",
      "engagement_statuses": ["read", "interacted"],
      "seen_at": null,
      "read_at": "2021-05-11T00:00:00.00Z",
      "interacted_at": "2021-05-11T00:00:00.00Z",
      "link_clicked_at": null,
      "archived_at": null,
      "inserted_at": "2021-03-05T12:00:00Z",
      "updated_at": "2021-03-05T12:00:00Z",
      "source": {
        "__typename": "WorkflowSource",
        "key": "merged-changes",
        "version_id": "7251cd3f-0028-4d1a-9466-ee79522ba3de",
        "categories": ["reminders"]
      },
      "data": {
        "foo": "bar"
      },
      "metadata": {
        "external_id": "external_id_from_provider"
      }
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section isRetentionSubject title="Fetching a message" slug="get-a-message">
<ContentColumn>

Retrieve a message by the id.

### Endpoint

<Endpoint method="GET" path="/messages/:id" />

### Rate limit

<RateLimit tier={4} />

### Data retention rule

Returns a `404 Not Found` error for a message outside the account's retention window.

### Path parameters

<Attributes>
  <Attribute name="id" type="string" description="The ID of the message" />
</Attributes>

### Returns

A Message

</ContentColumn>

<ExampleColumn>
  <MultiLangCodeBlock snippet="messages.get" title="Get a message" />
</ExampleColumn>

</Section>

<Section isRetentionSubject title="Events" slug="get-message-events">
<ContentColumn>

Returns a paginated list of events for a message.

### Endpoint

<Endpoint method="GET" path="/messages/:id/events" />

### Rate limit

<RateLimit tier={3} />

### Data retention rule

Returns a `404 Not Found` error for a message outside the account's retention window.

### Path parameters

<Attributes>
  <Attribute name="id" type="string" description="The ID of the message" />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
</Attributes>

### Returns

A paginated list of MessageEvent records

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="messages.getEvents" title="Get message events" />

```json title="Response"
{
  "items": [
    {
      "__typename": "MessageEvent",
      "__cursor": "g3QAAAABZAACaWRtAAAAGzFzTXRJc1J2WnRZZjg2YU9ma00yUENwQzZYYw==",
      "id": "25cQpkVBUTbzKKug0qVEDqcAJxm",
      "environment_id": "a49e3beb-f654-4f2f-8963-f69cc1f7e6dc",
      "recipient": "e62cbb03-86a0-47d6-84fe-f49981906267",
      "data": {},
      "type": "enqueued",
      "inserted_at": "2021-04-06T12:00:00Z"
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section isRetentionSubject title="Activities" slug="get-message-activities">
<ContentColumn>

Returns a paginated list of activities associated with the message. Note: for non batched messages this will always return a single activity. For messages produced after a batch step, this will contain one or more activities.

### Endpoint

<Endpoint method="GET" path="/messages/:id/activities" />

### Rate limit

<RateLimit tier={4} />

### Data retention rule

Returns a `404 Not Found` error for a message outside the account's retention window.

### Path parameters

<Attributes>
  <Attribute name="id" type="string" description="The ID of the message" />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
  <Attribute
    name="trigger_data"
    type="JSON string (optional)"
    description="Limits the results to only items that were generated with the given data"
    nameSlug="#trigger-data-filtering"
  />
</Attributes>

### Returns

A paginated list of Activity records

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="messages.getActivities"
  title="Get message activities"
/>

```json title="Response"
{
  "items": [
    {
      "__typename": "Activity",
      "__cursor": "g3QAAAABZAACaWRtAAAAGzFzTXRJc1J2WnRZZjg2YU9ma00yUENwQzZYYw==",
      "id": "25cQpkVBUTbzKKug0qVEDqcAJxm",
      "data": {
        "notification_payload": "foobar"
      },
      "actor": {
        "__typename": "User",
        "id": "7b553fc3-eb65-4ad8-8836-d1224dad703b",
        "created_at": "2022-04-07T12:00:00.00Z",
        "email": "actor@example.com",
        "name": "Actor",
        "updated_at": "2022-04-07T12:00:00.00Z"
      },
      "recipient": {
        "__typename": "Object",
        "id": "f7a84d87-7b9e-4128-82a8-cde38593817f",
        "collection": "projects",
        "properties": {
          "name": "Project 1"
        },
        "created_at": "2022-04-07T12:00:00.00Z",
        "updated_at": "2022-04-07T12:00:00.00Z"
      },
      "inserted_at": "2021-04-06T12:00:00Z",
      "updated_at": "2021-04-06T12:00:00Z"
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section isRetentionSubject title="Message content" slug="get-message-content">
<ContentColumn>

Retrieves the contents of a message, as generated and sent to the end provider.

### Endpoint

<Endpoint method="GET" path="/messages/:id/content" />

### Rate limit

<RateLimit tier={3} />

### Data retention rule

Returns a `404 Not Found` error for a message outside the account's retention window.

### Path parameters

<Attributes>
  <Attribute name="id" type="string" description="The ID of the message" />
</Attributes>

### Returns

A `MessageContent` object.

**Note: the `data` attribute of the `MessageContent` payload will vary based on the type
of message being sent (email, chat, in-app feed, sms, and push).**

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="messages.getContent" title="Get message content" />

```json title="Response"
{
  "__typename": "MessageContent",
  "id": "264os2yt574e1T3jblzjbh7Qa69",
  "data": {
    "bcc": "bcc@example.com",
    "cc": "cc@example.com",
    "from": {
      "email": "info-app@example.com",
      "name": "Example App"
    },
    "html_body": "<p>example</p>",
    "reply_to": "reply-to@example.com",
    "subject": "Example Notification",
    "text_body": "example",
    "to": "user@example.com"
  },
  "inserted_at": "2021-04-06T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section isRetentionSubject title="Batch message content" slug="batch-get-message-content">
<ContentColumn>

Retrieves the contents of a list of messages, as generated and sent to the end provider.

### Endpoint

<Endpoint method="GET" path="/messages/batch/content" />

### Rate limit

<RateLimit tier={4} />

### Data retention rule

Returns a `404 Not Found` error for a message outside the account's retention window.

### Query parameters

<Attributes>
  <Attribute
    name="message_ids[]"
    type="string[]"
    description="The IDs of the messages (max 25)"
  />
</Attributes>

### Returns

A list of `MessageContent` objects for the provided message IDs.

**Note: the `data` attribute of the `MessageContent` payload will vary based on the type
of message being sent (email, chat, in-app feed, sms, and push).**

</ContentColumn>
<ExampleColumn>

```json title="Response"
[
  {
    "__typename": "MessageContent",
    "id": "264os2yt574e1T3jblzjbh7Qa69",
    "data": {
      "bcc": "bcc@example.com",
      "cc": "cc@example.com",
      "from": {
        "email": "info-app@example.com",
        "name": "Example App"
      },
      "html_body": "<p>example</p>",
      "reply_to": "reply-to@example.com",
      "subject": "Example Notification",
      "text_body": "example",
      "to": "user@example.com"
    },
    "inserted_at": "2024-04-06T12:00:00Z"
  },
  {
    "__typename": "MessageContent",
    "id": "2iQYdsKFjfIJfXGOGcHi1UOjLMA",
    "data": {
      "bcc": "bcc@example.com",
      "cc": "cc@example.com",
      "from": {
        "email": "info-app@example.com",
        "name": "Example App"
      },
      "html_body": "<p>example</p>",
      "reply_to": "reply-to@example.com",
      "subject": "Example Notification",
      "text_body": "example",
      "to": "user@example.com"
    },
    "inserted_at": "2024-05-09T10:29:00Z"
  }
]
```

</ExampleColumn>
</Section>

<Section isRetentionSubject title="Delivery logs" slug="get-message-delivery-logs">
<ContentColumn>

Retrieves the delivery logs of a message, generated while sending and checking the delivery status of the message sent to an end provider. Note: for in-app channels, the delivery logs will always be an empty list.

### Endpoint

<Endpoint method="GET" path="/messages/:id/delivery_logs" />

### Rate limit

<RateLimit tier={3} />

### Data retention rule

Returns a `404 Not Found` error for a message outside the account's retention window.

### Path parameters

<Attributes>
  <Attribute name="id" type="string" description="The ID of the message" />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before"
  />
</Attributes>

### Returns

A paginated list of `MessageDeliveryLog`.

**Note**: the `request` and `response` attributes of the MessageDeliveryLog payload will vary depending on the provider.

</ContentColumn>
<ExampleColumn>

```json title="Response"
{
  "items": [
    {
      "__typename": "MessageDeliveryLog",
      "environment_id": "0b94230b-1eef-4627-9dd5-6ab67b0006b4",
      "id": "2KYa5b8ptmGEr1J0uX0IcBlC7OE",
      "inserted_at": "2023-01-19T18:43:07.994259Z",
      "request": {
        "body": {},
        "headers": {
          "Content-Type": "application/json"
        },
        "host": "https://api.postmarkapp.com",
        "method": "POST",
        "path": "/email",
        "query": null
      },
      "response": {
        "body": {},
        "headers": {
          "content-type": "application/json; charset=utf-8"
        },
        "status": 200
      },
      "service_name": "Postmark"
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section title="Updating a message status" slug="update-message-status">
<ContentColumn>

Marks the given message with the provided `status`, recording an event in the process. Note that message engagement statuses are [mutually inclusive](/send-notifications/message-statuses#engagement-status); a message can have zero, one, or multiple statuses.

### Endpoint

<Endpoint method="PUT" path="/messages/:id/:status" />

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute name="id" type="string" description="The ID of the message" />
  <Attribute
    name="status"
    type="enum"
    description="One of `seen`, `read`, `interacted`, `archived`"
  />
  <Attribute
    name="metadata"
    type="object"
    description="Additional metadata to be set. Only applicable for `interacted` status updates. Cannot include more than 5 key-value pairs, must not contain nested data."
  />
</Attributes>

### Returns

A Message.

</ContentColumn>
</Section>

<Section title="Undoing a message status change" slug="undo-message-status">
<ContentColumn>

Un-marks the given `status` on a message, recording an event in the process. Note that message engagement statuses are [mutually inclusive](/send-notifications/message-statuses#engagement-status); a message can have zero, one, or multiple statuses.

### Endpoint

<Endpoint method="DELETE" path="/messages/:id/:status" />

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute name="id" type="string" description="The ID of the message" />
  <Attribute
    name="status"
    type="enum"
    description="One of `seen`, `read`, `interacted`, `archived`"
  />
</Attributes>

### Returns

A Message.

</ContentColumn>
</Section>

<Section title="Batch changing message statuses" slug="batch-update-message-status">
<ContentColumn>

Multiple messages can be changed at once using the batch API, where all message ids given in will have their statuses changed.

### Endpoint

<Endpoint method="POST" path="/messages/batch/:status" />

### Rate limit

<RateLimit tier={3} />

### Batch rate limit

<RateLimit isBatch tier={1} />

<div className="mt-6">
  <Callout
    emoji="âš ï¸"
    text={
      <>
        <strong>
          Knock scopes this batch rate limit by{" "}
          <code style={{ fontWeight: 600, backgroundColor: "inherit" }}>
            message_ids
          </code>{" "}
          and{" "}
          <code style={{ fontWeight: 600, backgroundColor: "inherit" }}>
            status
          </code>
          .
        </strong>{" "}
        This allows for 1 update per second per message per status.
      </>
    }
  />
</div>

### Path parameters

<Attributes>
  <Attribute
    name="status"
    type="enum"
    description="One of `seen`, `read`, `interacted`, `archived` or `unseen`, `unread`, `unarchived`"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="message_ids"
    type="string[]"
    description="A list of one or more message IDs"
  />
  <Attribute
    name="metadata"
    type="object"
    description="Additional metadata to be set for all messages in the batch. Only applicable for `interacted` status updates. Cannot include more than 5 key-value pairs, must not contain nested data."
  />
</Attributes>

### Returns

A list of Messages that were mutated during the call.

</ContentColumn>
</Section>

<Section isRetentionSubject title="Bulk changing message statuses in a channel" slug="bulk-update-channel-message-status">
<ContentColumn>

Apply the given `status` to a set of messages for the given channel. Will modify all valid messages, or a subset based on the filters provided.

Returns a `BulkOperation` that executes the job asynchronously. Progress can be tracked via the [BulkOperation API](#bulk-operations).

### Endpoint

<Endpoint method="POST" path="/channels/:id/messages/bulk/:status" />

### Rate limit

<RateLimit tier={2} />

### Data retention rule

For in-app channels, messages can be updated indefinitely via this operation. For all other channel types, messages outside the account's retention window will not be updated as part of this operation.

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="The ID of a channel that you wish to modify messages under"
  />
  <Attribute
    name="status"
    type="enum"
    description="One of `seen`, `read`, `interacted`, `archived` or `unseen`, `unread`, `unarchived`"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="user_ids"
    type="string[] (optional)"
    description="Scope the bulk update to one or more users"
  />
  <Attribute
    name="tenants"
    type="string[] (optional)"
    description="A list of one or more tenants to match"
  />
  <Attribute
    name="has_tenant"
    type="boolean (optional)"
    description="When set to false, will only return messages that do not have a tenant associated"
  />
  <Attribute
    name="workflows"
    type="string[] (optional)"
    description="A list of one or more workflow keys to match"
  />
  <Attribute
    name="older_than"
    type="string (optional)"
    description="An ISO-8601 timestamp to find messages created before"
  />
  <Attribute
    name="newer_than"
    type="string (optional)"
    description="An ISO-8601 timestamp to find messages created after"
  />
  <Attribute
    name="delivery_status"
    type="enum (optional)"
    description="Limit messages to one of `queued`, `sent`, `delivered`, `delivery_attempted`, `undelivered`, `bounced`, `not_sent`"
  />
  <Attribute
    name="engagement_status"
    type="enum (optional)"
    description="Limit messages to one of `seen`, `unseen`, `read`, `unread`, `archived`, `unarchived`, `interacted`, `link_clicked`"
  />
</Attributes>

### Returns

A `BulkOperation`

</ContentColumn>

<ExampleColumn>

```json title="Response"
{
  "__typename": "BulkOperation",
  "completed_at": "2021-03-05T12:00:00Z",
  "error_count": 0,
  "error_items": [],
  "estimated_total_rows": 42,
  "failed_at": null,
  "id": "50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "inserted_at": "2021-03-05T12:00:00Z",
  "name": "messages.<status>",
  "processed_rows": 42,
  "progress_path": "/v1/bulk_operations/50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "started_at": "2021-03-05T12:00:00Z",
  "status": "completed",
  "success_count": 42,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Feeds" slug="feeds">
<ContentColumn>

A feed exposes the messages delivered to an in-app feed channel, formatted specially to be consumed
in a notification feed.

A feed will always return a list of `FeedItems`, which are pointers to a message delivered and contain
all of the information needed in order to render an item within a notification feed.

**Note: feeds are a specialized form of messages that are designed purely for in-app rendering, and
as such return information that is required on the client to do so**

### Attributes

<Attributes>
  <Attribute
    name="entries"
    type="FeedItem[]"
    description="An ordered list of feed items (most recent first)"
  />
  <Attribute
    name="page_info"
    type="PageInfo"
    description="Pagination information for the items returned"
  />
  <Attribute
    name="vars"
    type="object"
    description="Environment specific account variables"
  />
  <Attribute
    name="meta"
    type="FeedMetadata"
    description="Information about the total unread and unseen items"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint
    method="GET"
    path="/users/:user_id/feeds/:feed_id"
    name="get-feed"
    withLink
  />
</Endpoints>

```json title="Response"
{
  "entries": [
    {
      "__typename": "FeedItem",
      "__cursor": "g3QAAAABZAACaWRtAAAAGzFzTXRJc1J2WnRZZjg2YU9ma00yUENwQzZYYw==",
      "activities": [
        {
          "__typename": "Activity",
          "actor": {
            "__typename": "User",
            "id": "c121a5ea-8f2c-4c60-ab40-9966047d5bea",
            "created_at": null,
            "updated_at": "2021-05-08T20:40:01.340Z",
            "email": "some-user@knock.app",
            "name": "Some User"
          },
          "data": {
            "dest_environment_name": "Production",
            "src_environment_name": "Development",
            "total_merged": 1
          },
          "id": "1sMtIwNnDIV52a8G8kmymzDVExQ",
          "inserted_at": "2021-05-11T00:50:09.895759Z",
          "recipient": {
            "__typename": "User",
            "id": "c121a5ea-8f2c-4c60-ab40-9966047d5bea",
            "created_at": null,
            "updated_at": "2021-05-08T20:40:01.340Z",
            "email": "some-user@knock.app",
            "name": "Some User"
          },
          "updated_at": "2021-05-11T00:50:09.895759Z"
        }
      ],
      "actors": [
        {
          "__typename": "User",
          "id": "c121a5ea-8f2c-4c60-ab40-9966047d5bea",
          "created_at": null,
          "updated_at": "2021-05-08T20:40:01.340Z",
          "email": "some-user@knock.app",
          "name": "Some User"
        }
      ],
      "blocks": [
        {
          "content": "**{{ actor.name }}** merged {{ total_merged }} {% if total_merged == 1 %} change {% else %} changes {% endif %}\nfrom **{{ src_environment_name }}** into **{{ dest_environment_name }}**.",
          "name": "body",
          "rendered": "<p><strong>The person</strong> merged 1  change \nfrom <strong>Development</strong> into <strong>Production</strong>.</p>",
          "type": "markdown"
        },
        {
          "content": "{{ vars.app_url }}/{{ account_slug }}/commits",
          "name": "action_url",
          "rendered": "https://example.com/thing/commits",
          "type": "text"
        }
      ],
      "data": {
        "dest_environment_name": "Production",
        "src_environment_name": "Development",
        "total_merged": 1
      },
      "id": "1sMtIsRvZtYf86aOfkM2PCpC6Xc",
      "inserted_at": "2021-05-11T00:50:09.904531Z",
      "read_at": "2021-05-13T02:45:28.559124Z",
      "seen_at": "2021-05-11T00:51:43.617550Z",
      "interacted_at": null,
      "link_clicked_at": null,
      "archived_at": null,
      "source": {
        "__typename": "WorkflowSource",
        "key": "merged-changes",
        "version_id": "7251cd3f-0028-4d1a-9466-ee79522ba3de",
        "categories": ["reminders"]
      },
      "tenant": null,
      "total_activities": 1,
      "total_actors": 1,
      "updated_at": "2021-05-13T02:45:28.559863Z"
    }
  ],
  "vars": {
    "app_name": "The app name"
  },
  "meta": {
    "__typename": "FeedMetadata",
    "unread_count": 0,
    "unseen_count": 0
  },
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section title="Get a feed for user" slug="get-feed">
<ContentColumn>

Retrieves a feed of items in reverse chronological order for a given `user_id` on the given `feed_id`. In the case where the user has not yet been identified within Knock, this endpoint will return an empty feed.

You can customize the response for this endpoint by using [response filters](/integrations/in-app/knock#customizing-api-response-content) to exclude or only include certain properties on your resources.

**Note: if you're making this call from a client-side environment you should be using your publishable key
along with a user token to make this request**

### Endpoint

<Endpoint method="GET" path="/users/:user_id/feeds/:feed_id" />

### Rate limit

<RateLimit tier={2} />

<div className="mt-6">
  <Callout
    emoji="âš ï¸"
    title="This endpoint's rate limit is always scoped per-user and per-environment."
    text={<>This is true even for requests made without a signed user token.</>}
  />
</div>

### Path parameters

<Attributes>
  <Attribute name="user_id" type="string" description="The ID of the user" />
  <Attribute
    name="feed_id"
    type="string"
    description="The ID of the feed (the channel ID)"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page. Defaults to 50 and the max limit is 200."
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
  <Attribute
    name="source"
    type="string"
    description="Limits the feed to only items of the source workflow"
  />
  <Attribute
    name="tenant"
    type="string"
    description="Limits the feed to only display items with the corresponding tenant, or where the tenant is empty"
  />
  <Attribute
    name="has_tenant"
    type="boolean"
    description="Scope the feed to display items with or without any tenancy"
  />
  <Attribute
    name="status"
    type="string"
    description="One of `unread`,`read`, `unseen`,`seen`, `all`"
  />
  <Attribute
    name="workflow_categories"
    type="string[]"
    description="Limits the feed to only display items related to any of the provided categories"
  />
  <Attribute
    name="archived"
    type="string"
    description="One of `include`, `exclude`, `only` (defaults to `exclude`)"
  />
  <Attribute
    name="trigger_data"
    type="JSON string"
    description="Limits the results to only items that were generated with the given data"
    nameSlug="#trigger-data-filtering"
  />
  <Attribute
    name="inserted_at.gt"
    type="datetime (optional)"
    description="Filter feed items created after the specified ISO-8601 timestamp (exclusive)"
  />
  <Attribute
    name="inserted_at.gte"
    type="datetime (optional)"
    description="Filter feed items created at or after the specified ISO-8601 timestamp (inclusive)"
  />
  <Attribute
    name="inserted_at.lt"
    type="datetime (optional)"
    description="Filter feed items created before the specified ISO-8601 timestamp (exclusive)"
  />
  <Attribute
    name="inserted_at.lte"
    type="datetime (optional)"
    description="Filter feed items created at or before the specified ISO-8601 timestamp (inclusive)"
  />
</Attributes>

### Returns

A feed response.

</ContentColumn>
</Section>

<Section title="Users" slug="users">
<ContentColumn>

A user represents an individual who may need to receive a notification from Knock. They are always referenced by your internal identifier.

### Attributes

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="Unique identifier for the user"
  />
  <Attribute name="name" type="string (optional)" description="The full name of the user" />
  <Attribute name="email" type="string (optional)" description="The email of the user" />
  <Attribute name="avatar" type="string (optional)" description="A URL for the avatar of the user" />
  <Attribute name="phone_number" type="string (optional)" description="The phone number of the user to use with SMS channels" />
  <Attribute
    name="locale"
    type="string (optional)"
    description={
      <>
        <span>The locale of the user. Used for </span>
        <a href="/concepts/translations">message localization</a>
        <span>.</span>
      </>
    }
  />
  <Attribute
    name="timezone"
    type="string (optional)"
    description={
      <>
        <span>
          The timezone of the user. Must be a valid{" "}
          <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">
            tz database time zone string
          </a>
          . Used for <a href="/concepts/schedules#scheduling-workflows-with-recurring-schedules-for-recipients">
            recurring schedules
          </a> and {""}
          <a href="/designing-workflows/send-windows">
          send windows
          </a>.
        </span>
      </>
    }
  />
  <Attribute
    name="*"
    type="key-value pairs"
    description="Any custom properties"
  />
</Attributes>
</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint name="identify-user" method="PUT" path="/users/:user_id" withLink />
  <Endpoint name="list-users" method="GET" path="/users" withLink />
  <Endpoint name="get-user" method="GET" path="/users/:user_id" withLink />
  <Endpoint
    name="get-user-messages"
    method="GET"
    path="/users/:user_id/messages"
    withLink
  />
  <Endpoint
    name="delete-user"
    method="DELETE"
    path="/users/:user_id"
    withLink
  />
  <Endpoint
    name="merge-user"
    method="POST"
    path="/users/:user_id/merge"
    withLink
  />
  <Endpoint
    name="bulk-identify-users"
    method="POST"
    path="/users/bulk/identify"
    withLink
  />
  <Endpoint
    name="bulk-delete-users"
    method="POST"
    path="/users/bulk/delete"
    withLink
  />
</Endpoints>

```json title="User object"
{
  "__typename": "User",
  "id": "user_1",
  "name": "User name",
  "email": "user@example.com",
  "foo": "bar",
  "baz": true,
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Identify a user" slug="identify-user">
<ContentColumn>

Identifying a user will create or update a user in Knock, merging the properties given with what we currently have set on the user (if any).

### Endpoint

<Endpoint method="PUT" path="/users/:user_id" />

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="Unique identifier of the user"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="name"
    type="string (optional)"
    description="The name of the user"
  />
  <Attribute
    name="email"
    type="string (optional)"
    description="The email of the user"
  />
  <Attribute
    name="avatar"
    type="string (optional)"
    description="A URL for the avatar of the user"
  />
  <Attribute
    name="phone_number"
    type="string (optional)"
    description="The phone number of the user to use with SMS channels"
  />
  <Attribute
    name="locale"
    type="string (optional)"
    description={
      <>
        <span>The locale of the user. Used for </span>
        <a href="/concepts/translations">message localization</a>
        <span>.</span>
      </>
    }
  />
  <Attribute
    name="timezone"
    type="string (optional)"
    description={
      <>
        <span>
          The timezone of the user. Must be a valid{" "}
          <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">
            tz database time zone string
          </a>
          . Used for <a href="/concepts/schedules#scheduling-workflows-with-recurring-schedules-for-recipients">
            recurring schedules
          </a>.
        </span>
      </>
    }
  />
  <Attribute
    name="preferences"
    type="object<string, PreferenceSet> (optional)"
    typeSlug="/api-reference/recipients/preferences"
    description="A set of preferences that determines whether a recipient should receive a particular type of notification."
  />
  <Attribute
    name="channel_data"
    type="object<string, ChannelData> (optional)"
    typeSlug="/api-reference/recipients/channel_data"
    description="Channel-specific information that's needed to deliver a notification to an end provider."
  />
  <Attribute
    name="*"
    type="key-value pairs"
    description="Any custom properties"
  />
</Attributes>

### Returns

A User.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="users.identify" title="Identify a user" />

```json title="Response"
{
  "__typename": "User",
  "id": "user_1",
  "name": "User name",
  "email": "user@example.com",
  "locale": "en",
  "timezone": "America/New_York",
  "foo": "bar",
  "baz": true,
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="List users" slug="list-users">
<ContentColumn>

Lists all non-deleted users for the environment. You can optionally request all preferences associated with a user while listing by passing `include[]=preferences`.

### Endpoint

<Endpoint method="GET" path="/users" />

### Rate limit

<RateLimit tier={4} />

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
  <Attribute
    name="include"
    type="string[]"
    description="A list of entities to side load as part of the response. Currently only supports `preferences`."
  />
</Attributes>

### Returns

A paginated list of `User` records.

</ContentColumn>
<ExampleColumn>

```json title="Response"
{
  "entries": [
    {
      "__typename": "User",
      "id": "user_1",
      "name": "User name",
      "email": "user@example.com",
      "foo": "bar",
      "baz": true,
      "created_at": null,
      "updated_at": "2021-03-05T12:00:00Z"
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section title="Get a user" slug="get-user">
<ContentColumn>

Retrieve a user by their ID, including all properties previously set.

### Endpoint

<Endpoint method="GET" path="/users/:user_id" />

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="Unique identifier of the user"
  />
</Attributes>

### Returns

A User.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="users.get" title="Get a user" />

```json title="Response"
{
  "__typename": "User",
  "id": "user_1",
  "name": "User name",
  "email": "user@example.com",
  "foo": "bar",
  "baz": true,
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section isRetentionSubject title="User messages" slug="get-user-messages">
<ContentColumn>

Retrieve a paginated list of messages for a user. Will return most recent messages first.

### Endpoint

<Endpoint method="GET" path="/users/:id/messages" />

### Rate limit

<RateLimit tier={4} />

### Data retention rule

Messages outside the account's retention window will not be included in the results.

### Path parameters

<Attributes>
  <Attribute name="id" type="string" description="The ID of the user" />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
  <Attribute
    name="source"
    type="string (optional)"
    description="Limits the results to only items of the source workflow"
  />
  <Attribute
    name="tenant"
    type="string (optional)"
    description="Limits the results to items with the corresponding tenant, or where the tenant is empty"
  />
  <Attribute
    name="status"
    type="string[] (optional)"
    description="One or more of `queued`, `sent`, `delivered`, `delivery_attempted`, `undelivered`, `bounced`, `not_sent`. Limits results to messages with the given delivery status(es)."
  />
  <Attribute
    name="engagement_status"
    type="string[] (optional)"
    description="One or more of `read`, `unread`, `seen`, `unseen`, `archived`, `unarchived`, `interacted`, `link_clicked`. Limits results to messages with the given engagement status(es)."
  />
  <Attribute
    name="channel_id"
    type="string (optional)"
    description="Limits the results to only items that belong to the channel"
  />
  <Attribute
    name="message_ids[]"
    type="string[] (optional)"
    description="Limits the results to only the message ids given (max 50). Note: when using this option, the results will be subject to any other filters applied to the query."
  />
  <Attribute
    name="workflow_categories"
    type="string[] (optional)"
    description="Limits the results to only items related to any of the provided categories"
  />
  <Attribute
    name="trigger_data"
    type="JSON string (optional)"
    description="Limits the results to only items that were generated with the given data"
    nameSlug="#trigger-data-filtering"
  />
  <Attribute
    name="inserted_at.gt"
    type="datetime (optional)"
    description="Retrieves messages inserted after the given date"
  />
  <Attribute
    name="inserted_at.gte"
    type="datetime (optional)"
    description="Retrieves messages inserted after or equal to the given date"
  />
  <Attribute
    name="inserted_at.lt"
    type="datetime (optional)"
    description="Retrieves messages inserted before the given date"
  />
  <Attribute
    name="inserted_at.lte"
    type="datetime (optional)"
    description="Retrieves messages inserted before or equal to the given date"
  />
</Attributes>

### Returns

A paginated list of Message records

</ContentColumn>

<ExampleColumn>

<MultiLangCodeBlock snippet="users.messages" title="Get user messages" />

```json title="Response"
{
  "items": [
    {
      "__typename": "Message",
      "__cursor": "g3QAAAABZAACaWRtAAAAGzFzTXRJc1J2WnRZZjg2YU9ma00yUENwQzZYYw==",
      "id": "1rjI9XBgWQ6EUA3D3Ul3VjUimOD",
      "channel_id": "0bfd9f86-56b0-41f0-ade3-dc5cc6a69bb8",
      "recipient": "user_12345",
      "actors": [],
      "workflow": "merged-changes",
      "tenant": null,
      "status": "delivered",
      "engagement_statuses": ["read", "interacted"],
      "seen_at": null,
      "read_at": "2021-05-11T00:00:00.00Z",
      "interacted_at": "2021-05-11T00:00:00.00Z",
      "link_clicked_at": null,
      "archived_at": null,
      "inserted_at": "2021-03-05T12:00:00Z",
      "updated_at": "2021-03-05T12:00:00Z",
      "source": {
        "__typename": "WorkflowSource",
        "key": "merged-changes",
        "version_id": "7251cd3f-0028-4d1a-9466-ee79522ba3de",
        "categories": ["reminders"]
      },
      "data": {
        "foo": "bar"
      },
      "metadata": {
        "external_id": "external_id_from_provider"
      }
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section title="Delete a user" slug="delete-user">
<ContentColumn>

Deletes a user by the id given.

### Endpoint

<Endpoint method="DELETE" path="/users/:user_id" />

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="Unique identifier of the user"
  />
</Attributes>

### Returns

No response.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="users.delete" title="Delete a user" />

</ExampleColumn>
</Section>

<Section title="Merge users" slug="merge-user">
<ContentColumn>

Merges the two users together, merging the user specified in the `from_user_id` into the `user_id`.

[Read more on how merging works â†’](/concepts/users#merging-users)

### Endpoint

<Endpoint method="POST" path="/users/:user_id/merge" />

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="Unique identifier of the user to merge into"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="from_user_id"
    type="string"
    description="Unique identifier of the user to merge from"
  />
</Attributes>

### Returns

The merged `User`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="users.merge" title="Merge a user" />

```json title="Response"
{
  "__typename": "User",
  "id": "user_1",
  "name": "User name",
  "email": "user@example.com",
  "foo": "bar",
  "baz": true,
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Bulk identify users" slug="bulk-identify-users">
<ContentColumn>

Identifies up to 1000 users at a time. Returns a `BulkOperation` that executes the job asynchronously. Progress can be tracked via the [BulkOperation API](#bulk-operations).

### Endpoint

<Endpoint method="POST" path="/users/bulk/identify" />

### Rate limit

<RateLimit tier={1} />

### Body parameters

<Attributes>
  <Attribute
    name="users"
    type="User[]"
    description="A list of users to upsert"
    typeSlug="#users"
  />
</Attributes>

### Returns

A BulkOperation.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.bulkIdentify"
  title="Bulk identifies users"
/>

```json title="Response"
{
  "__typename": "BulkOperation",
  "completed_at": "2021-03-05T12:00:00Z",
  "error_count": 0,
  "error_items": [],
  "estimated_total_rows": 42,
  "failed_at": null,
  "id": "50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "inserted_at": "2021-03-05T12:00:00Z",
  "name": "users.identify",
  "processed_rows": 42,
  "progress_path": "/v1/bulk_operations/50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "started_at": "2021-03-05T12:00:00Z",
  "status": "completed",
  "success_count": 42,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Bulk delete users" slug="bulk-delete-users">
<ContentColumn>

Deletes up to 1000 users at a time. Returns a `BulkOperation` that executes the job asynchronously. Progress can be tracked via the [BulkOperation API](#bulk-operations).

### Endpoint

<Endpoint method="POST" path="/users/bulk/delete" />

### Rate limit

<RateLimit tier={1} />

### Body parameters

<Attributes>
  <Attribute
    name="user_ids"
    type="string[]"
    description="Unique identifiers of the users to delete"
  />
</Attributes>

### Returns

A BulkOperation.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="users.bulkDelete" title="Bulk deletes users" />

```json title="Response"
{
  "__typename": "BulkOperation",
  "completed_at": "2021-03-05T12:00:00Z",
  "error_count": 0,
  "error_items": [],
  "estimated_total_rows": 42,
  "failed_at": null,
  "id": "50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "inserted_at": "2021-03-05T12:00:00Z",
  "name": "users.delete",
  "processed_rows": 42,
  "progress_path": "/v1/bulk_operations/50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "started_at": "2021-03-05T12:00:00Z",
  "status": "completed",
  "success_count": 42,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Objects" slug="objects">
<ContentColumn>

An Object represents a resource in your system that you've stored in Knock.

The most common use case for objects is as a store for non-user [channel data](/send-notifications/setting-channel-data)
when sending [Slack notifications](/integrations/slack).

### Attributes

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
  <Attribute
    name="id"
    type="string"
    description="A unique identifier for the object within the collection."
  />
  <Attribute
    name="locale"
    type="string (optional)"
    description={
      <>
        <span>The locale of the object. Used for </span>
        <a href="/concepts/translations">message localization</a>
        <span>.</span>
      </>
    }
  />
  <Attribute
    name="timezone"
    type="string (optional)"
    description={
      <>
        <span>
          The timezone of the object. Must be a valid{" "}
          <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">
            tz database time zone string
          </a>
          . Used for <a href="/concepts/schedules#scheduling-workflows-with-recurring-schedules-for-recipients">
            recurring schedules
          </a> and {""}
          <a href="/designing-workflows/send-windows">send windows</a>.
        </span>
      </>
    }
  />
  <Attribute
    name="properties"
    type="object"
    description="An object of key-value pairs for attributes you want to associate with the object. Each collection has its own schema in Knock as
    defined by these properties."
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint
    name="list-objects"
    method="GET"
    path="/objects/:collection"
    withLink
  />
  <Endpoint
    name="get-object"
    method="GET"
    path="/objects/:collection/:id"
    withLink
  />
  <Endpoint
    name="get-object-messages"
    method="GET"
    path="/objects/:collection/:id/messages"
    withLink
  />
  <Endpoint
    name="set-object"
    method="PUT"
    path="/objects/:collection/:id"
    withLink
  />
  <Endpoint
    name="delete-object"
    method="DELETE"
    path="/objects/:collection/:id"
    withLink
  />
  <Endpoint
    name="bulk-set-objects"
    method="POST"
    path="/objects/:collection/bulk/set"
    withLink
  />
  <Endpoint
    name="bulk-delete-objects"
    method="POST"
    path="/objects/:collection/bulk/delete"
    withLink
  />
</Endpoints>

```json title="Object"
{
  "__typename": "Object",
  "id": "project-123",
  "collection": "projects",
  "properties": {
    "name": "My project"
  },
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="List objects" slug="list-objects">
<ContentColumn>

Lists all objects under a collection. Note: does not validate that the collection exists and contains objects. You can optionally request all preferences associated with an object while listing by passing `include[]=preferences`.

### Endpoint

<Endpoint name="list-objects" method="GET" path="/objects/:collection" />

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
  <Attribute
    name="include"
    type="string[]"
    description="A list of entities to side load as part of the response. Currently only supports `preferences`."
  />
</Attributes>

### Response

Returns a paginated list of `Object` records.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.list"
  title="List objects in a collection"
/>

```json title="Response"
{
  "entries": [
    {
      "__typename": "Object",
      "id": "project-123",
      "collection": "projects",
      "properties": {
        "name": "My project"
      },
      "created_at": null,
      "updated_at": "2021-03-05T12:00:00Z"
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section title="Get an object" slug="get-object">
<ContentColumn>

Retrieve an object in a collection by the id.

### Endpoint

<Endpoint name="get-object" method="GET" path="/objects/:collection/:id" />

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
  <Attribute
    name="id"
    type="string"
    description="A unique identifier for the object within the collection."
  />
</Attributes>

### Response

Returns an `Object`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="objects.get" title="Get an object" />

```json title="Response"
{
  "__typename": "Object",
  "id": "project-123",
  "collection": "projects",
  "properties": {
    "name": "My project"
  },
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section isRetentionSubject title="Object messages" slug="get-object-messages">
<ContentColumn>

Returns a paginated list of messages for an object. Will return newest messages first.

### Endpoint

<Endpoint method="GET" path="/objects/:collection/:id/messages" />

### Rate limit

<RateLimit tier={4} />

### Data retention rule

Messages outside the account's retention window will not be included in the results.

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The collection of the object"
  />
  <Attribute name="id" type="string" description="The ID of the object" />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
  <Attribute
    name="source"
    type="string (optional)"
    description="Limits the results to only items of the source workflow"
  />
  <Attribute
    name="tenant"
    type="string (optional)"
    description="Limits the results to items with the corresponding tenant, or where the tenant is empty"
  />
  <Attribute
    name="status"
    type="string[] (optional)"
    description="One or more of `queued`, `sent`, `delivered`, `delivery_attempted`, `undelivered`, `bounced`, `not_sent`. Limits results to messages with the given delivery status(es)."
  />
  <Attribute
    name="engagement_status"
    type="string[] (optional)"
    description="One or more of `read`, `unread`, `seen`, `unseen`, `archived`, `unarchived`, `interacted`, `link_clicked`. Limits results to messages with the given engagement status(es)."
  />
  <Attribute
    name="channel_id"
    type="string (optional)"
    description="Limits the results to only items that belong to the channel"
  />
  <Attribute
    name="message_ids[]"
    type="string[] (optional)"
    description="Limits the results to only the message ids given (max 50). Note: when using this option, the results will be subject to any other filters applied to the query."
  />
  <Attribute
    name="workflow_categories"
    type="string[] (optional)"
    description="Limits the results to only items related to any of the provided categories"
  />
  <Attribute
    name="trigger_data"
    type="JSON string (optional)"
    description="Limits the results to only items that were generated with the given data"
    nameSlug="#trigger-data-filtering"
  />
  <Attribute
    name="inserted_at.gt"
    type="datetime (optional)"
    description="Retrieves messages inserted after the given date"
  />
  <Attribute
    name="inserted_at.gte"
    type="datetime (optional)"
    description="Retrieves messages inserted after or equal to the given date"
  />
  <Attribute
    name="inserted_at.lt"
    type="datetime (optional)"
    description="Retrieves messages inserted before the given date"
  />
  <Attribute
    name="inserted_at.lte"
    type="datetime (optional)"
    description="Retrieves messages inserted before or equal to the given date"
  />
</Attributes>

### Returns

A paginated list of Message records

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="objects.messages" title="Get object messages" />

```json title="Response"
{
  "items": [
    {
      "__typename": "Message",
      "__cursor": "g3QAAAABZAACaWRtAAAAGzFzTXRJc1J2WnRZZjg2YU9ma00yUENwQzZYYw==",
      "id": "1rjI9XBgWQ6EUA3D3Ul3VjUimOD",
      "channel_id": "0bfd9f86-56b0-41f0-ade3-dc5cc6a69bb8",
      "recipient": {
        "id": "project_1",
        "collection": "projects"
      },
      "actors": [],
      "workflow": "merged-changes",
      "tenant": null,
      "status": "delivered",
      "engagement_statuses": ["read", "interacted"],
      "seen_at": null,
      "read_at": "2021-05-11T00:00:00.00Z",
      "interacted_at": "2021-05-11T00:00:00.00Z",
      "link_clicked_at": null,
      "archived_at": null,
      "inserted_at": "2021-03-05T12:00:00Z",
      "updated_at": "2021-03-05T12:00:00Z",
      "source": {
        "__typename": "WorkflowSource",
        "key": "merged-changes",
        "version_id": "7251cd3f-0028-4d1a-9466-ee79522ba3de",
        "categories": ["reminders"]
      },
      "data": {
        "foo": "bar"
      },
      "metadata": {
        "external_id": "external_id_from_provider"
      }
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section title="Set an object" slug="set-object">
<ContentColumn>

Sets an object within a collection, performing an upsert operation. Any existing properties will be merged with the incoming properties.

### Endpoint

<Endpoint name="set-object" method="PUT" path="/objects/:collection/:id" />

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
  <Attribute
    name="id"
    type="string"
    description="A unique identifier for the object within the collection."
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="locale"
    type="string (optional)"
    description={
      <>
        <span>The locale of the object. Used for </span>
        <a href="/concepts/translations">message localization</a>
        <span>.</span>
      </>
    }
  />
  <Attribute
    name="timezone"
    type="string (optional)"
    description={
      <>
        <span>
          The timezone of the object. Must be a valid{" "}
          <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">
            tz database time zone string
          </a>
          . Used for <a href="/concepts/schedules#scheduling-workflows-with-recurring-schedules-for-recipients">
            recurring schedules
          </a> and {""}
          <a href="/designing-workflows/send-windows">send windows</a>.
        </span>
      </>
    }
  />
  <Attribute
    name="preferences"
    type="object<string, PreferenceSet>  (optional)"
    typeSlug="/api-reference/recipients/preferences"
    description="A set of preferences that determines whether a recipient should receive a particular type of notification."
  />
  <Attribute
    name="channel_data"
    type="object<string, ChannelData> (optional)"
    typeSlug="/api-reference/recipients/channel_data"
    description="Channel-specific information that's needed to deliver a notification to an end provider."
  />
  <Attribute
    name="*"
    type="any"
    description="A collection of key value pairs to set as properties for this object."
  />
</Attributes>

### Response

Returns an `Object`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="objects.set" title="Set an object" />

```json title="Response"
{
  "__typename": "Object",
  "id": "project-1",
  "collection": "projects",
  "properties": {
    "name": "My project",
    "total_assets": 10,
    "tags": ["cool", "fun", "project"],
    "locale": "en-US",
    "timezone": "America/New_York"
  },
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Delete an object" slug="delete-object">
<ContentColumn>

Deletes an object from a collection by the id provided.

### Endpoint

<Endpoint
  name="delete-object"
  method="DELETE"
  path="/objects/:collection/:id"
/>

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
  <Attribute
    name="id"
    type="string"
    description="A unique identifier for the object within the collection."
  />
</Attributes>

### Response

No response.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="objects.delete" title="Delete an object" />

</ExampleColumn>
</Section>

<Section title="Bulk set objects in a collection" slug="bulk-set-objects">
<ContentColumn>

Bulk sets up to 1000 objects at a time within a collection. Returns a `BulkOperation` that executes the job asynchronously. Progress can be tracked via the [BulkOperation API](#bulk-operations).

### Endpoint

<Endpoint
  name="bulk-set-objects"
  method="POST"
  path="/objects/:collection/bulk/set"
/>

### Rate limit

<RateLimit tier={1} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="objects[].id"
    type="string"
    description="The id of the object to set."
  />
  <Attribute
    name="objects[].*"
    type="any"
    description="Key value pairs to set as properties on this object."
  />
</Attributes>

### Response

Returns a `BulkOperation`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.bulkSet"
  title="Bulk set objects in a collection"
/>

```json title="Response"
{
  "__typename": "BulkOperation",
  "completed_at": "2021-03-05T12:00:00Z",
  "error_count": 0,
  "error_items": [],
  "estimated_total_rows": 42,
  "failed_at": null,
  "id": "50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "inserted_at": "2021-03-05T12:00:00Z",
  "name": "objects.<collection>.set",
  "processed_rows": 42,
  "progress_path": "/v1/bulk_operations/50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "started_at": "2021-03-05T12:00:00Z",
  "status": "completed",
  "success_count": 42,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Bulk delete objects in a collection" slug="bulk-delete-objects">
<ContentColumn>

Bulk deletes up to 1000 objects at a time within a collection. Returns a `BulkOperation` that executes the job asynchronously. Progress can be tracked via the [BulkOperation API](#bulk-operations).

### Endpoint

<Endpoint
  name="bulk-delete-objects"
  method="POST"
  path="/objects/:collection/bulk/delete"
/>

### Rate limit

<RateLimit tier={1} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="object_ids"
    type="string[]"
    description="The ids of the objects to delete within the collection"
  />
</Attributes>

### Response

Returns a `BulkOperation`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.bulkDelete"
  title="Bulk delete objects in a collection"
/>

```json title="Response"
{
  "__typename": "BulkOperation",
  "completed_at": "2021-03-05T12:00:00Z",
  "error_count": 0,
  "error_items": [],
  "estimated_total_rows": 42,
  "failed_at": null,
  "id": "50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "inserted_at": "2021-03-05T12:00:00Z",
  "name": "objects.<collection>.delete",
  "processed_rows": 42,
  "progress_path": "/v1/bulk_operations/50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "started_at": "2021-03-05T12:00:00Z",
  "status": "completed",
  "success_count": 42,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Subscriptions" slug="subscriptions">
<ContentColumn>

A subscription represents the relationship between a recipient (the subscriber) and an object.

### Attributes

<Attributes>
  <Attribute
    name="properties"
    type="object"
    description="An object of key-value pairs for attributes you want to associate with the subscription."
  />
  <Attribute
    name="recipient"
    type="object"
    description="A user or an object associated with this subscription"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint
    name="list-subscriptions"
    method="GET"
    path="/objects/:collection/:id/subscriptions"
    withLink
  />
  <Endpoint
    name="get-user-subscriptions"
    method="GET"
    path="/users/:id/subscriptions"
    withLink
  />
  <Endpoint
    name="add-subscriptions"
    method="POST"
    path="/objects/:collection/:id/subscriptions"
    withLink
  />
  <Endpoint
    name="bulk-add-subscriptions"
    method="POST"
    path="/objects/:collection/bulk/subscriptions/add"
    withLink
  />
  <Endpoint
    name="delete-subscriptions"
    method="DELETE"
    path="/objects/:collection/:id/subscriptions"
    withLink
  />
</Endpoints>

```json title="Tenant"
{
  "__typename": "ObjectSubscription",
  "properties": {
    "role": "ADMIN"
  },
  "recipient": {
    "__typename": "User",
    "id": "dnedry",
    "name": "Dennis Nedry",
    "email": "dnedry@ingen.net"
  },
  "inserted_at": "2021-03-05T12:00:00Z",
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="List subscriptions" slug="list-subscriptions">
<ContentColumn>

Lists all subscriptions to an object (the subscribers) or all of the current subscriptions for which the specified object is a recipient, depending on the `mode` given. Defaults to returning subscriber information.

Will return the underlying recipient attached. Note: the object must exist.

### Endpoint

<Endpoint
  name="list-subscriptions"
  method="GET"
  path="/objects/:collection/:id/subscriptions"
/>

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="A collection that the object belongs to"
  />
  <Attribute
    name="id"
    type="string"
    description="The unique identifier of the object in the collection"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before"
  />
  <Attribute
    name="mode"
    type="string"
    description='When set to "recipient" will return all of the active subscriptions for which the specified object is a recipient (as a subscriber to other objects), rather than the subscribers of the specified object.'
  />
  <Attribute
    name="objects"
    type="object<string, ObjectRef>"
    description='A collection of ObjectRefs, containing the object collection and id, to filter subscriptions. Filtering by objects will only be enabled when mode is set to "recipient."'
  />
  <Attribute
    name="recipients"
    type="string[] | object<string, RecipientRef>"
    description="A collection of recipient identifiers (user_ids and/or ObjectRefs) to filter subscribers of the object. Filtering by recipients will only be enabled when mode is not set."
  />
</Attributes>

### Response

A paginated list response

</ContentColumn>
<ExampleColumn>

```json title="Response"
{
  "entries": [
    {
      "__typename": "ObjectSubscription",
      "properties": {
        "role": "ADMIN"
      },
      "recipient": {
        "__typename": "User",
        "id": "dnedry",
        "name": "Dennis Nedry",
        "email": "dnedry@ingen.net"
      },
      "object": {
        "__typename": "Object",
        "collection": "project",
        "id": "project-1",
        "properties": {
          "name": "Project 1"
        }
      },
      "inserted_at": "2021-03-05T12:00:00Z",
      "updated_at": "2021-03-05T12:00:00Z"
    }
  ],
  "page_info": {
    "after": null,
    "before": null,
    "page_size": 25
  }
}
```

</ExampleColumn>
</Section>

<Section title="User subscriptions" slug="get-user-subscriptions">
<ContentColumn>

Returns a paginated list of subscriptions for a single user, in descending order.

### Endpoint

<Endpoint
  name="get-recipient-subscriptions"
  method="GET"
  path="/users/:id/subscriptions"
/>

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="The unique identifier of the User"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
  <Attribute
    name="objects"
    type="object<string, ObjectRef>"
    description="A collection of ObjectRefs, containing the object collection and id, to filter subscriptions."
  />
</Attributes>

### Response

A paginated response containing a list of `Subscription` entities.

</ContentColumn>
<ExampleColumn>

```json title="Response"
{
  "entries": [
    {
      "__typename": "ObjectSubscription",
      "properties": {
        "role": "ADMIN"
      },
      "recipient": {
        "__typename": "User",
        "id": "dnedry",
        "name": "Dennis Nedry",
        "email": "dnedry@ingen.net"
      },
      "object": {
        "__typename": "Object",
        "collection": "project",
        "id": "project-1",
        "properties": {
          "name": "Project 1"
        }
      },
      "inserted_at": "2021-03-05T12:00:00Z",
      "updated_at": "2021-03-05T12:00:00Z"
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section title="Add subscriptions" slug="add-subscriptions">
<ContentColumn>

Adds one or more recipients as subscribers to the object by creating subscriptions.

### Endpoint

<Endpoint
  name="add-subscriptions"
  method="POST"
  path="/objects/:collection/:id/subscriptions"
/>

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="A collection that the object belongs to"
  />
  <Attribute
    name="id"
    type="string"
    description="The unique identifier of the object in the collection"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="recipients"
    type="RecipientIdentifier[]"
    description="A list of recipient identifiers. You can subscribe up to 100 recipients to an object at a time."
    typeSlug="/concepts/recipients#recipientidentifier-definition"
  />
  <Attribute
    name="properties"
    type="map (optional)"
    description="An optional set of key-value pairs to associate with the subscriptions"
  />
</Attributes>

### Response

A list of created `ObjectSubscription`

</ContentColumn>
<ExampleColumn>

```json title="Request"
{
  "recipients": ["dnedry"],
  "properties": {
    "role": "ADMIN"
  }
}
```

```json title="Response"
[
  {
    "__typename": "ObjectSubscription",
    "properties": {
      "role": "ADMIN"
    },
    "recipient": {
      "__typename": "User",
      "id": "dnedry",
      "name": "Dennis Nedry",
      "email": "dnedry@ingen.net"
    },
    "inserted_at": "2021-03-05T12:00:00Z",
    "updated_at": "2021-03-05T12:00:00Z"
  }
]
```

</ExampleColumn>
</Section>

<Section title="Bulk add subscriptions" slug="bulk-add-subscriptions">
<ContentColumn>

Creates subscriptions for one or more recipients to one or more objects within the specified `collection`. You can create up to 50 recipient subscriptions per object at a time and you can modify up to 100 objects per request, totaling up to 5,000 operations per request.

Returns a `BulkOperation` that executes the job asynchronously. Progress can be tracked via the [BulkOperation API](#bulk-operations).

### Endpoint

<Endpoint
  name="bulk-add-subscriptions"
  method="POST"
  path="/objects/:collection/bulk/subscriptions/add"
/>

### Rate limit

<RateLimit tier={1} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="subscriptions"
    type="AddSubscriptionsOp[]"
    description="A list of subscriptions to create. Each entry represents a set of Recipients to subscribe to an Object."
  />
</Attributes>

### Response

A `BulkOperation`.

</ContentColumn>

<ExampleColumn>

```json title="Request body"
{
  "subscriptions": [
    {
      "id": "my-object-1",
      "properties": {
        "foo": "bar",
        "biz": "baz"
      },
      "recipients": ["user-1", "user-2", "user-3"]
    },
    {
      "id": "my-object-2",
      "recipients": [{ "id": "user-3", "email": "user-3@example.com" }]
    }
  ]
}
```

```json title="Response"
{
  "__typename": "BulkOperation",
  "completed_at": "2021-03-05T12:00:00Z",
  "error_count": 0,
  "error_items": [],
  "estimated_total_rows": 42,
  "failed_at": null,
  "id": "50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "inserted_at": "2021-03-05T12:00:00Z",
  "name": "objects.<collection>.upsert_subscriptions",
  "processed_rows": 42,
  "progress_path": "/v1/bulk_operations/50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "started_at": "2021-03-05T12:00:00Z",
  "status": "completed",
  "success_count": 42,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Delete subscriptions" slug="delete-subscriptions">
<ContentColumn>

Removes one or more recipients as subscribers to the object.

### Endpoint

<Endpoint
  name="delete-subscriptions"
  method="DELETE"
  path="/objects/:collection/:id/subscriptions"
/>

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="A collection that the object belongs to"
  />
  <Attribute
    name="id"
    type="string"
    description="The unique identifier of the object in the collection"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="recipients"
    type="RecipientIdentifier[]"
    description="A list of recipient identifiers"
    typeSlug="/concepts/recipients#recipientidentifier-definition"
  />
</Attributes>

### Response

A list of deleted `ObjectSubscription`

</ContentColumn>
<ExampleColumn>

```json title="Request"
{
  "recipients": ["dnedry"]
}
```

```json title="Response"
[
  {
    "__typename": "ObjectSubscription",
    "properties": {
      "role": "ADMIN"
    },
    "recipient": {
      "__typename": "User",
      "id": "dnedry",
      "name": "Dennis Nedry",
      "email": "dnedry@ingen.net"
    },
    "inserted_at": "2021-03-05T12:00:00Z",
    "updated_at": "2021-03-05T12:00:00Z"
  }
]
```

</ExampleColumn>
</Section>

<Section title="Preferences" slug="preferences">
<ContentColumn>

A preference determines whether a recipient should receive a particular type of notification. By default
all preferences are opted in unless a preference explicitly opts the recipient out of the notification.

The preference set `:id` can be either `"default"` or a `tenant.id`. Learn more about [per-tenant preferences](/preferences/tenant-preferences).

[Read more about Preferences](/concepts/preferences).

### Attributes

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="Unique identifier for the preference set"
  />
  <Attribute
    name="workflows"
    type="object"
    description="A set of preferences for workflows, each can resolve to a boolean, to a set of channel types, or to a set of conditions"
  />
  <Attribute
    name="channel_types"
    type="object"
    description="A set of preferences for channel types"
  />
  <Attribute
    name="categories"
    type="object"
    description="A set of preferences for workflow categories, each can resolve to a boolean, to a set of channel types, or to a set of conditions"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint
    name="get-all-preferences-user"
    method="GET"
    path="/users/:user_id/preferences"
    withLink
  />
  <Endpoint
    name="get-preferences-user"
    method="GET"
    path="/users/:user_id/preferences/:id"
    withLink
  />
  <Endpoint
    name="set-preferences-user"
    method="PUT"
    path="/users/:user_id/preferences/:id"
    withLink
  />
  <Endpoint
    name="get-all-preferences-object"
    method="GET"
    path="/objects/:collection/:object_id/preferences"
    withLink
  />
  <Endpoint
    name="get-preferences-object"
    method="GET"
    path="/objects/:collection/:object_id/preferences/:id"
    withLink
  />
  <Endpoint
    name="set-preferences-object"
    method="PUT"
    path="/objects/:collection/:object_id/preferences/:id"
    withLink
  />
  <Endpoint
    name="bulk-set-preferences"
    method="POST"
    path="/users/bulk/preferences"
    withLink
  />
</Endpoints>

```json title="PreferenceSet object"
{
  "__typename": "PreferenceSet",
  "id": "default",
  "workflows": {
    "dinosaurs-loose": {
      "channel_types": {
        "email": true
      }
    }
  },
  "channel_types": {
    "in_app_feed": true,
    "sms": false
  },
  "categories": {
    "park-wide": {
      "channel_types": {
        "sms": false
      }
    }
  }
}
```

</ExampleColumn>
</Section>

<Section title="Listing user preferences" slug="get-all-preferences-user">
<ContentColumn>

Retrieve all preference sets for a user. This endpoint returns a list of preference sets associated with the user.

### Endpoint

<Endpoint
  name="get-all-preferences-user"
  method="GET"
  path="/users/:user_id/preferences"
/>

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="user_id"
    type="string"
    description="Unique identifier for the user"
  />
</Attributes>

### Response

Returns a list of `PreferenceSet` objects.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.listPreferences"
  title="List a user's preferences"
/>

```json title="Response"
[
  {
    "__typename": "PreferenceSet",
    "id": "default",
    "workflows": null,
    "channel_types": {
      "in_app_feed": true,
      "sms": true
    },
    "categories": {
      "park-wide": {
        "sms": false
      }
    }
  },
  {
    "__typename": "PreferenceSet",
    "id": "tenant-1",
    "workflows": {
      "new-comment": {
        "channel_types": {
          "email": false,
          "in_app_feed": true
        }
      }
    },
    "channel_types": {
      "in_app_feed": true,
      "sms": false
    },
    "categories": null
  }
]
```

</ExampleColumn>
</Section>

<Section title="Getting user preferences" slug="get-preferences-user">
<ContentColumn>

Retrieve a user's preference set. Will always return an empty preference set object,
even if it does not currently exist for the user.

### Endpoint

<Endpoint
  name="get-preferences-user"
  method="GET"
  path="/users/:user_id/preferences/:id"
/>

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="user_id"
    type="string"
    description="Unique identifier for the user"
  />
  <Attribute
    name="id"
    type="string"
    description="Unique identifier for the preference set"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="tenant"
    type="string"
    description="An optional tenant identifier to supply to return the user's preferences with any tenant defaults applied"
  />
</Attributes>

### Response

Returns a `PreferenceSet`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.getPreferences"
  title="Get a user's preferences"
/>

```json title="Response"
{
  "__typename": "PreferenceSet",
  "id": "default",
  "workflows": {
    "dinosaurs-loose": {
      "channel_types": {
        "email": true
      }
    }
  },
  "channel_types": {
    "in_app_feed": true,
    "sms": true
  },
  "categories": {
    "park-wide": {
      "channel_types": {
        "sms": false
      }
    }
  }
}
```

</ExampleColumn>
</Section>

<Section title="Setting user preferences" slug="set-preferences-user">
<ContentColumn>

Sets preferences within the given preference set. This is a destructive operation and will replace any existing preferences with the preferences given.

If no user exists in the current environment for the given `:user_id`, Knock will create the user entry as part of this request.

The preference set `:id` can be either `"default"` or a `tenant.id`. Learn more about [per-tenant preferences](/preferences/tenant-preferences).

### Endpoint

<Endpoint
  name="set-preferences"
  method="PUT"
  path="/users/:user_id/preferences/:id"
/>

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="user_id"
    type="string"
    description="Unique identifier for the user"
  />
  <Attribute
    name="id"
    type="string"
    description="Unique identifier for the preference set"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="channel_types"
    type="object"
    description="A set of channel type preferences"
  />
  <Attribute
    name="workflows"
    type="object"
    description="A set of workflow preferences, can be a boolean, an object containing channel type preferences, or a set of conditions"
  />
  <Attribute
    name="categories"
    type="object"
    description="A set of category preferences, can be a boolean, an object containing channel type preferences, or a set of conditions"
  />
</Attributes>

### Response

Returns a `PreferenceSet`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.setPreferences"
  title="Set a user's preferences"
/>

```json title="Response"
{
  "__typename": "PreferenceSet",
  "id": "default",
  "workflows": {
    "dinosaurs-loose": {
      "channel_types": {
        "email": true,
        "sms": true
      }
    }
  },
  "channel_types": {
    "in_app_feed": true
  },
  "categories": {
    "park-wide": {
      "sms": false
    }
  }
}
```

</ExampleColumn>
</Section>

<Section title="Listing object preferences" slug="get-all-preferences-object">
<ContentColumn>

Retrieve all preference sets for an object. This endpoint returns a list of preference sets associated with the object.

### Endpoint

<Endpoint
  name="get-all-preferences-object"
  method="GET"
  path="/objects/:collection/:object_id/preferences"
/>

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The parent collection of the object to lookup"
  />
  <Attribute
    name="object_id"
    type="string"
    description="The id of the object to lookup"
  />
</Attributes>

### Response

Returns a list of `PreferenceSet` objects.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.listPreferences"
  title="List an object's preferences"
/>

```json title="Response"
[
  {
    "__typename": "PreferenceSet",
    "id": "default",
    "workflows": null,
    "channel_types": {
      "in_app_feed": true,
      "sms": true
    },
    "categories": {
      "park-wide": {
        "sms": false
      }
    }
  },
  {
    "__typename": "PreferenceSet",
    "id": "tenant-1",
    "workflows": {
      "new-comment": {
        "channel_types": {
          "email": true,
          "in_app_feed": false
        }
      }
    },
    "channel_types": {
      "in_app_feed": true,
      "sms": false
    },
    "categories": null
  }
]
```

</ExampleColumn>
</Section>

<Section title="Getting object preferences" slug="get-preferences-object">
<ContentColumn>

Retrieve an object's preference set. Will always return an empty preference set object,
even if it does not currently exist for the object.

### Endpoint

<Endpoint
  name="get-preferences-object"
  method="GET"
  path="/objects/:collection/:object_id/preferences/:id"
/>

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The parent collection of the object to lookup"
  />
  <Attribute
    name="object_id"
    type="string"
    description="The id of the object to lookup"
  />
  <Attribute
    name="id"
    type="string"
    description="Unique identifier for the preference set"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="tenant"
    type="string"
    description="An optional tenant identifier to supply to return the user's preferences with any tenant defaults applied"
  />
</Attributes>

### Response

Returns a `PreferenceSet`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.getPreferences"
  title="Get an object's preferences"
/>

```json title="Response"
{
  "__typename": "PreferenceSet",
  "id": "default",
  "workflows": {
    "dinosaurs-loose": {
      "channel_types": {
        "email": true
      }
    }
  },
  "channel_types": {
    "in_app_feed": true,
    "sms": true
  },
  "categories": {
    "park-wide": {
      "channel_types": {
        "sms": false
      }
    }
  }
}
```

</ExampleColumn>
</Section>

<Section title="Setting object preferences" slug="set-preferences-object">
<ContentColumn>

Sets preferences within the given preference set. This is a destructive operation and will replace any existing preferences with the preferences given.

If no object exists in the current environment for the given `:collection` and `:object_id`, Knock will create the object as part of this request.

The preference set `:id` can be either `"default"` or a `tenant.id`. Learn more about [per-tenant preferences](/preferences/tenant-preferences).

### Endpoint

<Endpoint
  name="set-preferences-object"
  method="PUT"
  path="/objects/:collection/:object_id/preferences/:id"
/>

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The parent collection of the object to lookup"
  />
  <Attribute
    name="object_id"
    type="string"
    description="The id of the object to lookup"
  />
  <Attribute
    name="id"
    type="string"
    description="Unique identifier for the preference set"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="channel_types"
    type="object"
    description="A set of channel type preferences"
  />
  <Attribute
    name="workflows"
    type="object"
    description="A set of workflow preferences, can be a boolean, an object containing channel type preferences, or a set of conditions"
  />
  <Attribute
    name="categories"
    type="object"
    description="A set of category preferences, can be a boolean, an object containing channel type preferences, or a set of conditions"
  />
</Attributes>

### Response

Returns a `PreferenceSet`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.setPreferences"
  title="Set an object's preferences"
/>

```json title="Response"
{
  "__typename": "PreferenceSet",
  "id": "default",
  "workflows": {
    "dinosaurs-loose": {
      "channel_types": {
        "email": true,
        "sms": true
      }
    }
  },
  "channel_types": {
    "in_app_feed": true
  },
  "categories": {
    "park-wide": {
      "sms": false
    }
  }
}
```

</ExampleColumn>
</Section>

<Section title="Bulk set user preferences" slug="bulk-set-preferences">
<ContentColumn>

Bulk sets the preferences for up to 1,000 users at a time. Returns a `BulkOperation` that executes the job asynchronously. Progress can be tracked via the [BulkOperation API](#bulk-operations).

The preference set `:id` can be either `"default"` or a `tenant.id`. Learn more about [per-tenant preferences](/preferences/tenant-preferences).

Please note: This is a destructive operation and will replace any existing users' preferences with the preferences sent.

### Endpoint

<Endpoint
  name="bulk-set-preferences"
  method="POST"
  path="/users/bulk/preferences"
/>

### Rate limit

<RateLimit tier={1} />

### Body parameters

<Attributes>
  <Attribute
    name="user_ids"
    type="string[]"
    description="A list of user ids to set preferences for"
  />
  <Attribute
    name="preferences.id"
    type="string"
    description="The id of the preference set"
  />
  <Attribute
    name="preferences.channel_types"
    type="object"
    description="A set of channel type preferences to set"
  />
  <Attribute
    name="preferences.workflows"
    type="object"
    description="A set of workflow preferences, can be a boolean or an object containing channel type preferences"
  />
  <Attribute
    name="preferences.categories"
    type="object"
    description="A set of categories preferences, can be a boolean or an object containing channel type preferences"
  />
</Attributes>

### Response

Returns a `BulkOperation`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.bulkSetPreferences"
  title="Bulk set many users' preferences"
/>

```json title="Response"
{
  "__typename": "BulkOperation",
  "completed_at": "2021-03-05T12:00:00Z",
  "error_count": 0,
  "error_items": [],
  "estimated_total_rows": 42,
  "failed_at": null,
  "id": "50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "inserted_at": "2021-03-05T12:00:00Z",
  "name": "users.set_preferences",
  "processed_rows": 42,
  "progress_path": "/v1/bulk_operations/50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "started_at": "2021-03-05T12:00:00Z",
  "status": "completed",
  "success_count": 42,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Tenants" slug="tenants">
<ContentColumn>

A Tenant represents a grouping with configurable settings that can be applied to a workflow when it's triggered in order to override account-level settings such as branding.

Use tenants when sending a notification to user(s) that you want to configure specific brand elements for, such as a separate organization logo.

### Attributes

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="A unique identifier for the tenant."
  />
  <Attribute
    name="properties"
    type="object"
    description="An object of key-value pairs for attributes you want to associate with the tenant. Currently only name is accepted as an attribute for tenants."
  />
  <Attribute
    name="settings"
    type="object"
    description="An object of key-value pairs for configurable settings on a tenant. Currently contains a preference_set key for tenant-specific default preferences, as well as a branding key which points to the following configurable values: primary_color, primary_color_contrast, icon_url, and logo_url. The icon_url and logo_url settings must be a valid image URL with an image MIME type."
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint name="list-tenants" method="GET" path="/tenants" withLink />
  <Endpoint name="get-tenant" method="GET" path="/tenants/:id" withLink />
  <Endpoint name="set-tenant" method="PUT" path="/tenants/:id" withLink />
  <Endpoint name="delete-tenant" method="DELETE" path="/tenants/:id" withLink />
</Endpoints>

```json title="Tenant"
{
  "__typename": "Tenant",
  "id": "tenant-1",
  "properties": {
    "name": "Tenant 1"
  },
  "settings": {
    "branding": {
      "primary_color": "#33FF5B",
      "primary_color_contrast": "#ffffff",
      "logo_url": "https://www.example.com/path-to-logo-asset-url",
      "icon_url": "https://www.example.com/path-to-icon-asset-url"
    },
    "preference_set": null
  },
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="List tenants for environment" slug="list-tenants">
<ContentColumn>

Lists tenants for the environment of the API key

### Endpoint

<Endpoint name="list-tenants" method="GET" path="/tenants" />

### Rate limit

<RateLimit tier={4} />

### Response

Returns a list of `Tenant` objects.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="tenants.list"
  title="List tenants in an environment"
/>

```json title="Response"
{
  "entries": [
    {
      "__typename": "Tenant",
      "id": "tenant-1",
      "properties": {
        "name": "Tenant 1"
      },
      "settings": {
        "branding": {
          "primary_color": "#33FF5B",
          "primary_color_contrast": "#ffffff",
          "logo_url": "https:www.example.com/path-to-logo-asset-url",
          "icon_url": "https:www.example.com/path-to-icon-asset-url"
        },
        "preference_set": null
      },
      "created_at": null,
      "updated_at": "2021-03-05T12:00:00Z"
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50,
    "total_count": 1
  }
}
```

</ExampleColumn>
</Section>

<Section title="Get a tenant" slug="get-tenant">
<ContentColumn>

Retrieve a tenant by its id.

### Endpoint

<Endpoint name="get-tenant" method="GET" path="/tenants/:id" />

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="A unique identifier for the tenant."
  />
</Attributes>

### Response

Returns a `Tenant`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="tenants.get"
  title="Get tenant in an environment"
/>

```json title="Response"
{
  "__typename": "Tenant",
  "id": "tenant-1",
  "properties": {
    "name": "Tenant 1"
  },
  "settings": {
    "branding": {
      "primary_color": "#33FF5B",
      "primary_color_contrast": "#ffffff",
      "logo_url": "https:www.example.com/path-to-logo-asset-url",
      "icon_url": "https:www.example.com/path-to-icon-asset-url"
    },
    "preference_set": null
  },
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Set a tenant" slug="set-tenant">
<ContentColumn>

Sets a tenant within an environment, performing an upsert operation. Any existing properties will be merged with the incoming properties.

### Endpoint

<Endpoint name="set-tenant" method="PUT" path="/tenants/:id" />

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="A unique identifier for the tenant."
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="name"
    type="string"
    description="The name to set on the tenant's name property."
  />
  <Attribute
    name="settings"
    type="object"
    description="An object of key-value pairs for configurable settings on a tenant. Currently contains a preference_set key for tenant-specific default preferences, as well as a branding key which points to the following configurable values: primary_color, primary_color_contrast, icon_url, and logo_url. The icon_url and logo_url settings must be a valid image URL with an image MIME type."
/>

</Attributes>

### Response

Returns a `Tenant`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="tenants.set"
  title="Set tenant in an environment"
/>

```json title="Response"
{
  "__typename": "Tenant",
  "id": "tenant-1",
  "properties": {
    "name": "Tenant 1"
  },
  "settings": {
    "branding": {
      "primary_color": "#33FF5B",
      "primary_color_contrast": "#ffffff",
      "logo_url": "https:www.example.com/path-to-logo-asset-url",
      "icon_url": "https:www.example.com/path-to-icon-asset-url"
    },
    "preference_set": null
  },
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Delete a tenant" slug="delete-tenant">
<ContentColumn>

Deletes a tenant by the id provided.

### Endpoint

<Endpoint name="delete-tenant" method="DELETE" path="/tenants/:id" />

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="A unique identifier for the tenant within the collection."
  />
</Attributes>

### Response

No response.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="tenants.delete"
  title="Delete tenant from an environment"
/>
</ExampleColumn>
</Section>

<Section title="Schedules" slug="schedules">
<ContentColumn>

A schedule allows you to automatically trigger a workflow at a given time for one or more recipients. You can think of a schedule as a managed, recipient-timezone-aware cron job that Knock will run on your behalf.

[Learn more about schedules](/concepts/schedules)

### Attributes

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="A unique, Knock generated identifier for the schedule."
  />
  <Attribute
    name="actor"
    type="Recipient | null"
    description="The actor to be referenced on the workflow trigger."
  />
  <Attribute
    name="recipient"
    type="Recipient"
    description="The recipient of the scheduled workflow."
  />
  <Attribute
    name="data"
    type="object | null"
    description="Static data to be passed to the workflow trigger."
  />
  <Attribute
    name="workflow"
    type="string"
    description="The key of the workflow that will be triggered in this schedule."
  />
  <Attribute
    name="tenant"
    type="string | null"
    description="The tenant to be passed to the workflow trigger."
  />
  <Attribute
    name="repeats"
    type="ScheduleRepeat[] | null"
    description="A list of one or more repeat definitions that determine when this schedule should run."
  />
  <Attribute
    name="last_occurrence_at | null"
    type="datetime (optional)"
    description="A datetime string in UTC that indicates when the last run for the schedule happened."
  />
  <Attribute
    name="next_occurrence_at | null"
    type="datetime (optional)"
    description="A datetime string in the recipient's timezone that indicates when the schedule will next run, generated from the repeat rules."
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint name="list-schedules" method="GET" path="/schedules" withLink />
  <Endpoint
    name="get-user-schedules"
    method="GET"
    path="/users/:id/schedules"
    withLink
  />
  <Endpoint
    name="get-object-schedules"
    method="GET"
    path="/objects/:collection/:id/schedules"
    withLink
  />
  <Endpoint name="create-schedules" method="POST" path="/schedules" withLink />
  <Endpoint name="update-schedules" method="PUT" path="/schedules" withLink />
  <Endpoint
    name="delete-schedules"
    method="DELETE"
    path="/schedules"
    withLink
  />
  <Endpoint
    name="bulk-create-schedules"
    method="POST"
    path="/schedules/bulk/create"
    withLink
  />
</Endpoints>

```json title="Schedule"
{
  "__typename": "Schedule",
  "id": "2OqXCSJUgbhhgIX3iaPfI3ZOVd9",
  "actor": null,
  "data": {
    "custom_key": "custom_value"
  },
  "last_occurrence_at": "2023-04-17T08:30:00Z",
  "next_occurrence_at": "2023-04-24T08:30:00Z",
  "recipient": {
    "__typename": "User",
    "id": "dnedry",
    "name": "Dennis Nedry",
    "email": "dnedry@ingen.net"
  },
  "repeats": [
    {
      "__typename": "ScheduleRepeat",
      "day_of_month": null,
      "days": ["mon"],
      "frequency": "weekly",
      "hours": 8,
      "interval": 1,
      "minutes": 30
    }
  ],
  "workflow": "some-workflow",
  "tenant": null,
  "inserted_at": "2023-04-23T22:29:17.216686Z",
  "updated_at": "2023-04-23T22:29:17.216686Z"
}
```

</ExampleColumn>
</Section>

<Section title="List schedules" slug="list-schedules">
<ContentColumn>

Returns a paginated list of schedules in descending order.

### Endpoint

<Endpoint name="list-schedules" method="GET" path="/schedules" />

### Rate limit

<RateLimit tier={4} />

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
  <Attribute
    name="workflow"
    type="string (required)"
    description="The workflow key to filter schedules for."
  />
  <Attribute
    name="recipients"
    type="string[] | object<string, RecipientRef>"
    description="A collection of recipient identifiers (user_ids and/or ObjectRefs) to filter schedules for."
  />
  <Attribute
    name="tenant"
    type="string"
    description="A tenant identifier to filter schedules for."
  />
</Attributes>

### Response

A paginated response containing a list of `Schedule` entities.

</ContentColumn>
<ExampleColumn>

```json title="Response"
{
  "entries": [
    {
      "__typename": "Schedule",
      "__cursor": "g3QAAAABZAACaWRtAAAAGzFzTXRJc1J2WnRZZjg2YU9ma00yUENwQzZYYw==",
      "id": "2OqXCSJUgbhhgIX3iaPfI3ZOVd9",
      "actor": null,
      "data": {
        "custom_key": "custom_value"
      },
      "last_occurrence_at": "2023-04-17T08:30:00Z",
      "next_occurrence_at": "2023-04-24T08:30:00Z",
      "recipient": {
        "__typename": "User",
        "id": "dnedry",
        "name": "Dennis Nedry",
        "email": "dnedry@ingen.net"
      },
      "repeats": [
        {
          "__typename": "ScheduleRepeat",
          "day_of_month": null,
          "days": ["mon"],
          "frequency": "weekly",
          "hours": 8,
          "interval": 1,
          "minutes": 30
        }
      ],
      "workflow": "digest-workflow",
      "tenant": null,
      "inserted_at": "2023-04-23T22:29:17.216686Z",
      "updated_at": "2023-04-23T22:29:17.216686Z"
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section title="User schedules" slug="get-user-schedules">
<ContentColumn>

Returns a paginated list of schedules for a single user, in descending order.

### Endpoint

<Endpoint
  name="get-recipient-schedules"
  method="GET"
  path="/users/:id/schedules"
/>

### Rate limit

<RateLimit tier={4} />

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
  <Attribute
    name="workflow"
    type="string (required)"
    description="The workflow key to filter schedules for."
  />
  <Attribute
    name="tenant"
    type="string"
    description="A tenant identifier to filter schedules for."
  />
</Attributes>

### Response

A paginated response containing a list of `Schedule` entities.

</ContentColumn>
<ExampleColumn>

```json title="Response"
{
  "entries": [
    {
      "__typename": "Schedule",
      "__cursor": "g3QAAAABZAACaWRtAAAAGzFzTXRJc1J2WnRZZjg2YU9ma00yUENwQzZYYw==",
      "id": "2OqXCSJUgbhhgIX3iaPfI3ZOVd9",
      "actor": null,
      "data": {
        "custom_key": "custom_value"
      },
      "last_occurrence_at": "2023-04-17T08:30:00Z",
      "next_occurrence_at": "2023-04-24T08:30:00Z",
      "recipient": {
        "__typename": "User",
        "id": "dnedry",
        "name": "Dennis Nedry",
        "email": "dnedry@ingen.net"
      },
      "repeats": [
        {
          "__typename": "ScheduleRepeat",
          "day_of_month": null,
          "days": ["mon"],
          "frequency": "weekly",
          "hours": 8,
          "interval": 1,
          "minutes": 30
        }
      ],
      "workflow": "digest-workflow",
      "tenant": null,
      "inserted_at": "2023-04-23T22:29:17.216686Z",
      "updated_at": "2023-04-23T22:29:17.216686Z"
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section title="Object schedules" slug="get-object-schedules">
<ContentColumn>

Returns a paginated list of schedules for a single object, in descending order.

### Endpoint

<Endpoint
  name="get-recipient-schedules"
  method="GET"
  path="/objects/:collection/:id/schedules"
/>

### Rate limit

<RateLimit tier={4} />

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
  <Attribute
    name="workflow"
    type="string (required)"
    description="The workflow key to filter schedules for."
  />
  <Attribute
    name="tenant"
    type="string"
    description="A tenant identifier to filter schedules for."
  />
</Attributes>

### Response

A paginated response containing a list of `Schedule` entities.

</ContentColumn>
<ExampleColumn>

```json title="Response"
{
  "entries": [
    {
      "__typename": "Schedule",
      "__cursor": "g3QAAAABZAACaWRtAAAAGzFzTXRJc1J2WnRZZjg2YU9ma00yUENwQzZYYw==",
      "id": "2OqXCSJUgbhhgIX3iaPfI3ZOVd9",
      "actor": null,
      "data": {
        "custom_key": "custom_value"
      },
      "last_occurrence_at": "2023-04-17T08:30:00Z",
      "next_occurrence_at": "2023-04-24T08:30:00Z",
      "recipient": {
        "__typename": "User",
        "id": "dnedry",
        "name": "Dennis Nedry",
        "email": "dnedry@ingen.net"
      },
      "repeats": [
        {
          "__typename": "ScheduleRepeat",
          "day_of_month": null,
          "days": ["mon"],
          "frequency": "weekly",
          "hours": 8,
          "interval": 1,
          "minutes": 30
        }
      ],
      "workflow": "digest-workflow",
      "tenant": null,
      "inserted_at": "2023-04-23T22:29:17.216686Z",
      "updated_at": "2023-04-23T22:29:17.216686Z"
    }
  ],
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section title="Create schedules" slug="create-schedules">
<ContentColumn>

Creates new schedules for the recipients provided. Up to 100 recipients may be specified in a single schedule creation call. Recipients may be inline-identified during this call.

### Endpoint

<Endpoint name="create-schedules" method="POST" path="/schedules" />

### Rate limit

<RateLimit tier={3} />

### Body parameters

<Attributes>
  <Attribute
    name="recipients"
    type="RecipientIdentifier[]"
    description="A list of recipient identifiers"
    typeSlug="/concepts/recipients#recipientidentifier-definition"
  />
  <Attribute
    name="actor"
    type="Recipient | null"
    description="The actor to be referenced on the workflow trigger for this schedule."
  />
  <Attribute
    name="data"
    type="object | null"
    description="Static data to be passed to the workflow trigger or this schedule."
  />
  <Attribute
    name="workflow"
    type="string"
    description="The key of the workflow that will be triggered in this schedule."
  />
  <Attribute
    name="tenant"
    type="string | null"
    description="The tenant to be passed to the workflow trigger for this schedule."
  />
  <Attribute
    name="repeats"
    type="ScheduleRepeat[] | null"
    description="A list of one or more repeat definitions that determine when this schedule should run."
  />
  <Attribute
    name="scheduled_at"
    type="string"
    description="A UTC datetime in ISO-8601 format representing the start moment for the recurring schedule, or the exact and only execution moment for the non-recurring schedule."
  />
</Attributes>

### Response

The list of created `Schedule` entities.

</ContentColumn>
<ExampleColumn>

```json title="Request (POST to /schedules)"
{
  "recipients": ["dnedry"],
  "workflow": "digest-workflow",
  "data": {
    "custom_key": "custom_value"
  },
  "repeats": [
    {
      "frequency": "weekly",
      "interval": 1,
      "days": ["mon"],
      "hours": 8,
      "minutes": 30
    }
  ],
  "scheduled_at": "2025-04-17T08:30:00Z"
}
```

```json title="Response"
[
  {
    "__typename": "Schedule",
    "id": "2OqXCSJUgbhhgIX3iaPfI3ZOVd9",
    "actor": null,
    "data": {
      "custom_key": "custom_value"
    },
    "last_occurrence_at": null,
    "next_occurrence_at": "2025-04-17T08:30:00Z",
    "recipient": {
      "__typename": "User",
      "id": "dnedry",
      "name": "Dennis Nedry",
      "email": "dnedry@ingen.net"
    },
    "repeats": [
      {
        "__typename": "ScheduleRepeat",
        "day_of_month": null,
        "days": ["mon"],
        "frequency": "weekly",
        "hours": 8,
        "interval": 1,
        "minutes": 30
      }
    ],
    "workflow": "digest-workflow",
    "tenant": null,
    "inserted_at": "2024-04-23T22:29:17.216686Z",
    "updated_at": "2024-04-23T22:29:17.216686Z"
  }
]
```

</ExampleColumn>
</Section>

<Section title="Update schedules" slug="update-schedules">
<ContentColumn>

Updates the schedules for the `schedule_ids` given. Can update up to 100 schedules at a time.

### Endpoint

<Endpoint name="update-schedules" method="PUT" path="/schedules" />

### Rate limit

<RateLimit tier={3} />

### Body parameters

<Attributes>
  <Attribute
    name="schedule_ids"
    type="string[]"
    description="A list of schedule ids of the schedules to mutate."
  />
  <Attribute
    name="actor"
    type="Recipient | null"
    description="The actor to be referenced on the workflow trigger for this schedule."
  />
  <Attribute
    name="data"
    type="object | null"
    description="Static data to be passed to the workflow trigger or this schedule."
  />
  <Attribute
    name="tenant"
    type="string | null"
    description="The tenant to be passed to the workflow trigger for this schedule."
  />
  <Attribute
    name="repeats"
    type="ScheduleRepeat[] | null"
    description="A list of one or more repeat definitions that determine when this schedule should run."
  />
  <Attribute
    name="scheduled_at"
    type="string"
    description="A UTC datetime in ISO-8601 format representing the start moment for the recurring schedule, or the exact and only execution moment for the non-recurring schedule."
  />
</Attributes>

### Response

The list of updated `Schedule` entities.

</ContentColumn>
<ExampleColumn>

```json title="Request (PUT to /schedules)"
{
  "schedule_ids": ["2OqXCSJUgbhhgIX3iaPfI3ZOVd9"],
  "data": {
    "custom_key": "custom_value",
    "another_key": "another_value"
  },
  "repeats": [
    {
      "frequency": "weekly",
      "interval": 1,
      "days": ["mon"],
      "hours": 8,
      "minutes": 30
    }
  ]
}
```

```json title="Response"
[
  {
    "__typename": "Schedule",
    "id": "2OqXCSJUgbhhgIX3iaPfI3ZOVd9",
    "actor": null,
    "data": {
      "custom_key": "custom_value",
      "another_key": "another_value"
    },
    "next_occurrence_at": "2023-04-17T08:30:00Z",
    "next_occurrence_at": "2023-04-24T08:30:00Z",
    "recipient": {
      "__typename": "User",
      "id": "dnedry",
      "name": "Dennis Nedry",
      "email": "dnedry@ingen.net"
    },
    "repeats": [
      {
        "__typename": "ScheduleRepeat",
        "day_of_month": null,
        "days": ["mon"],
        "frequency": "weekly",
        "hours": 8,
        "interval": 1,
        "minutes": 30
      }
    ],
    "workflow": "digest-workflow",
    "tenant": null,
    "inserted_at": "2023-04-23T22:29:17.216686Z",
    "updated_at": "2023-04-23T22:29:17.216686Z"
  }
]
```

</ExampleColumn>
</Section>

<Section title="Delete schedules" slug="delete-schedules">
<ContentColumn>

Deletes the schedules for the `schedule_ids` given. Can delete up to 100 schedules at a time. Deleting a schedule will cancel its next occurrence immediately. Any running scheduled workflows will not be affected.

### Endpoint

<Endpoint name="delete-schedules" method="DELETE" path="/schedules" />

### Rate limit

<RateLimit tier={3} />

### Body parameters

<Attributes>
  <Attribute
    name="schedule_ids"
    type="string[]"
    description="A list of schedule ids of the schedules to mutate."
  />
</Attributes>

### Response

The list of deleted `Schedule` entities.

</ContentColumn>
<ExampleColumn>

```json title="Request (DELETE to /schedules)"
{
  "schedule_ids": ["2OqXCSJUgbhhgIX3iaPfI3ZOVd9"]
}
```

```json title="Response"
[
  {
    "__typename": "Schedule",
    "id": "2OqXCSJUgbhhgIX3iaPfI3ZOVd9",
    "actor": null,
    "data": {
      "custom_key": "custom_value",
      "another_key": "another_value"
    },
    "next_occurrence_at": "2023-04-24T08:30:00Z",
    "recipient": {
      "__typename": "User",
      "id": "dnedry",
      "name": "Dennis Nedry",
      "email": "dnedry@ingen.net"
    },
    "repeats": [
      {
        "__typename": "ScheduleRepeat",
        "day_of_month": null,
        "days": ["mon"],
        "frequency": "weekly",
        "hours": 8,
        "interval": 1,
        "minutes": 30
      }
    ],
    "workflow": "digest-workflow",
    "tenant": null,
    "inserted_at": "2023-04-23T22:29:17.216686Z",
    "updated_at": "2023-04-23T22:29:17.216686Z"
  }
]
```

</ExampleColumn>
</Section>

<Section title="Bulk create schedules" slug="bulk-create-schedules">
<ContentColumn>

Bulk creates up to 1,000 schedules at a time. Returns a `BulkOperation` that executes the job asynchronously. Progress can be tracked via the [BulkOperation API](#bulk-operations).

**Each schedule provided in the `schedules` list must have a single recipient.** The recipients do not have to be unique across schedules.

This endpoint also handles [inline identifications](/managing-recipients/identifying-recipients#inline-identifying-recipients) for the `actor`, `recipient`, and `tenant` fields.

### Endpoint

<Endpoint
  name="bulk-create-schedules"
  method="POST"
  path="/schedules/bulk/create"
/>

### Rate limit

<RateLimit tier={1} />

### Body parameters

<Attributes>
  <Attribute
    name="schedules"
    type="Schedule[]"
    description="A list of schedules to create. Each schedule must have a single recipient. The recipients do not have to be unique."
    typeSlug="/api-reference/schedules"
  />
</Attributes>

### Response

Returns a `BulkOperation`.

</ContentColumn>
<ExampleColumn>

```json title="Request (POST to /schedules/bulk/create)"
{
  "schedules": [
    {
      "recipient": "dnedry",
      "workflow": "comment-digest",
      "data": {
        "custom_key": "custom_value"
      },
      "repeats": [
        {
          "frequency": "weekly",
          "interval": 1,
          "days": ["mon"],
          "hours": 8,
          "minutes": 30
        }
      ],
      "scheduled_at": "2025-04-17T08:30:00Z",
      "ending_at": "2025-05-24T08:30:00Z",
      "tenant": "acme_corp"
    },
    {
      "recipient": "esattler",
      "workflow": "comment-digest",
      "data": {
        "custom_key": "custom_value"
      },
      "repeats": [
        {
          "frequency": "weekly",
          "interval": 1,
          "days": ["mon"],
          "hours": 8,
          "minutes": 30
        }
      ],
      "scheduled_at": "2025-04-17T08:30:00Z",
      "ending_at": "2025-05-24T08:30:00Z",
      "tenant": "acme_corp"
    }
  ]
}
```

```json title="Response"
{
  "__typename": "BulkOperation",
  "completed_at": "2025-03-05T12:00:27Z",
  "error_count": 0,
  "error_items": [],
  "estimated_total_rows": 872,
  "failed_at": null,
  "id": "8f7e6d5c-4b3a-2d1e-9f8e-7d6c5b4a3210",
  "inserted_at": "2025-03-05T12:00:00Z",
  "name": "schedules.create_schedules",
  "processed_rows": 872,
  "progress_path": "/v1/bulk_operations/8f7e6d5c-4b3a-2d1e-9f8e-7d6c5b4a3210",
  "started_at": "2025-03-05T12:00:00Z",
  "status": "completed",
  "success_count": 872,
  "updated_at": "2025-03-05T12:00:27Z"
}
```

</ExampleColumn>
</Section>

<Section title="Channel data" slug="channel-data">
<ContentColumn>

<a href="/managing-recipients/setting-channel-data">`ChannelData`</a> is channel-specific
information stored on a Knock [user](/api-reference/users) or [object](/api-reference/objects)
that's needed to deliver a notification to an end provider.

For a push channel, this includes device-specific tokens that map the recipient to the device they use. For chat apps, such as Slack, this includes the access token used to send
notifications to a customer's Slack channel.

The shape of the `data` payload varies depending on the channel type; you can learn more about channel data schemas [here](/send-notifications/setting-channel-data#provider-data-requirements).

### Attributes

<Attributes>
  <Attribute
    name="channel_id"
    type="string"
    description="The UUID of the channel this data belongs to"
  />
  <Attribute
    name="data"
    type="object"
    description="The provider specific channel data"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint
    name="get-user-channel-data"
    method="GET"
    path="/users/:user_id/channel_data/:channel_id"
    withLink
  />
  <Endpoint
    name="set-user-channel-data"
    method="PUT"
    path="/users/:user_id/channel_data/:channel_id"
    withLink
  />
  <Endpoint
    name="unset-user-channel-data"
    method="DELETE"
    path="/users/:user_id/channel_data/:channel_id"
    withLink
  />
  <Endpoint
    name="get-object-channel-data"
    method="GET"
    path="/objects/:collection/:object_id/channel_data/:channel_id"
    withLink
  />
  <Endpoint
    name="set-object-channel-data"
    method="PUT"
    path="/objects/:collection/:object_id/channel_data/:channel_id"
    withLink
  />
  <Endpoint
    name="unset-object-channel-data"
    method="DELETE"
    path="/objects/:collection/:object_id/channel_data/:channel_id"
    withLink
  />
</Endpoints>

```json title="ChannelData object"
{
  "__typename": "ChannelData",
  "channel_id": "c2189f43-c732-488a-bfa0-fdf16e145cdf",
  "data": {
    "tokens": ["some-fcm-token"]
  }
}
```

</ExampleColumn>
</Section>

<Section title="Getting user channel data" slug="get-user-channel-data">
<ContentColumn>

Retrieves the channel data for the provided user on the channel specified.

### Endpoint

<Endpoint method="GET" path="/users/:user_id/channel_data/:channel_id" />

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="user_id"
    type="string"
    description="The id of the user to lookup"
  />
  <Attribute
    name="channel_id"
    type="string"
    description="The id of the Knock channel to lookup"
  />
</Attributes>

### Returns

- `200` with a `ChannelData` object (when found)
- `404` when not found

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.getChannelData"
  title="Get a users channel data"
/>

</ExampleColumn>
</Section>

<Section title="Setting user channel data" slug="set-user-channel-data">
<ContentColumn>

Sets channel data for the user and the channel specified.

If no user exists in the current environment for the given :user_id, Knock will create the user entry as part of this request.

### Endpoint

<Endpoint method="PUT" path="/users/:user_id/channel_data/:channel_id" />

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="user_id"
    type="string"
    description="The id of the user to lookup"
  />
  <Attribute
    name="channel_id"
    type="string"
    description="The id of the Knock channel to lookup"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="data"
    type="object"
    description={
      <p>
        The data to set for the specified <code>channel_id</code>. The shape of
        the payload varies depending on the channel. You can learn more about
        channel data schemas{" "}
        <a
          href="/send-notifications/setting-channel-data#provider-data-requirements"
          className="text-brand underline"
        >
          here
        </a>
        .
      </p>
    }
  />
</Attributes>

### Returns

- `200` with a `ChannelData` object (when set)
- `404` when the channel specified cannot be found
- `422` with errors when the data is incorrectly shaped

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.setChannelData"
  title="Set a users channel data"
/>

</ExampleColumn>
</Section>

<Section title="Unsetting user channel data" slug="unset-user-channel-data">
<ContentColumn>

Unsets (removes) channel data for the user and the channel specified.

### Endpoint

<Endpoint method="DELETE" path="/users/:user_id/channel_data/:channel_id" />

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="user_id"
    type="string"
    description="The id of the user to lookup"
  />
  <Attribute
    name="channel_id"
    type="string"
    description="The id of the Knock channel to lookup"
  />
</Attributes>

### Returns

- `204` no content
- `404` when the channel specified cannot be found

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.unsetChannelData"
  title="Unset a users channel data"
/>

</ExampleColumn>
</Section>

<Section title="Getting object channel data" slug="get-object-channel-data">
<ContentColumn>

Retrieves the channel data for the provided object on the channel specified.

### Endpoint

<Endpoint
  method="GET"
  path="/objects/:collection/:object_id/channel_data/:channel_id"
/>

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="object_id"
    type="string"
    description="The id of the object to lookup"
  />
  <Attribute
    name="collection"
    type="string"
    description="The parent collection of the object to lookup"
  />
  <Attribute
    name="channel_id"
    type="string"
    description="The id of the Knock channel to lookup"
  />
</Attributes>

### Returns

- `200` with a `ChannelData` (when found)
- `404` when not found

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.getChannelData"
  title="Get an objects channel data"
/>

</ExampleColumn>
</Section>

<Section title="Setting object channel data" slug="set-object-channel-data">
<ContentColumn>

Sets channel data for the object and the channel specified.

If no object exists in the current environment for the given :collection and :object_id, Knock will create the object as part of this request.

### Endpoint

<Endpoint
  method="PUT"
  path="/objects/:collection/:object_id/channel_data/:channel_id"
/>

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="object_id"
    type="string"
    description="The id of the object to lookup"
  />
  <Attribute
    name="collection"
    type="string"
    description="The parent collection of the object to lookup"
  />
  <Attribute
    name="channel_id"
    type="string"
    description="The id of the Knock channel to lookup"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="data"
    type="object"
    description={
      <p>
        The data to set for the specified <code>channel_id</code>. The shape of
        the payload varies depending on the channel. You can learn more about
        channel data schemas{" "}
        <a
          href="/send-notifications/setting-channel-data#provider-data-requirements"
          className="text-brand underline"
        >
          here
        </a>
        .
      </p>
    }
  />
</Attributes>

### Returns

- `200` with a `ChannelData` object (when set)
- `404` when the channel specified cannot be found
- `422` with errors when the data is incorrectly shaped

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.setChannelData.slack"
  title="Set an object's channel data"
/>

</ExampleColumn>
</Section>

<Section title="Unsetting object channel data" slug="unset-object-channel-data">
<ContentColumn>

Unsets (removes) channel data for the object and the channel specified.

### Endpoint

<Endpoint
  method="DELETE"
  path="/objects/:collection/:object_id/channel_data/:channel_id"
/>

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="object_id"
    type="string"
    description="The id of the object to lookup"
  />
  <Attribute
    name="collection"
    type="string"
    description="The parent collection of the object to lookup"
  />
  <Attribute
    name="channel_id"
    type="string"
    description="The id of the Knock channel to lookup"
  />
</Attributes>

### Returns

- `204` no content
- `404` when the channel specified cannot be found

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.unsetChannelData"
  title="Unsets an object's channel data"
/>

</ExampleColumn>
</Section>

<Section title="Bulk operations" slug="bulk-operations">
<ContentColumn>

A bulk operation is a set of changes applied across 0 or more records triggered via a call to the Knock API and performed asynchronously. The `BulkOperation` record represents the state of the operation, including recording the number of rows that have been modified during the operation.

Please note here: the `estimated_total_rows` field may have a different value to the `processed_rows` field due to the asynchronous nature of the operation.

### Attributes

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="The unique ID of this bulk operation"
  />
  <Attribute
    name="name"
    type="string"
    description="The type of operation being performed"
  />
  <Attribute
    name="estimated_total_rows"
    type="integer"
    description="An approximation of the number of rows that will be mutated in this operation"
  />
  <Attribute
    name="processed_rows"
    type="integer"
    description="The number of the rows that have been handled in this operation, either successfully or in error"
  />
  <Attribute
    name="success_count"
    type="integer"
    description="The number of the rows that have been modified successfully in this operation"
  />
  <Attribute
    name="error_count"
    type="integer"
    description="The number of the rows that errored in this operation"
  />
  <Attribute
    name="error_items"
    type="object[]"
    description="A list of items that errored in this operation, if available"
  />
  <Attribute
    name="status"
    type="enum"
    description="One of `queued`, `processing`, `completed`, `failed`"
  />
  <Attribute
    name="started_at"
    type="string"
    description="An ISO-8601 datetime string for when the operation started processing"
  />
  <Attribute
    name="completed_at"
    type="string"
    description="An ISO-8601 datetime string for when the operation completed processing"
  />
  <Attribute
    name="failed_at"
    type="string"
    description="An ISO-8601 datetime string for when the operation failed processing"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint
    method="GET"
    path="/bulk_operations/:id"
    name="bulk-operation-status"
    withLink
  />
</Endpoints>

```json title="BulkOperation object"
{
  "__typename": "BulkOperation",
  "completed_at": "2021-03-05T12:00:00Z",
  "error_count": 1,
  "error_items": [{ "id": "foo", "collection": "bar" }],
  "estimated_total_rows": 342,
  "failed_at": null,
  "id": "50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "inserted_at": "2021-03-05T12:00:00Z",
  "name": "some_operation",
  "processed_rows": 342,
  "progress_path": "/v1/bulk_operations/50d2847b-c738-466a-a3d7-e68e4bb1cedd",
  "started_at": "2021-03-05T12:00:00Z",
  "status": "completed",
  "success_count": 341,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Retrieve a bulk operation" slug="bulk-operation-status">
<ContentColumn>

Retrieve the bulk operation, revealing the current status and the number of rows processed. You can poll this endpoint
to understand when a bulk operation has finished executing (either completed, or failed).

### Endpoint

<Endpoint method="GET" path="/bulk_operations/:id" />

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="The ID of a bulk operation to retrieve"
  />
</Attributes>

### Returns

A `BulkOperation`

</ContentColumn>
</Section>

<Section title="Slack" slug="slack">
  <ContentColumn>
  These endpoints handle communication with the Slack API to streamline authentication and data gathering. They are used by [SlackKit](/in-app-ui/react/slack-kit) components and hooks.
  </ContentColumn>

  <ExampleColumn>
    <Endpoints>
      <Endpoint name="slack-auth-check" method="GET" path="/providers/slack/:channel_id/auth_check" withLink/>
      <Endpoint name="slack-channels" method="GET" path="/providers/slack/:channel_id/channels" withLink/>
      <Endpoint name="slack-revoke-access" method="PUT" path="/providers/slack/:channel_id/revoke_access" withLink/>
    </Endpoints>
  </ExampleColumn>
</Section>

<Section title="Slack auth check" slug="slack-auth-check">
  <ContentColumn>
  Get the status of Slack authentication.
  ### Endpoint

<Endpoint
  name="auth_check"
  method="GET"
  path="/providers/slack/:channel_id/auth_check"
/>

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute
    name="channel_id"
    type="string"
    description="The Knock Slack channel ID"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="access_token_object[object_id]"
    type="string"
    description="ID of the Object or Tenant."
  />
  <Attribute
    name="access_token_object[collection]"
    type="string"
    description="Collection of the Object or Tenant. If Tenant, should be `$tenants`."
  />
</Attributes>

### Returns

- `200` Connection data from the Slack API.
- `403` When no access token is set for the given object.

</ContentColumn>
<ExampleColumn>

```json
// Connection data success response

{
  "connection": {
    "ok": true,
    "url": "https://jurassicpark.slack.com/",
    "team": "Dino Workspace",
    "user": "alangrant",
    "team_id": "T12345678",
    "user_id": "W12345678"
  }
}
```

```json
// Connection data error response

{
  "connection": {
    "ok": false,
    "error": "invalid_auth"
  }
}
```

```json
// Missing access token error response

{
  "code": "authorization",
  "message": "Access token not set.",
  "status": 403,
  "type": "authentication_error"
}
```

</ExampleColumn>
</Section>

<Section title="Slack channels" slug="slack-channels">
<ContentColumn>
Get a list of the Slack channels for the access token stored in the given access token object.

### Endpoint

<Endpoint
  name="channels"
  method="GET"
  path="/providers/slack/:channel_id/channels"
/>

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute
    name="channel_id"
    type="string"
    description="The Knock Slack channel ID"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="access_token_object[object_id]"
    type="string"
    description="ID of the Object or Tenant."
  />
  <Attribute
    name="access_token_object[collection]"
    type="string"
    description="Collection of the Object or Tenant. If Tenant, should be `$tenants`."
  />
  <Attribute
    name="query_options[:option]"
    type="string"
    description="An optional query option passed to Slack. One of `cursor`, `exclude_archived`, `limit`, `team_id`, `types`.
    See Slack documentation for more information: https://api.slack.com/methods/conversations.list#arg_cursor"
    typeSlug="https://api.slack.com/methods/conversations.list#arg_cursor"
  />
</Attributes>

### Returns

- `200` List of partial data about the Slack channels requested.
- `403` When no access token is set for the given object.

</ContentColumn>
<ExampleColumn>

```json
// Success response

{
  "slack_channels": [
    {
      "name": "general",
      "id": "CMYK1234",
      "is_private": "false",
      "is_im": "false",
      "context_team_id": ""
    }
  ],
  "next_cursor": ""
}
```

```json
// Missing access token error response

{
  "code": "authorization",
  "message": "Access token not set.",
  "status": 403,
  "type": "authentication_error"
}
```

</ExampleColumn>
</Section>

<Section title="Slack revoke access" slug="slack-revoke-access">
<ContentColumn>
Revoke an access token from Slack and remove it from the access token object.

### Endpoint

<Endpoint
  name="channels"
  method="PUT"
  path="/providers/slack/:channel_id/revoke_access"
/>

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute
    name="channel_id"
    type="string"
    description="The Knock Slack channel ID"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="access_token_object[object_id]"
    type="string"
    description="ID of the Object or Tenant."
  />
  <Attribute
    name="access_token_object[collection]"
    type="string"
    description="Collection of the Object or Tenant. If Tenant, should be `$tenants`."
  />
</Attributes>

### Returns

- `200` Success response
- `403` When no access token is set for the given object.

</ContentColumn>
<ExampleColumn>

```json
// Success response

"ok"
```

```json
// Missing access token error response

{
  "code": "authorization",
  "message": "Access token not set.",
  "status": 403,
  "type": "authentication_error"
}
```

</ExampleColumn>
</Section>

<Section title="Microsoft Teams" slug="ms-teams">
  <ContentColumn>
  These endpoints handle communication with the Microsoft Graph API to streamline authentication and data gathering. They are used by [TeamsKit](/in-app-ui/react/teams-kit) components and hooks.
  </ContentColumn>

  <ExampleColumn>
    <Endpoints>
      <Endpoint name="ms-teams-auth-check" method="GET" path="/providers/ms-teams/:channel_id/auth_check" withLink/>
      <Endpoint name="ms-teams-teams" method="GET" path="/providers/ms-teams/:channel_id/teams" withLink/>
      <Endpoint name="ms-teams-channels" method="GET" path="/providers/ms-teams/:channel_id/channels" withLink/>
      <Endpoint name="ms-teams-revoke-access" method="PUT" path="/providers/ms-teams/:channel_id/revoke_access" withLink/>
    </Endpoints>
  </ExampleColumn>
</Section>

<Section title="Microsoft Teams auth check" slug="ms-teams-auth-check">
  <ContentColumn>
  Get the status of Microsoft Teams authentication.
  ### Endpoint

<Endpoint
  name="auth_check"
  method="GET"
  path="/providers/ms-teams/:channel_id/auth_check"
/>

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute
    name="channel_id"
    type="string"
    description="The Knock Microsoft Teams channel ID"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="ms_teams_tenant_object[object_id]"
    type="string"
    description="ID of the Object or Tenant."
  />
  <Attribute
    name="ms_teams_tenant_object[collection]"
    type="string"
    description="Collection of the Object or Tenant. If Tenant, should be `$tenants`."
  />
</Attributes>

### Returns

- `200` Success response
- `403` When no Microsoft Entra tenant ID is set for the given object.

</ContentColumn>
<ExampleColumn>

```json
// Connection data success response

{
  "connection": {
    "ok": true
  }
}
```

```json
// Connection data error response

{
  "connection": {
    "ok": false,
    "reason": "Knock Object containing Microsoft Teams tenant not found."
  }
}
```

```json
// Missing Microsoft Entra tenant ID error response

{
  "code": "authorization",
  "message": "Microsoft Teams tenant ID not set.",
  "status": 403,
  "type": "authentication_error"
}
```

</ExampleColumn>
</Section>

<Section title="Microsoft Teams teams" slug="ms-teams-teams">
<ContentColumn>
Get a list of teams belonging to the Microsoft Entra tenant.

### Endpoint

<Endpoint
  name="teams"
  method="GET"
  path="/providers/ms-teams/:channel_id/teams"
/>

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute
    name="channel_id"
    type="string"
    description="The Knock Microsoft Teams channel ID"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="ms_teams_tenant_object[object_id]"
    type="string"
    description="ID of the Object or Tenant."
  />
  <Attribute
    name="ms_teams_tenant_object[collection]"
    type="string"
    description="Collection of the Object or Tenant. If Tenant, should be `$tenants`."
  />
  <Attribute
    name="query_options[:option]"
    type="string"
    description={
      <>
        An optional query option passed to the Microsoft Graph API. One of{" "}
        <code>$filter</code>, <code>$select</code>, <code>$top</code>,{" "}
        <code>$skiptoken</code>. See the{" "}
        <a
          href="https://learn.microsoft.com/en-us/graph/api/teams-list#optional-query-parameters"
          target="_blank"
        >
          Microsoft Graph API documentation
        </a>{" "}
        for more information.
      </>
    }
  />
</Attributes>

### Returns

- `200` List of teams in the Microsoft Entra tenant.
- `403` When no Microsoft Entra tenant ID is set for the given object.

</ContentColumn>
<ExampleColumn>

```json
// Success response

{
  "ms_teams_teams": [
    {
      "id": "team-id-1",
      "displayName": "Engineering Team"
    }
  ],
  "skip_token": "token-for-next-page"
}
```

```json
// Missing Microsoft Entra tenant ID error response

{
  "code": "authorization",
  "message": "Microsoft Teams tenant ID not set.",
  "status": 403,
  "type": "authentication_error"
}
```

</ExampleColumn>
</Section>

<Section title="Microsoft Teams channels" slug="ms-teams-channels">
<ContentColumn>
Get a list of the Microsoft Teams channels within a team. By default, archived and private channels are excluded from the results.

### Endpoint

<Endpoint
  name="channels"
  method="GET"
  path="/providers/ms-teams/:channel_id/channels"
/>

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute
    name="channel_id"
    type="string"
    description="The Knock Microsoft Teams channel ID"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="ms_teams_tenant_object[object_id]"
    type="string"
    description="ID of the Object or Tenant."
  />
  <Attribute
    name="ms_teams_tenant_object[collection]"
    type="string"
    description="Collection of the Object or Tenant. If Tenant, should be `$tenants`."
  />
  <Attribute
    name="team_id"
    type="string"
    description="The ID of the Microsoft Teams team to list channels from."
  />
  <Attribute
    name="query_options[:option]"
    type="string"
    description={
      <>
        An optional query option passed to the Microsoft Graph API. One of{" "}
        <code>$filter</code>, <code>$select</code>. See the{" "}
        <a
          href="https://learn.microsoft.com/en-us/graph/api/channel-list#optional-query-parameters"
          target="_blank"
        >
          Microsoft Graph API documentation
        </a>{" "}
        for more information.
      </>
    }
  />
</Attributes>

### Returns

- `200` List of Microsoft Teams channels in the specified team.
- `403` When no Microsoft Entra tenant ID is set for the given object.

</ContentColumn>
<ExampleColumn>

```json
// Success response

{
  "ms_teams_channels": [
    {
      "id": "channel-id-1",
      "displayName": "General"
    }
  ]
}
```

```json
// Missing Microsoft Entra tenant ID error response

{
  "code": "authorization",
  "message": "Microsoft Teams tenant ID not set.",
  "status": 403,
  "type": "authentication_error"
}
```

</ExampleColumn>
</Section>

<Section title="Microsoft Teams revoke access" slug="ms-teams-revoke-access">
<ContentColumn>
Removes a Microsoft Entra tenant ID from the Microsoft Teams tenant object.

### Endpoint

<Endpoint
  name="channels"
  method="PUT"
  path="/providers/ms-teams/:channel_id/revoke_access"
/>

### Rate limit

<RateLimit tier={2} />

### Path parameters

<Attributes>
  <Attribute
    name="channel_id"
    type="string"
    description="The Knock Microsoft Teams channel ID"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="ms_teams_tenant_object[object_id]"
    type="string"
    description="ID of the Object or Tenant."
  />
  <Attribute
    name="ms_teams_tenant_object[collection]"
    type="string"
    description="Collection of the Object or Tenant. If Tenant, should be `$tenants`."
  />
</Attributes>

### Returns

- `200` Success response
- `403` When no Microsoft Entra tenant ID is set for the given object.

</ContentColumn>
<ExampleColumn>

```json
// Success response

"ok"
```

```json
// Missing Microsoft Entra tenant ID error response

{
  "code": "authorization",
  "message": "Microsoft Teams tenant ID not set.",
  "status": 403,
  "type": "authentication_error"
}
```

</ExampleColumn>
</Section>

<Section title="Audiences" slug="audiences">
  <ContentColumn>
    An [Audience](https://docs.knock.app/concepts/audiences) represents a user segment.

    Use the Audiences API to sync user segments from your data warehouse to Knock. Audiences can be used to target messages or orchestrate workflows via branch and step conditions.

  </ContentColumn>

  <ExampleColumn>
    <Endpoints>
      <Endpoint name="audiences-list" method="GET" path="/audiences/:audience_key/members" withLink/>
      <Endpoint name="audiences-add-members" method="POST" path="/audiences/:audience_key/members" withLink/>
      <Endpoint name="audiences-remove-members" method="DELETE" path="/audiences/:audience_key/members" withLink/>
    </Endpoints>
  </ExampleColumn>
</Section>

<Section title="List audience members" slug="audiences-list-members">
<ContentColumn>
List audience members.

### Endpoint

<Endpoint
  name="audiences-list-members"
  method="GET"
  path="/audiences/:audience_key/members"
/>

### Rate limit

<RateLimit tier={4} />

### Path parameters

<Attributes>
  <Attribute
    name="audience_key"
    type="string"
    description="The key of the audience to add the user to"
  />
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 25)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `page_info.after` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `page_info.before` field)"
  />
</Attributes>

### Returns

A paginated list of audience members records. The value of the `user` field is a [User](/api-reference/users) object. If no user is found for a given user ID, the value of the `user` field will be `null`.

</ContentColumn>
<ExampleColumn>

```json title="Response"
{
  "entries": [
    {
      "added_at": "2024-09-26T23:34:24.923224Z",
      "tenant": null,
      "user": {
        "__typename": "User",
        "created_at": null,
        "id": "a703abd7-7717-447b-bb85-dbd3fca64cff",
        "updated_at": "2024-09-26T23:32:27.214Z",
        "email": "user-1@example.com",
        "name": "User 1"
      },
      "user_id": "a703abd7-7717-447b-bb85-dbd3fca64cff",
      "__typename": "AudienceMember"
    },
    {
      "added_at": "2024-09-26T23:34:24.923224Z",
      "tenant": "tenant-1",
      "user": {
        "__typename": "User",
        "created_at": null,
        "id": "efab1fb5-1a28-446c-8042-ac0fc5d13d48",
        "updated_at": "2024-09-26T23:32:45.244Z",
        "email": "user-2@example.com",
        "name": "User 2"
      },
      "user_id": "efab1fb5-1a28-446c-8042-ac0fc5d13d48",
      "__typename": "AudienceMember"
    }
  ],
  "page_info": {
    "after": null,
    "before": null,
    "limit": 25,
    "total_count": 2
  }
}
```

</ExampleColumn>
</Section>

<Section title="Add audience members" slug="audiences-add-members">
<ContentColumn>

Adds members to an audience. The same user can be added to the audience multiple times with distinct tenant IDs.

### Endpoint

<Endpoint
  name="audiences-add-members"
  method="POST"
  path="/audiences/:audience_key/members"
/>

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="audience_key"
    type="string"
    description="The key of the audience to add members to"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="members"
    type="object[]"
    description="Members to add to the audience. The `tenant` field is optional. Max length is 1000."
  />
</Attributes>

### Returns

- `204` no content
- `404` if the audience cannot be found

</ContentColumn>
<ExampleColumn>

```json title="Request"
// Request (POST to /audiences/:audience_key/members)

{
  "members": [
    {
      "user": {
        "id": "a703abd7-7717-447b-bb85-dbd3fca64cff"
      }
    },
    {
      "user": {
        "id": "efab1fb5-1a28-446c-8042-ac0fc5d13d48"
      },
      "tenant": "tenant-1"
    }
  ]
}
```

</ExampleColumn>
</Section>

<Section title="Remove audience members" slug="audiences-remove-members">
<ContentColumn>
Removes members from an audience. If a member was added with a tenant ID, that tenant ID must also be provided for the member in the deletion request.

### Endpoint

<Endpoint
  name="audiences-remove-members"
  method="DELETE"
  path="/audiences/:audience_key/members"
/>

### Rate limit

<RateLimit tier={3} />

### Path parameters

<Attributes>
  <Attribute
    name="audience_key"
    type="string"
    description="The key of the audience to remove members from"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="members"
    type="object[]"
    description="Members to remove from the audience. The `tenant` field is optional. Max length is 1000."
  />
</Attributes>

### Returns

- `204` no content
- `404` if the audience cannot be found

</ContentColumn>
<ExampleColumn>

```json title="Request"
// Request (DELETE to /audiences/:audience_key/members)

{
  "members": [
    {
      "user": {
        "id": "a703abd7-7717-447b-bb85-dbd3fca64cff"
      }
    },
    {
      "user": {
        "id": "efab1fb5-1a28-446c-8042-ac0fc5d13d48"
      },
      "tenant": "tenant-1"
    }
  ]
}
```

</ExampleColumn>
</Section>
