---
title: How to integrate Hightouch with Knock
description: Learn how to power your Knock product notifications using synced data from your data warehouse using Hightouch.
section: Integrations > Sources
layout: integrations
---

## Getting started

Knock integrates with [Hightouch](https://hightouch.com) as a downstream destination to sync customer and event data from your data warehouse.

## Use cases

You can use our Hightouch integration to:

1. Sync customer data into Knock from your data warehouse (identify)
2. Trigger workflows from records added, changed, or removed in your data warehouse
3. Populate [Audiences](/concepts/audiences) with data from your data warehouse. Audiences can be used to trigger workflows or power conditional logic during workflow execution.

## Syncing customer data into Knock from Hightouch

You can use the [HTTP request destination](https://hightouch.com/docs/destinations/http-request) within Hightouch to sync your customer data from your data warehouse into Knock.

For this example, we're going to make a call to the [Knock API users identify endpoint](/api-reference/users/update).

<Callout
  emoji="üí°"
  title="Note:"
  text={
    <>
      you can also extend this technique to make other calls to the Knock API
      from your Hightouch models to sync object data or trigger workflows.
      Please{" "}
      <a href="mailto:support@knock.app?subject=Hightouch help">get in touch</a>{" "}
      if you'd like any additional help.
    </>
  }
/>

1. Create a new HTTP request destination and select your model to query from
2. Set an `Authorization` header, with the value set to `Bearer <your Knock secret API key>`. You can find your secret API key in [your dashboard](https://dashboard.knock.app) under **Platform** > **API keys**
3. Name your destination "Knock API"
4. Create a new sync with your Knock API destination
5. Select the types of events that should trigger, the most common case here is "Rows added"
6. Set the HTTP request method to `PUT` and the URL to `https://api.knock.app/v1/users/{{ row.user_id }}` where `{{ row.user_id }}` corresponds to the user identifier in the table
7. Select a "JSON" payload and "Use the JSON editor" to craft the request
8. Add at least a `name`, `email`, or `phone_number` field from your users table
9. For the rate limit, you can specify 60 requests per second
10. You'll likely want to "backfill" all of the available rows meaning that any existing data will also be synced to Knock
11. Click "Continue"
12. Select your sync frequency
13. Click "Finish"

An example configuration for your sync may look something like this:

```json title="Example sync configuration"
{
  "add": {
    "enabled": true,
    "method": "PUT",
    "url": "https://api.knock.app/v1/users/{{ row.user_id }}",
    "timeout": 30,
    "contentType": "application/json",
    "hasRateLimit": true,
    "bodyType": "template",
    "body": "{\n \"name\": \"{{ row.first_name }} {{ row.last_name }}\",\n \"email\": \"{{ row.email_address }}\",\n \"phone_number\": \"{{ row.phone_number }}\"\n}",
    "rateLimit": 60,
    "rateLimitTime": "second",
    "onError": "retryRequest",
    "retries": 3
  },
  "change": {},
  "remove": {},
  "skipFirstRun": false
}
```

## Syncing audiences into Knock from Hightouch

Hightouch models can be synced to Knock [audiences](/concepts/audiences) by configuring Knock as an Embedded Destination in Hightouch. This integration does not require any additional configuration in the Knock dashboard once the following steps are completed in Hightouch.

### Prerequisites

1. Determine which Knock environment you want to sync your audience to. You most likely want to sync in the Production environment, unless you‚Äôre configuring a test sync.
2. Create an audience in Knock that will serve as the target for your sync.
3. Have your Knock environment‚Äôs secret API key ready. Each environment has its own unique set of API keys; you can find your secret API key in your dashboard under **Platform** > **API keys**. Be sure that the correct environment is selected in the switcher at the top of the page.

### Configure Knock as a Hightouch Destination

Before you can sync audiences into Knock from Hightouch, you need to configure Knock as an Embedded Destination in Hightouch.

<Steps>
  <Step title="Add destination">
    Navigate to the **Integrations** > **Destinations** page in Hightouch‚Äôs
    sidebar, then click "Add destination."

    <Image
      src="/images/integrations/sources/hightouch/hightouch_audience_sync_1.png"
      width={1000}
      height={500}
      className="rounded-md mx-auto border border-gray-200"
      alt="Add destination"
    />

  </Step>
  <Step title='Select destination type'>
    Under "Developer tools," select "Embedded Destination" and then click "Continue."

    <Image
      src="/images/integrations/sources/hightouch/hightouch_audience_sync_2.png"
      width={1000}
      height={500}
      className="rounded-md mx-auto border border-gray-200"
      alt="Select Embedded Destination"
    />

  </Step>
  <Step title="Configure the destination URI">
    Copy and paste the following into the URI field: 
    ```txt title="Knock Embedded Destination URI"
    https://api.knock.app/v1/integrations/hightouch/embedded-destination
    ```
    <br/>
    
    Add the following under **Headers**. Be sure to toggle the "Secret" setting for the value:
    
    | Header | Value |
    | ------ | ----- |
    | `Authorization` | `Bearer <your Knock secret API key>` |
    
    <br/>

    Your completed URI configuration should look something like this:
    <Image
      src="/images/integrations/sources/hightouch/hightouch_audience_sync_3.png"
      width={1000}
      height={500}
      className="rounded-md mx-auto border border-gray-200"
      alt="Configure the destination URI"
    />

    <br/>

    Click "Continue."

    You'll be given the opportunity to configure alerts for this destination; if you don't need alerts, you can click "Continue" again.

  </Step>
  <Step title="Name your destination">
    Type in a name for your destination and click "Finish." 
    
    We recommend something like ‚ÄúKnock Production‚Äù so that its clear which environment the destination writes to.
  </Step>
</Steps>

### Add a sync to your Knock destination

Once you have configured Knock as an Embedded Destination in Hightouch, you can add a sync to your destination.

<Steps>
  <Step title="Add a sync">
    Navigate to **Activation** > **Syncs** in the Hightouch sidebar, then click "Add sync."

    <Image
      src="/images/integrations/sources/hightouch/hightouch_audience_sync_4.png"
      width={1000}
      height={500}
      className="rounded-md mx-auto border border-gray-200"
      alt="Add a sync"
    />

  </Step>
  <Step title="Select your source data">
    You'll be prompted to select a model for your source data. Select the model for the audience that you want to sync to Knock.
  </Step>
  <Step title="Select a destination">
    Next, you'll select the Knock Embedded Destination that you created above.

    <Image
      src="/images/integrations/sources/hightouch/hightouch_audience_sync_5.png"
      width={1000}
      height={500}
      className="rounded-md mx-auto border border-gray-200"
      alt="Select a destination"
    />

  </Step>
  <Step title="Configure your sync">
    Select ‚ÄúAudiences‚Äù in the ‚ÄúWhich object would you like to sync data to?‚Äù dropdown.

    <Image
      src="/images/integrations/sources/hightouch/hightouch_audience_sync_6.png"
      width={1000}
      height={500}
      className="rounded-md mx-auto border border-gray-200"
      alt="Configure your sync"
    />

    <br/>

    Then, select a mode for the sync:

    - **Insert only:** Only new rows added to your model will be synced to Knock. Removing rows from your model will have no effect on your Knock audience.
    - **Mirror:** New rows in your model will be added to your audience and removed rows in your model will be deleted from your audience.

    <Callout
    emoji="üí°"
    title="Note:"
    text={
      <>
        Knock‚Äôs Embedded Destination only applies add and remove operations. It does not support update operations.
      </>
    }
    />

  </Step>
  <Step title="Configure your data mapping">
    Map your model‚Äôs fields to the audience fields. 
    
    You must map a model field to the audience "User ID" field. This field should correspond to the ID of the user in Knock. 
    
    If you‚Äôd also like to map a `tenant` field, click "Add mapping" and select the appropriate field from your model.

    <Image
      src="/images/integrations/sources/hightouch/hightouch_audience_sync_7.png"
      width={1000}
      height={500}
      className="rounded-md mx-auto border border-gray-200"
      alt="Configure your data mapping"
    />

  </Step>
  <Step title="Add the audience key">
    Next, add the key of the Knock audience that you want to sync to. Click "Continue."

    <Image
      src="/images/integrations/sources/hightouch/hightouch_audience_sync_8.png"
      width={1000}
      height={500}
      className="rounded-md mx-auto border border-gray-200"
      alt="Add the audience key"
    />

  </Step>
  <Step title="Finalize your sync">
    Finally, you'll set your sync to run manually, on a schedule, or with an automation.

    You can now click "Finish" to add the sync and run it whenever you‚Äôd like.  Refer to <a href="https://hightouch.com/docs/syncs/overview" target="_blank" rel="noopener noreferrer">Hightouch‚Äôs documentation</a> for more information on syncs.

    <Callout
    emoji="‚ö†Ô∏è"
    bgColor="red"
    title="Note:"
    text={
      <>
        If you want to trigger any Knock workflows based on <a href="/send-notifications/triggering-workflows/audiences">audience entry</a>, ensure that the workflows are configured, committed, and promoted to the relevant environment before starting the Hightouch sync.
      </>
    }
    />

    You can verify that the sync is behaving as expected by:

    - Comparing total user counts in your model and the audience in your Knock dashboard.
    - Viewing the audience user list.
    - Viewing workflow run logs for the audience (if you have workflow audience triggers configured).

  </Step>
</Steps>
