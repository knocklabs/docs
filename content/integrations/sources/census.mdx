---
title: How to integrate Census with Knock
description: Learn how to power your Knock product notifications using synced data from your data warehouse using Census.
section: Integrations > Sources
layout: integrations
---

## Getting started

Knock can be integrated as a downstream destination in <a href="https://getcensus.com" target="_blank">Census</a> to sync customer and event data from your data warehouse.

### Use cases

You can use our Census integration to:

1. Sync customer data into Knock from your data warehouse ([identify recipients](/managing-recipients/identifying-recipients)).
2. [Trigger workflows](/send-notifications/triggering-workflows/overview) from records added, changed, or removed in your data warehouse.
3. Populate [audiences](/concepts/audiences) with data from your data warehouse. Audiences can be used to trigger workflows or power conditional logic during workflow execution.

## Configure Knock as a destination in Census

Before you can sync data into Knock from Census, you need to configure Knock as a destination.

<Callout
  type="info"
  title="Note:"
  text={
    <>
      Our Census integration only requires configuration within Census. Once
      you've completed the setup steps below, you will not need to take any
      additional steps in the Knock dashboard.
    </>
  }
/>

### Prerequisites

1. Determine which Knock environment you want to sync your Census data to. You most likely want to sync in the Production environment, unless you’re configuring a test sync.
2. Have your Knock environment’s secret API key ready. Each environment has its own unique set of API keys; you can find your secret API key in your dashboard under **Platform** > **API keys**. Be sure that the correct environment is selected in the switcher at the top of the page.
3. Choose your destination type. Your options are:

- **Custom destination** - Our recommended destination type for syncing audiences into Knock from Census. Setup is simpler and includes automatic support for removing a user from an audience during your syncs without additional configuration.
- **HTTP Request destination** - This destination type is required if you need to [sync users and their properties to Knock](#syncing-customer-data-into-knock-from-census) or if you need to include [tenant](/concepts/tenants) data in your Knock audience.

### Configuration instructions

<AccordionGroup>
  <Accordion title="Custom destination" description="Our recommended configuration for syncing audiences into Knock from Census.">
    <Steps>
      <Step title="Add destination">
        Navigate to the **Destinations** tab in Census and click "Add a Destination."
        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_destination_1.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Add a new destination in Census"
        />
      </Step>
      <Step title="Select destination type">
        Select "Custom Destination API."
        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_destination_2.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select Custom Destination API as the destination type in the UI"
        />
      </Step>
      <Step title="Configure the destination">
        **a.** Input a destination name. We recommend something like **Knock Production** that correlates to the Knock environment that you're syncing to.
        
        **b.** Copy and paste the following into the API URL field: 
        ```txt title="Knock Custom Destination API URL"
        https://api.knock.app/v1/integrations/census/custom-destination
        ```
        <br/>
        **c.** Click the "+ Add Header" button to add an `Authorization` <a href="/api-reference/overview/authentication">header</a>. Be sure to toggle the "Secret" setting for the value:

        | Header | Value |
        | ------ | ----- |
        | `Authorization` | `Bearer <your Knock secret API key>` |
        <br/>

        **d.** Leave “1” selected as the API Version, then click "Connect" to complete the configuration.

        Census will now test connectivity with Knock. This process may take a few moments to complete.

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_destination_3.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Configure the destination"
        />
      </Step>
    </Steps>

  </Accordion>
  <Accordion title="HTTP Request destination" description="Our recommended configuration if you need to sync user properties or include tenant data in your Knock audience.">
    <Steps>
      <Step title="Add destination">
        Navigate to the **Destinations** tab in Census and click "Add a Destination."
        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_destination_1.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Add a new destination in Census"
        />
      </Step>
      <Step title="Select destination type">
        Select "HTTP Request."
        <Image
          src="/images/integrations/sources/census/http-destination/census_http_destination_1.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select HTTP Request as the destination type in the UI"
        />
      </Step>
      <Step title="Configure the destination">
        **a.** Input a destination name. We recommend something like **Knock Production HTTP API** that correlates to the Knock environment that you're syncing to.
        
        **b.** Leave the Authorization Type set to "Manual."
        
        **c.** Copy and paste the following into the Base URL field: 
        ```txt title="Knock API Base URL"
        https://api.knock.app/v1
        ```
        <br/>
        **d.** Click the "+ Add Header" button to add an `Authorization` <a href="/api-reference/overview/authentication">header</a>. Be sure to toggle the "Secret" setting for the value:
        
        | Header | Value |
        | ------ | ----- |
        | `Authorization` | `Bearer <your Knock secret API key>` |
        <br/>
        **e.** Click "Connect" to complete the configuration.
        
        <Image
          src="/images/integrations/sources/census/http-destination/census_http_destination_2.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Configure the destination"
        />
      </Step>
    </Steps>
  </Accordion>
</AccordionGroup>

## Syncing audiences into Knock from Census

Census Sources and Datasets can be synced to Knock audiences by configuring Knock as a custom destination or using an HTTP request destination connected to Knock’s audiences API.

<Callout
  type="warning"
  title="Note:"
  text={
    <>
      This integration will only sync a user's audience membership to Knock. To
      sync user properties into Knock, see the section below on{" "}
      <a href="#syncing-customer-data-into-knock-from-census">
        syncing customer data into Knock from Census
      </a>
      .
    </>
  }
/>

### Prerequisites

1. Complete the steps to [configure Knock as a destination in Census](#configure-knock-as-a-destination-in-census).
2. Create, save, and commit a [static audience](/concepts/audiences#audience-types) in Knock that will serve as the target for your sync. Be sure that you create your audience in the same environment that you used to configure your Knock destination.
3. Ensure that any Knock workflows that should be [triggered by a user's audience entry](/send-notifications/triggering-workflows/audiences) are configured, committed, and promoted to your Knock environment before finalizing your Census sync.

### Add an audience sync to your Knock destination

Follow the steps below to add an audience sync to your configured Knock destination in Census.

<AccordionGroup>
  <Accordion title="Custom destination">
    <Steps>
      <Step title="Create a new sync">
        Navigate to the **Syncs** tab in Census and click "Create a sync."

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_1.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Create a new sync in Census"
        />
      </Step>
      <Step title="Select your source data">
        You'll be prompted to select a dataset for your source data. Select the dataset that you want to sync to Knock.

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_2.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select your source data in Census"
        />
      </Step>
      <Step title="Select a destination">
        Next, you'll select the Knock custom destination that you created above. The "Audiences" object should be selected by default.

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_3.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select a destination in Census"
        />
      </Step>
      <Step title="Select a sync behavior">
        Select the sync behavior that you want to use.

        - **Create only:** New rows added to your model will be synced to Knock. Removing rows from your model will have no effect on your Knock audience.
        - **Mirror:** New rows added to your model will be added to your audience and removed rows in your model will be deleted from your audience.

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_4.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select a sync behavior in Census"
        />
      </Step>
      <Step title="Select a sync key">
        Select a sync key from your source to map to the Knock audience User ID field. This field's value must be unique; if Census detects multiple rows with the same sync key value, it marks them as duplicates and does not sync them.

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_5.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select a sync key for your user ID mapping"
        />
      </Step>
      <Step title="Add the audience key">
        Under "Set Up Custom Destination API Field Mappings," you'll add the key of the Knock audience that you want to sync to.

        **a.** Click the "Source value..." dropdown.

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_6.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select the source value input for your audience key"
        />
        <br/>
        **b.** Click "Constant Value" on the left-hand side, then enter the key of your Knock audience in the input field.

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_7.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Add the audience key to your sync"
        />
        <br/>
        **c.** Click "Save."
      </Step>
      <Step title="Test your sync (optional)">
        We recommend clicking "Run test" to test your sync. If successful, this will sync one row of data to your Knock audience, which you can confirm in the Knock dashboard. Any errors with your source data or field mappings will be displayed in the test results.

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_8.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Test your sync"
        />
      </Step>
      <Step title="Finalize your sync">
        Click "Next." You'll be prompted to provide an optional label and select the trigger type for your sync.

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_9.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Finalize your sync configuration"
        />
        <br/>
        Click "Create" to complete the sync creation process.
      </Step>
    </Steps>

  </Accordion>
  <Accordion title="HTTP request destination">
    <Steps>
      <Step title="Create a new sync for adding users to an audience">
        Navigate to the **Syncs** tab in Census and click "Create a sync."

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_1.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Create a new sync in Census"
        />
      </Step>
      <Step title="Select your source data">
        You'll be prompted to select a dataset for your source data. Select the dataset that you want to sync to Knock.

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_2.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select your source data in Census"
        />
      </Step>
      <Step title="Select a destination">
        Next, you'll select the Knock HTTP request destination that you created above.

        Enter the following into the request endpoint input, replacing `<audience-key>` with the key of your destination audience. For example, if your audience key is `new-signups`, you’d enter `/audiences/new-signups/members`.
        ```txt title="Knock API audience members endpoint"
        /audiences/<audience-key>/members
        ```
        <br/>

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_1.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select a destination in Census"
        />
      </Step>
      <Step title="Select the request trigger type">
        Select "Records added" as the trigger type.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_2.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Set the request trigger type to 'Records added'"
        />
      </Step>
      <Step title="Specify the number of records in each request">
        Select "Multiple records per request" to sync audience members in batches. Set the number of rows per batch to 500.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_3.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select the request body in Census"
        />
      </Step>
      <Step title="Select a sync key">
        Select a sync key from your source to map to the Knock audience User ID field. This field's value must be unique; if Census detects multiple rows with the same sync key value, it marks them as duplicates and does not sync them.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_4.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select a sync key for your user ID mapping"
        />
      </Step>
      <Step title="Choose a request method and payload type">
        Select `POST` as the request method.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_5.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select the POST request method"
        />
        <br/>
        Then, select "JSON" as the payload type and "Template editor" as the customization option.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_6.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select the JSON payload type with template editor option"
        />

      </Step>
      <Step title="Configure the request body template">
        Modify the following template, replacing `source_user_id` and `source_tenant_id` with the names of columns from your data source that map to the Knock user ID and the Knock tenant ID. Then paste it into the JSON payload form.

        Note that column names are case-sensitive.

        ```json title="Request body template"
        {
            "members": [
                {% for record in records %}
                    {
                        "user": { "id": "{{ record['source_user_id']}}" },
                        "tenant": "{{ record['source_tenant_id'] }}"
                    }
                {% endfor %}
            ]
        }
        ```
        <br/>
        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_7.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Edit the request body template"
        />
      </Step>
      <Step title="Configure a rate limit for the sync">
        The rate limit for “Add member” API requests to Knock is 60 requests per second. We recommend choosing a lower number (such as 10 requests per second) to allow for multiple syncs to run at once.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_8.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Configure a rate limit for the sync"
        />
      </Step>
      <Step title="Choose whether to backfill existing records">
        Select "Backfill All Records" to sync all existing records in your source data to your Knock audience, or "Skip Current Records" to only sync new records going forward.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_9.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Choose whether to backfill existing records"
        />
      </Step>
      <Step title="Test your sync (optional)">
        We recommend clicking "Run test" to test your sync. If successful, this will sync one row of data to your Knock audience, which you can confirm in the Knock dashboard. Any errors with your source data or field mappings will be displayed in the test results.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_10.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Test your sync"
        />
      </Step>
      <Step title="Finalize your sync">
        Click "Next." You'll be prompted to provide an optional label and select the trigger type for your sync.

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_9.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Finalize your sync configuration"
        />
        <br/>
        Click "Create" to complete the sync creation process.

        If you want your audience sync to run in “insert only” mode, you’re all set! If you’d like to also remove audience members when rows are deleted from your data source, proceed to the next step.
      </Step>
      <Step title="Create an optional sync for removing audience members">
        Repeat steps 1. and 2. above, using the same source data and your Knock HTTP request destination.

        When you get to step 3., paste the following into the request endpoint, with replacements:

        - `audience_key` should be the same audience key used in the previous section.
        - `source_user_id` should be the name of the column that stores Knock user IDs.
        - `source_tenant_id` should be the name of the column that stores Knock tenant IDs.

        ```txt title="Knock API audience members endpoint"
        /audiences/<audience_key>/members?members=[{"user": {"id": "{{ record['source_user_id'] }}"}, "tenant": "{{ record['source_tenant_id'] }}"}]
        ```
      </Step>
      <Step title="Configure the request">
        **a.** Select "Records removed" as the trigger type.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_11.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select the request trigger type"
        />
        <br/>
        **b.** Select "One record per request" to remove audience members one at a time.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_12.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select the request trigger type"
        />
        <br/>
        **c.** Select the same sync key as the one that you used in your "Add member" sync.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_4.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select the sync key"
        />
        <br/>
        **d.** Select `DELETE` as the request method. The payload type will be "empty" for this request method.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_13.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Select the DELETE request method"
        />
        <br/>
        **e.** Configure a rate limit for the sync. The same 60 requests per second rate limit as your "add member" sync applies to this endpoint, and we recommend a similar setting to allow for multiple syncs to run at once.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_8.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Configure a rate limit for the sync"
        />
      </Step>
      <Step title="Test and finalize your sync">
        As above, we recommend clicking "Run test" to test your sync. If successful, this will remove one row of data from your Knock audience, which you can confirm in the Knock dashboard. Any errors with your source data or field mappings will be displayed in the test results.

        <Image
          src="/images/integrations/sources/census/http-destination/census_http_audience_sync_10.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Test your sync"
        />
        <br/>
        Click "Next." You'll be prompted to provide an optional label and select the trigger type for your sync.

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_9.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Finalize your sync configuration"
        />
        <br/>
        Click "Create" to complete the sync creation process. Your setup is now complete!
      </Step>
    </Steps>

  </Accordion>
</AccordionGroup>

## Syncing customer data into Knock from Census

Census user records can be synced to Knock by configuring an HTTP request destination connected to Knock’s users API.

### Prerequisites

1. Complete the steps to [configure Knock as a destination in Census](#configure-knock-as-a-destination-in-census). You'll need to configure an HTTP Request destination.

### Add a user sync to your Knock destination

Follow the steps below to add a user data sync to your configured Knock HTTP request destination in Census.

<Steps>
      <Step title="Create a new sync">
        Navigate to the **Syncs** tab in Census and click "Create a sync."

        <Image
          src="/images/integrations/sources/census/custom-destination/census_custom_audience_sync_1.png"
          width={1000}
          height={500}
          className="rounded-md mx-auto border border-gray-200"
          alt="Create a new sync in Census"
        />
      </Step>

</Steps>
