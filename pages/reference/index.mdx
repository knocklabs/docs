---
title: API reference
showNav: false
layout: api
---

import { Attributes, Attribute } from "../../components/Attributes";
import { Endpoints, Endpoint } from "../../components/Endpoints";
import {
  Section,
  ContentColumn,
  ErrorExample,
  ExampleColumn,
} from "../../components/ApiSections";
import MultiLangCodeBlock from "../../components/MultiLangCodeBlock";

<!-- Let #overview anchor tag to go to the top of the page -->

<a id="overview" className="absolute -top-8 invisible" />

<Section title="API Reference" slug="overview">
<ContentColumn>
The Knock API enables you to add a complete notification engine to your product. This API provides
programmatic access to integrating Knock via a REST-ful API.

</ContentColumn>
<ExampleColumn>

```bash Base URL
https://api.knock.app/v1
```

</ExampleColumn>

</Section>

<Section title="Client libraries" slug="client-libraries">
<ContentColumn>

Knock offers native SDKs in several popular programming languages:

- [Node JS](https://github.com/knocklabs/knock-node)
- [Python](https://github.com/knocklabs/knock-python)
- [Ruby](https://github.com/knocklabs/knock-ruby)
- [C# (dot net)](https://github.com/knocklabs/knock-dot-net)
- [Elixir](https://github.com/knocklabs/knock-elixir)

</ContentColumn>
</Section>

<Section title="API keys" slug="api-keys">
<ContentColumn>

Knock authenticates your API requests using your account's API keys. API requests made without authentication or using an incorrect key will return a 401 error. Requests using a valid key but with insufficient permissions will return a 403 error.

You can view and manage your API keys in the Developer Dashboard. There are two types of API keys:

- Publishable keys are only meant to identify your account with Knock. They aren't secret, and can safely be made public in any of your client-side code. Publishable keys are prefixed with `pk_*`.

- Secret keys can perform any API request to Knock, they should be kept secure and private! Be sure to prevent secret keys from being made publicly accessible, such as in client-side code, GitHub, unsecured S3 buckets, and so forth. Secret keys are prefixed with `sk_*`.

Each Environment in your account has both a publishable and secret key pair. API requests will be scoped to the provided key's Environment.

</ContentColumn>
</Section>

<Section title="Authentication" slug="authentication">
<ContentColumn>

You must pass your API key to Knock as a Bearer token using the following header:

```bash Authentication header
Authorization: Bearer sk_test_12345
```

</ContentColumn>
</Section>

<Section title="Errors" slug="errors" direction="column">
<ContentColumn>

Knock uses standard [HTTP response codes](https://developer.mozilla.org/en-US/Web/HTTP/Status) to indicate the success or failure of your API requests.

- `2xx` success status codes confirm that your request worked as expected.

- `4xx` error status codes indicate an error caused by incorrect or missing request information (e.g. providing an incorrect API key).

- `5xx` error status codes indicate a Knock server error.

</ContentColumn>
</Section>

<Section title="Error codes" slug="error-codes" direction="column">
<div className="w-full">

<p className="mb-6 prose-sm lg:prose">
  Here's a list of common{" "}
  <span className="bg-code-background text-code rounded text-sm font-normal py-0.75 px-1.5 font-mono inline-block border-1 border-gray-200">
    400
  </span>{" "}
  error codes you may encounter while working with the Knock API. We also
  provide additional context on how to resolve them.
</p>

<ErrorExample
  title="actor_missing"
  description="You called a workflow with an actor that has not yet been identified in Knock. To resolve, identify the actor prior to passing their ID in a workflow trigger."
/>

<ErrorExample
  title="api_key_expired"
  description="Your API key has expired. You can regenerate one on the developers page of the Knock dashboard."
/>

<ErrorExample
  title="api_key_missing"
  description="The API key you provided is invalid."
/>

<ErrorExample
  title="authentication_required"
  description="This endpoint requires authentication. Check the Authentication section of this API reference for more information."
/>

<ErrorExample
  title="channel_invalid"
  description="The channel you supplied in this request is invalid."
/>

<ErrorExample
  title="incorrect_token_type"
  description="You cannot call this endpoint with this token."
/>

<ErrorExample
  title="invalid_params"
  description="The parameters supplied in your request were invalid. Check the payload you're sending to Knock to make sure it's valid."
/>

<ErrorExample
  title="invalid_user_token"
  description="The user token supplied is invalid."
/>

<ErrorExample
  title="missing_jwt_signing_key"
  description={
    <p>
      <span>
        Your request needs a JWT signing key. You can learn more about JWT
        signing keys in our{" "}
      </span>
      <a
        href="/client-integration/authenticating-users"
        className="text-brand underline"
      >
        client authentication docs.
      </a>
    </p>
  }
/>

<ErrorExample
  title="missing_user_token"
  description={
    <p>
      This environment requires that you supply a `X-Knock-User-Token` header
      when using a public API key. You can learn more in our{" "}
      <a
        href="/client-integration/authenticating-users"
        className="text-brand underline"
      >
        client authentication docs.
      </a>
    </p>
  }
/>

<ErrorExample
  title="workflow_inactive"
  description="The workflow you attempted to invoke is marked as inactive. To resolve this error, activate the workflow on its page in the dashboard."
/>

<ErrorExample
  title="workflow_missing"
  description="The workflow you attemped to invoke could not be found. To resolve this error, confirm that you're calling the correct environment and that your workflow has been committed to it."
/>

</div>
</Section>

<Section title="Users" slug="users">
<ContentColumn>

A user represents an individual who may need to receive a notification from Knock. They are always referenced by your internal identifier.

### Attributes

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="Unique identifier for the user"
  />
  <Attribute name="name" type="string" description="The full name of the user" />
  <Attribute name="email" type="string" description="The email of the user" />
  <Attribute name="avatar" type="string (optional)" description="A URL for the avatar of the user" />
  <Attribute name="phone_number" type="string (optional)" description="The phone number of the user to use with SMS channels" />
  <Attribute
    name="*"
    type="key-value pairs"
    description="Any custom properties"
  />
</Attributes>
</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint name="identify-user" method="PUT" path="/users/:user_id" />
  <Endpoint name="get-user" method="GET" path="/users/:user_id" />
  <Endpoint name="delete-user" method="DELETE" path="/users/:user_id" />
  <Endpoint name="merge-user" method="POST" path="/users/:user_id/merge" />
  <Endpoint
    name="bulk-identify-users"
    method="POST"
    path="/users/bulk/identify"
  />
  <Endpoint name="bulk-delete-users" method="POST" path="/users/bulk/delete" />
</Endpoints>

```json User object
{
  "__typename": "User",
  "id": "user_1",
  "name": "User name",
  "email": "user@example.com",
  "foo": "bar",
  "baz": true,
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Identify a user" slug="identify-user">
<ContentColumn>

Identifying a user will create or update a user in Knock, merging the properties given with what we currently have set on the user (if any).

### Endpoint

<Endpoint method="PUT" path="/users/:user_id" />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="Unique identifier of the user"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute name="name" type="string" description="The name of the user" />
  <Attribute name="email" type="string" description="The email of the user" />
  <Attribute
    name="avatar"
    type="string (optional)"
    description="A URL for the avatar of the user"
  />
  <Attribute
    name="phone_number"
    type="string (optional)"
    description="The phone number of the user to use with SMS channels"
  />
  <Attribute
    name="*"
    type="key-value pairs"
    description="Any custom properties"
  />
</Attributes>

### Returns

A User.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="users.identify" title="Identify a user" />

```json Response
{
  "__typename": "User",
  "id": "user_1",
  "name": "User name",
  "email": "user@example.com",
  "foo": "bar",
  "baz": true,
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Get a user" slug="get-user">
<ContentColumn>

Retrieve a user by their ID, including all properties previously set.

### Endpoint

<Endpoint method="GET" path="/users/:user_id" />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="Unique identifier of the user"
  />
</Attributes>

### Returns

A User.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="users.get" title="Get a user" />

```json Response
{
  "__typename": "User",
  "id": "user_1",
  "name": "User name",
  "email": "user@example.com",
  "foo": "bar",
  "baz": true,
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Delete a user" slug="delete-user">
<ContentColumn>

Deletes a user by the id given.

### Endpoint

<Endpoint method="DELETE" path="/users/:user_id" />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="Unique identifier of the user"
  />
</Attributes>

### Returns

No response.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="users.delete" title="Delete a user" />

</ExampleColumn>
</Section>

<Section title="Merge users" slug="merge-user">
<ContentColumn>

Merges the two users together, merging the user specified in the `from_user_id` into the `user_id`.

[Read more on how merging works →](/send-and-manage-data/users#merging-users)

### Endpoint

<Endpoint method="POST" path="/users/:user_id/merge" />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="Unique identifier of the user to merge into"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="from_user_id"
    type="string"
    description="Unique identifier of the user to merge from"
  />
</Attributes>

### Returns

The merged `User`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="users.merge" title="Merge a user" />

```json Response
{
  "__typename": "User",
  "id": "user_1",
  "name": "User name",
  "email": "user@example.com",
  "foo": "bar",
  "baz": true,
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Bulk identify users" slug="bulk-identify-users">
<ContentColumn>

Identifies up to 100 users at a time. Returns a `BulkOperation` that executes the job asynchronously. Progress can be tracked via the BulkOperation API.

### Endpoint

<Endpoint method="POST" path="/users/bulk/identify" />

### Body parameters

<Attributes>
  <Attribute
    name="users"
    type="User[]"
    description="A list of users to upsert (up to 100)"
  />
</Attributes>

### Returns

A BulkOperation.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.bulkIdentify"
  title="Bulk identifies users"
/>

```json Response
{
  "__typename": "BulkOperation",
  "completed_at": nil,
  "estimated_total_rows": 42,
  "failed_at": nil,
  "id": "b4f6f61e-3634-4e80-af0d-9c83e9acc6f3",
  "name": "bulk_op",
  "processed_rows": 0,
  "progress_path": "/v1/bulk_operations/b4f6f61e-3634-4e80-af0d-9c83e9acc6f3",
  "started_at": nil,
  "status": "queued",
  "inserted_at": "2021-03-05T12:00:00Z",
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Bulk delete users" slug="bulk-delete-users">
<ContentColumn>

Deletes up to 100 users at a time. Returns a `BulkOperation` that executes the job asynchronously. Progress can be tracked via the BulkOperation API.

### Endpoint

<Endpoint method="POST" path="/users/bulk/delete" />

### Body parameters

<Attributes>
  <Attribute
    name="user_ids"
    type="string[]"
    description="Unique identifiers of the users to delete"
  />
</Attributes>

### Returns

A BulkOperation.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="users.bulkDelete" title="Bulk deletes users" />

```json Response
{
  "__typename": "BulkOperation",
  "completed_at": nil,
  "estimated_total_rows": 42,
  "failed_at": nil,
  "id": "b4f6f61e-3634-4e80-af0d-9c83e9acc6f3",
  "name": "bulk_op",
  "processed_rows": 0,
  "progress_path": "/v1/bulk_operations/b4f6f61e-3634-4e80-af0d-9c83e9acc6f3",
  "started_at": nil,
  "status": "queued",
  "inserted_at": "2021-03-05T12:00:00Z",
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Workflows" slug="workflows">
<ContentColumn>

A Workflow orchestrates the delivery of messages to your end users. When you configure a workflow you'll determine which channels its messages should route to, what those messages should look like on each channel, as well as any functions—batch, throttle, digest—you want applied to the messages prior to delivery. A workflow is triggered by a `notify` call, usually when something occurs in your product that you want your users to know about (e.g. a new comment.)

</ContentColumn>
<ExampleColumn>
<Endpoints>
  <Endpoint
    name="trigger-workflow"
    method="POST"
    path="/workflows/:key/trigger"
  />
  <Endpoint
    name="cancel-workflow"
    method="POST"
    path="/workflows/:key/cancel"
  />
</Endpoints>

</ExampleColumn>
</Section>

<Section title="Triggering a workflow (notify)" slug="trigger-workflow">
<ContentColumn>

A notify calls a workflow created via the Knock dashboard.

### Endpoint

<Endpoint method="POST" path="/workflows/:key/trigger" />

### Path parameters

<Attributes>
  <Attribute
    name="key"
    type="string"
    description="The key of the workflow to call"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="recipients"
    type="RecipientIdentifier[]"
    description="A list of user ids or object references to notify for this workflow"
  />
  <Attribute
    name="actor"
    type="RecipientIdentifier (optional)"
    description="An identifier of who or what performed this action"
  />
  <Attribute
    name="cancellation_key"
    type="string (optional)"
    description="The key to use for canceling the workflow"
  />
  <Attribute
    name="tenant"
    type="string (optional)"
    description="The id of the tenant that this workflow run should be associated with"
  />
  <Attribute
    name="data"
    type="dictionary"
    description="A set of key value pairs to pass to the notify"
  />
</Attributes>

### Returns

<Attributes>
  <Attribute
    name="workflow_run_id"
    type="string"
    description="A unique UUID of this workflow run"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="workflows.trigger" title="Trigger a workflow" />

```json Response
{
  "workflow_run_id": "some-result-id"
}
```

</ExampleColumn>
</Section>

<Section title="Canceling workflows" slug="cancel-workflow">
<ContentColumn>

Cancel a delayed workflow for one or more recipients.

### Endpoint

<Endpoint method="POST" path="/workflows/:key/cancel" />

### Path parameters

<Attributes>
  <Attribute name="key" type="string" description="The key of the workflow" />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="cancellation_key"
    type="string"
    description="The cancellation key unique to the notify"
  />
  <Attribute
    name="recipients"
    type="RecipientIdentifier[]"
    description="An optional list of user ids or object references to cancel the workflow for"
  />
</Attributes>

### Returns

`204`, with empty content.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="workflows.cancel" title="Cancel a workflow" />

</ExampleColumn>
</Section>

<Section title="Preferences" slug="preferences">
<ContentColumn>

A preference determines whether a user should receive a particular type of notification. By default
all preferences are opted in unless a preference explicitly opts the user out of the notification.

Preferences are always executed as channel types and then workflows. That means that if a channel type
is set to opt out the user then no notifications will be sent on that channel.

### Attributes

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="Unique identifier for the preference set"
  />
  <Attribute
    name="workflows"
    type="object"
    description="A set of preferences for workflows, each can resolve to a boolean or to a set of channel types"
  />
  <Attribute
    name="channel_types"
    type="object"
    description="A set of preferences for channel types"
  />
  <Attribute
    name="categories"
    type="object"
    description="A set of preferences for workflow categories, each can resolve to a boolean or to a set of channel types"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint name="get-all" method="GET" path="/users/:user_id/preferences" />
  <Endpoint
    name="get-preferences"
    method="GET"
    path="/users/:user_id/preferences/:id"
  />
  <Endpoint
    name="set-preferences"
    method="PUT"
    path="/users/:user_id/preferences/:id"
  />
  <Endpoint
    name="bulk-set-preferences"
    method="POST"
    path="/users/bulk/preferences"
  />
  <Endpoint
    name="set-channel-type-preferences"
    method="PUT"
    path="/users/:user_id/preferences/:id/channel_types"
  />
  <Endpoint
    name="set-channel-type-preference"
    method="PUT"
    path="/users/:user_id/preferences/:id/channel_types/:type"
  />
  <Endpoint
    name="set-workflow-preferences"
    method="PUT"
    path="/users/:user_id/preferences/:id/workflows"
  />
  <Endpoint
    name="set-workflow-preference"
    method="PUT"
    path="/users/:user_id/preferences/:id/workflows/:key"
  />
  <Endpoint
    name="set-category-preferences"
    method="PUT"
    path="/users/:user_id/preferences/:id/categories"
  />
  <Endpoint
    name="set-category-preference"
    method="PUT"
    path="/users/:user_id/preferences/:id/categories/:key"
  />
</Endpoints>

```json Preference object
{
  "__typename": "PreferenceSet",
  "id": "default",
  "workflows": {
    "dinosaurs-loose": {
      "channel_types": {
        "email": true
      }
    }
  },
  "channel_types": {
    "in_app_feed": true,
    "sms": false
  },
  "categories": {
    "park-wide": {
      "channel_types": {
        "sms": false
      }
    }
  }
}
```

</ExampleColumn>
</Section>

<Section title="Get a preference set" slug="get-preferences">
<ContentColumn>

Retrieve a user's preference object. Will always return an empty preference object,
even if it does not currently exist for the user.

### Endpoint

<Endpoint
  name="get-preferences"
  method="GET"
  path="/users/:user_id/preferences/:id"
/>

### Path parameters

<Attributes>
  <Attribute
    name="user_id"
    type="string"
    description="Unique identifier for the user"
  />
  <Attribute
    name="id"
    type="string"
    description="Unique identifier for the preference set"
  />
</Attributes>

### Response

Returns a `PreferenceSet`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.getPreferences"
  title="Get a users preferences"
/>

```json Response
{
  "__typename": "PreferenceSet",
  "id": "default",
  "workflows": {
    "dinosaurs-loose": {
      "channel_types": {
        "email": true
      }
    }
  },
  "channel_types": {
    "in_app_feed": true,
    "sms": true
  },
  "categories": {
    "park-wide": {
      "channel_types": {
        "sms": false
      }
    }
  }
}
```

</ExampleColumn>
</Section>

<Section title="Set preferences" slug="set-preferences">
<ContentColumn>

Sets preferences within the given preference set. This is a destructive operation and
will replace any existing preferences with the preferences given.

### Endpoint

<Endpoint
  name="set-preferences"
  method="PUT"
  path="/users/:user_id/preferences/:id"
/>

### Path parameters

<Attributes>
  <Attribute
    name="user_id"
    type="string"
    description="Unique identifier for the user"
  />
  <Attribute
    name="id"
    type="string"
    description="Unique identifier for the preference set"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="channel_types"
    type="object"
    description="A set of channel type preferences"
  />
  <Attribute
    name="workflows"
    type="object"
    description="A set of workflow preferences, can be a boolean or an object containing channel type preferences"
  />
  <Attribute
    name="categories"
    type="object"
    description="A set of category preferences, can be a boolean or an object containing channel type preferences"
  />
</Attributes>

### Response

Returns a `PreferenceSet`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.setPreferences"
  title="Set a users preferences"
/>

```json Response
{
  "__typename": "PreferenceSet",
  "id": "default",
  "workflows": {
    "dinosaurs-loose": {
      "channel_types": {
        "email": true,
        "sms": true
      }
    }
  },
  "channel_types": {
    "in_app_feed": true
  },
  "categories": {
    "park-wide": {
      "sms": false
    }
  }
}
```

</ExampleColumn>
</Section>

<Section title="Bulk set preferences" slug="bulk-set-preferences">
<ContentColumn>

Sets the preferences for the users indicated via an asynchronous `BulkOperation`. This is a destructive operation and
will replace any existing users' preferences with the preferences sent.

### Endpoint

<Endpoint
  name="bulk-set-preferences"
  method="POST"
  path="/users/bulk/preferences"
/>

### Body parameters

<Attributes>
  <Attribute
    name="user_ids"
    type="string[]"
    description="A list of user ids to set preferences for (up to 100)"
  />
  <Attribute
    name="preferences.id"
    type="string"
    description="The id of the preference set"
  />
  <Attribute
    name="preferences.channel_types"
    type="object"
    description="A set of channel type preferences to set"
  />
  <Attribute
    name="preferences.workflows"
    type="object"
    description="A set of workflow preferences, can be a boolean or an object containing channel type preferences"
  />
  <Attribute
    name="preferences.categories"
    type="object"
    description="A set of categories preferences, can be a boolean or an object containing channel type preferences"
  />
</Attributes>

### Response

Returns a `BulkOperation`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.bulkSetPreferences"
  title="Bulk set many users preferences"
/>

```json Response
{
  "__typename": "BulkOperation",
  "completed_at": nil,
  "estimated_total_rows": 42,
  "failed_at": nil,
  "id": "b4f6f61e-3634-4e80-af0d-9c83e9acc6f3",
  "name": "bulk_op",
  "processed_rows": 0,
  "progress_path": "/v1/bulk_operations/b4f6f61e-3634-4e80-af0d-9c83e9acc6f3",
  "started_at": nil,
  "status": "queued",
  "inserted_at": "2021-03-05T12:00:00Z",
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Channel data" slug="channel-data">
<ContentColumn>

Channel data is channel-specific information stored on a Knock [user](/reference#users) or [object](/reference#objects) that's needed to deliver a notification to an end provider.

For a push channel, this includes device-specific tokens that map the recipient to the device they use. For chat apps, such as Slack, this includes the access token used to send
notifications to a customer's Slack channel.

### Attributes

<Attributes>
  <Attribute
    name="channel_id"
    type="string"
    description="The UUID of the channel this data belongs to"
  />
  <Attribute
    name="data"
    type="object"
    description="The provider specific channel data"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint
    name="get-user-channel-data"
    method="GET"
    path="/users/:user_id/channel_data/:channel_id"
  />
  <Endpoint
    name="set-user-channel-data"
    method="PUT"
    path="/users/:user_id/channel_data/:channel_id"
  />
  <Endpoint
    name="get-object-channel-data"
    method="GET"
    path="/object/:collection/:object_id/channel_data/:channel_id"
  />
  <Endpoint
    name="set-object-channel-data"
    method="PUT"
    path="/object/:collection/:object_id/channel_data/:channel_id"
  />
</Endpoints>

```json ChannelData object
{
  "__typename": "ChannelData",
  "channel_id": "c2189f43-c732-488a-bfa0-fdf16e145cdf",
  "data": {
    "tokens": ["some-fcm-token"]
  }
}
```

</ExampleColumn>
</Section>

<Section title="Getting user channel data" slug="get-user-channel-data">
<ContentColumn>

Retrieves the channel data for the provided user (or object) on the channel specified.

### Endpoint

<Endpoint method="GET" path="/users/:user_id/channel_data/:channel_id" />

### Path parameters

<Attributes>
  <Attribute
    name="user_id"
    type="string"
    description="The id of the user to lookup"
  />
  <Attribute
    name="channel_id"
    type="string"
    description="The id of the channel to lookup"
  />
</Attributes>

### Returns

- `200` with a `ChannelData` object (when found)
- `404` when not found

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.getChannelData"
  title="Get a users channel data"
/>

</ExampleColumn>
</Section>

<Section title="Setting user channel data" slug="set-user-channel-data">
<ContentColumn>

Sets channel data for the user and the channel specified.

### Endpoint

<Endpoint method="PUT" path="/users/:user_id/channel_data/:channel_id" />

### Path parameters

<Attributes>
  <Attribute
    name="user_id"
    type="string"
    description="The id of the user to lookup"
  />
  <Attribute
    name="channel_id"
    type="string"
    description="The id of the channel to lookup"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="data"
    type="object"
    description="The data to set for this channel, shape of the payload varies depending on the channel"
  />
</Attributes>

### Returns

- `200` with a `ChannelData` object (when set)
- `400` when the channel specified cannot be found
- `422` with errors when the data is incorrectly shaped

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="users.setChannelData"
  title="Set a users channel data"
/>

</ExampleColumn>
</Section>

<Section title="Getting object channel data" slug="get-object-channel-data">
<ContentColumn>

Retrieves the channel data for the provided user (or object) on the channel specified.

### Endpoint

<Endpoint
  method="GET"
  path="/objects/:collection/:object_id/channel_data/:channel_id"
/>

### Path parameters

<Attributes>
  <Attribute
    name="object_id"
    type="string"
    description="The id of the object to lookup"
  />
  <Attribute
    name="collection"
    type="string"
    description="The parent collection of the object to lookup"
  />
  <Attribute
    name="channel_id"
    type="string"
    description="The id of the channel to lookup"
  />
</Attributes>

### Returns

- `200` with a `ChannelData` (when found)
- `404` when not found

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.getChannelData"
  title="Get an objects channel data"
/>

</ExampleColumn>
</Section>

<Section title="Setting object channel data" slug="set-object-channel-data">
<ContentColumn>

Sets channel data for the object and the channel specified.

### Endpoint

<Endpoint
  method="PUT"
  path="/objects/:collection/:object_id/channel_data/:channel_id"
/>

### Path parameters

<Attributes>
  <Attribute
    name="object_id"
    type="string"
    description="The id of the object to lookup"
  />
  <Attribute
    name="collection"
    type="string"
    description="The parent collection of the object to lookup"
  />
  <Attribute
    name="channel_id"
    type="string"
    description="The id of the channel to lookup"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="data"
    type="object"
    description="The data to set for this channel, shape of the payload varies depending on the channel"
  />
</Attributes>

### Returns

- `200` with a `ChannelData` object (when set)
- `400` when the channel specified cannot be found
- `422` with errors when the data is incorrectly shaped

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.setChannelData.slack"
  title="Set an object's channel data"
/>

</ExampleColumn>
</Section>

<Section title="Feeds" slug="feeds">
<ContentColumn>

A feed exposes the messages delivered to an in-app feed channel, formatted specially to be consumed
in a notification feed.

A feed will always return a list of `FeedItems`, which are pointers to a message delivered and contain
all of the information needed in order to render an item within a notification feed.

**Note: feeds are a specialized form of messages that are designed purely for in-app rendering, and
as such return information that is required on the client to do so**

### Attributes

<Attributes>
  <Attribute
    name="entries"
    type="FeedItem[]"
    description="An ordered list of feed items (most recent first)"
  />
  <Attribute
    name="page_info"
    type="PageInfo"
    description="Pagination information for the items returned"
  />
  <Attribute
    name="vars"
    type="object"
    description="Environment specific account variables"
  />
  <Attribute
    name="meta"
    type="FeedMetadata"
    description="Information about the total unread and unseen items"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint method="GET" path="/users/:user_id/feeds/:feed_id" />
</Endpoints>

```json Response
{
  "entries": [
    {
      "__typename": "FeedItem",
      "__cursor": "g3QAAAABZAACaWRtAAAAGzFzTXRJc1J2WnRZZjg2YU9ma00yUENwQzZYYw==",
      "activities": [
        {
          "__typename": "Activity",
          "actor": {
            "__typename": "User",
            "id": "c121a5ea-8f2c-4c60-ab40-9966047d5bea",
            "created_at": null,
            "updated_at": "2021-05-08T20:40:01.340Z",
            "email": "some-user@knock.app",
            "name": "Some User"
          },
          "data": {
            "dest_environment_name": "Production",
            "src_environment_name": "Development",
            "total_merged": 1
          },
          "id": "1sMtIwNnDIV52a8G8kmymzDVExQ",
          "inserted_at": "2021-05-11T00:50:09.895759Z",
          "recipient": {
            "__typename": "User",
            "id": "c121a5ea-8f2c-4c60-ab40-9966047d5bea",
            "created_at": null,
            "updated_at": "2021-05-08T20:40:01.340Z",
            "email": "some-user@knock.app",
            "name": "Some User"
          },
          "updated_at": "2021-05-11T00:50:09.895759Z"
        }
      ],
      "actors": [
        {
          "__typename": "User",
          "id": "c121a5ea-8f2c-4c60-ab40-9966047d5bea",
          "created_at": null,
          "updated_at": "2021-05-08T20:40:01.340Z",
          "email": "some-user@knock.app",
          "name": "Some User"
        }
      ],
      "archived_at": null,
      "blocks": [
        {
          "content": "**{{ actor.name }}** merged {{ total_merged }} {% if total_merged == 1 %} change {% else %} changes {% endif %}\nfrom **{{ src_environment_name }}** into **{{ dest_environment_name }}**.",
          "name": "body",
          "rendered": "<p><strong>The person</strong> merged 1  change \nfrom <strong>Development</strong> into <strong>Production</strong>.</p>",
          "type": "markdown"
        },
        {
          "content": "{{ vars.app_url }}/{{ account_slug }}/commits",
          "name": "action_url",
          "rendered": "https://example.com/thing/commits",
          "type": "text"
        }
      ],
      "data": {
        "dest_environment_name": "Production",
        "src_environment_name": "Development",
        "total_merged": 1
      },
      "id": "1sMtIsRvZtYf86aOfkM2PCpC6Xc",
      "inserted_at": "2021-05-11T00:50:09.904531Z",
      "read_at": "2021-05-13T02:45:28.559124Z",
      "seen_at": "2021-05-11T00:51:43.617550Z",
      "source": {
        "__typename": "WorkflowSource",
        "key": "merged-changes",
        "version_id": "7251cd3f-0028-4d1a-9466-ee79522ba3de"
      },
      "tenant": null,
      "total_activities": 1,
      "total_actors": 1,
      "updated_at": "2021-05-13T02:45:28.559863Z"
    }
  ],
  "vars": {
    "app_name": "The app name"
  },
  "meta": {
    "__typename": "FeedMetadata",
    "unread_count": 0,
    "unseen_count": 0
  },
  "page_info": {
    "__typename": "PageInfo",
    "after": null,
    "before": null,
    "page_size": 50
  }
}
```

</ExampleColumn>
</Section>

<Section title="Get feed for user" slug="get-feed">
<ContentColumn>

Retrieves a feed of items for a given `user_id` on the given `feed_id`.

**Note: if you're making this call from a client-side environment you should be using your publishable key
along with a user token to make this request**

### Endpoint

<Endpoint method="GET" path="/users/:user_id/feeds/:feed_id" />

### Path parameters

<Attributes>
  <Attribute name="user_id" type="string" description="The ID of the user" />
  <Attribute
    name="feed_id"
    type="string"
    description="The ID of the feed (the channel ID)"
  />
</Attributes>

### Query parameters

<Attributes>
  <Attribute
    name="page_size"
    type="number"
    description="The total number to retrieve per page (defaults to 50)"
  />
  <Attribute
    name="after"
    type="string"
    description="The cursor to retrieve items after (hint: use the `__cursor` field)"
  />
  <Attribute
    name="before"
    type="string"
    description="The cursor to retrieve items before (hint: use the `__cursor` field)"
  />
  <Attribute
    name="source"
    type="string (optional)"
    description="Limits the feed to only items of the source workflow"
  />
  <Attribute
    name="tenant"
    type="string (optional)"
    description="Limits the feed to only display items with the corresponding tenant, or where the tenant is empty"
  />
  <Attribute
    name="status"
    type="string (optional)"
    description="One of `unread`,`read`, `unseen`,`seen`, `all`"
  />
  <Attribute
    name="include_archived"
    type="boolean (optional)"
    description="Limits the feed to only display items that have or have not been archived (defaults to false)"
  />
</Attributes>

### Returns

A feed response.

</ContentColumn>
</Section>

<Section title="Messages" slug="messages">
<ContentColumn>

A message is a notification delivered on a particular channel to a user.

### Attributes

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="The unique ID of this message"
  />
  <Attribute
    name="channel_id"
    type="string"
    description="The ID of the channel for where this message was delivered"
  />
  <Attribute
    name="recipient"
    type="string"
    description="The ID of the user who received the message"
  />
  <Attribute
    name="workflow"
    type="string"
    description="The key of the workflow that this message was generated from"
  />
  <Attribute
    name="tenant"
    type="string"
    description="The ID of the tenant that this message belongs to"
  />
  <Attribute
    name="status"
    type="string"
    description="One of `queued`, `sent`, `delivered`, `undelivered`, `seen`, `unseen`"
  />
  <Attribute
    name="read_at"
    type="string (optional)"
    description="When the message was last read"
  />
  <Attribute
    name="seen_at"
    type="string (optional)"
    description="When the message was last seen"
  />
  <Attribute
    name="archived_at"
    type="string (optional)"
    description="When the message was archived"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint method="PUT" path="/messages/:id/:status" />
  <Endpoint method="DELETE" path="/messages/:id/:status" />
  <Endpoint method="POST" path="/messages/batch/:status" />
  <Endpoint method="POST" path="/channels/:id/messages/bulk/:status" />
</Endpoints>

```json Message object
{
  "__typename": "Message",
  "id": "1rjI9XBgWQ6EUA3D3Ul3VjUimOD",
  "channel_id": "0bfd9f86-56b0-41f0-ade3-dc5cc6a69bb8",
  "recipient": "user_12345",
  "workflow": "new-comment",
  "tenant": null,
  "status": "delivered",
  "read_at": null,
  "seen_at": null,
  "archived_at": null,
  "inserted_at": "2021-03-05T12:00:00Z",
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Updating a message status" slug="update-message-status">
<ContentColumn>

Marks the given message as the `status`, recording an event in the process.

### Endpoint

<Endpoint method="PUT" path="/messages/:id/:status" />

### Path parameters

<Attributes>
  <Attribute name="id" type="string" description="The ID of the message" />
  <Attribute
    name="status"
    type="enum"
    description="One of `seen`, `read`, `archived`"
  />
</Attributes>

### Returns

A Message.

</ContentColumn>
</Section>

<Section title="Undoing a message status change" slug="undo-message-status">
<ContentColumn>

Un-marks the given message as the `status`, recording an event in the process.

### Endpoint

<Endpoint method="DELETE" path="/messages/:id/:status" />

### Path parameters

<Attributes>
  <Attribute name="id" type="string" description="The ID of the message" />
  <Attribute
    name="status"
    type="enum"
    description="One of `seen`, `read`, `archived`"
  />
</Attributes>

### Returns

A Message.

</ContentColumn>
</Section>

<Section title="Batch changing message statuses" slug="batch-update-message-status">
<ContentColumn>

Multiple messages can be changed at once using the batch API, where all message ids given in will have their statuses changed.

### Endpoint

<Endpoint method="POST" path="/messages/batch/:status" />

### Path parameters

<Attributes>
  <Attribute
    name="status"
    type="enum"
    description="One of `seen`, `read`, `archived` or `unseen`, `unread`, `unarchived`"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="message_ids"
    type="string[]"
    description="A list of one or more message IDs"
  />
</Attributes>

### Returns

A list of Messages that were mutated during the call.

</ContentColumn>
</Section>

<Section title="Bulk changing message statuses in a channel" slug="bulk-update-channel-message-status">
<ContentColumn>

The bulk change endpoint allows you to modify all, or a subset of messages for a given channel via an asynchronous job. The messages
to be modified can be filtered using the properties listed below, and this operation will always return a `BulkOperation`
which allows you to track the status of the job.

### Endpoint

<Endpoint method="POST" path="/channels/:id/messages/bulk/:status" />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="The ID of a channel that you wish to modify messages under"
  />
  <Attribute
    name="status"
    type="enum"
    description="One of `seen`, `read`, `archive` or `unseen`, `unread`, `unarchive`"
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="user_ids"
    type="string[]"
    description="Scope the bulk update to one or more users (optional)"
  />
  <Attribute
    name="older_than"
    type="string"
    description="An ISO-8601 timestamp to find messages created before (optional)"
  />
  <Attribute
    name="newer_than"
    type="string"
    description="An ISO-8601 timestamp to find messages created after (optional)"
  />
  <Attribute
    name="delivery_status"
    type="enum"
    description="Limit messages to one of `queued`, `sent`, `delivered`, `undelivered` (optional)"
  />
  <Attribute
    name="engagement_status"
    type="enum"
    description="Limit messages to one of `seen`, `unseen`, `read`, `unread`, `archived`, `unarchived` (optional)"
  />
</Attributes>

### Returns

A `BulkOperation`

</ContentColumn>
</Section>

<Section title="Bulk operations" slug="bulk-operations">
<ContentColumn>

A bulk operation represents a set of changes that are to be performed across 0 or more records. The
bulk operation resource represents the state of the operation, including recording the number of rows
that have been modified during the operation.

Please note here: the `estimated_total_rows` field may have a different value to the `processed_rows`
field due to the asynchronous nature of the operation. If you wish to pin this job to a specific point in
time, you can initiate it with a date filter (like `older_than`).

### Attributes

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="The unique ID of this bulk operation"
  />
  <Attribute
    name="name"
    type="string"
    description="The type of operation being performed"
  />
  <Attribute
    name="estimated_total_rows"
    type="integer"
    description="An approximation of the number of rows that will be mutated in this operation"
  />
  <Attribute
    name="processed_rows"
    type="integer"
    description="The number of the rows that have been mutated in this operation"
  />
  <Attribute
    name="status"
    type="enum"
    description="One of `queued`, `processing`, `completed`, `failed`"
  />
  <Attribute
    name="started_at"
    type="string"
    description="An ISO-8601 datetime string for when the operation started processing"
  />
  <Attribute
    name="completed_at"
    type="string"
    description="An ISO-8601 datetime string for when the operation completed processing"
  />
  <Attribute
    name="failed_at"
    type="string"
    description="An ISO-8601 datetime string for when the operation failed processing"
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint method="GET" path="/bulk_operations/:id" />
</Endpoints>

```json BulkOperation object
{
  "__typename": "BulkOperation",
  "completed_at": nil,
  "estimated_total_rows": 42,
  "failed_at": nil,
  "id": "b4f6f61e-3634-4e80-af0d-9c83e9acc6f3",
  "name": "bulk_op",
  "processed_rows": 0,
  "progress_path": "/v1/bulk_operations/b4f6f61e-3634-4e80-af0d-9c83e9acc6f3",
  "started_at": nil,
  "status": "queued",
  "inserted_at": "2021-03-05T12:00:00Z",
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Retrieve a bulk operation" slug="bulk-operation-status">
<ContentColumn>

Retrieve the bulk operation, revealing the current status and the number of rows processed. You can poll this endpoint
to understand when a bulk operation has finished executing (either completed, or failed).

### Endpoint

<Endpoint method="GET" path="/bulk_operations/:id" />

### Path parameters

<Attributes>
  <Attribute
    name="id"
    type="string"
    description="The ID of a bulk operation to retrieve"
  />
</Attributes>

### Returns

A `BulkOperation`

</ContentColumn>
</Section>

<Section title="Objects" slug="objects">
<ContentColumn>

An Object represents a resource in your system that you've stored in Knock.

The most common use case for objects is as a store for non-user [channel data](/send-notifications/setting-channel-data)
when sending [Slack notifications](/integrations/slack).

### Attributes

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
  <Attribute
    name="id"
    type="string"
    description="A unique identifier for the object within the collection."
  />
  <Attribute
    name="properties"
    type="object"
    description="An object of key-value pairs for attributes you want to associate with the object. Each collection has its own schema in Knock as
    defined by these properties."
  />
</Attributes>

</ContentColumn>
<ExampleColumn>

<Endpoints>
  <Endpoint name="get-object" method="GET" path="/objects/:collection/:id" />
  <Endpoint name="set-object" method="PUT" path="/objects/:collection/:id" />
  <Endpoint
    name="delete-object"
    method="DELETE"
    path="/objects/:collection/:id"
  />
  <Endpoint
    name="bulk-set-object"
    method="POST"
    path="/objects/:collection/bulk/set"
  />
  <Endpoint
    name="bulk-delete-object"
    method="POST"
    path="/objects/:collection/bulk/delete"
  />
</Endpoints>

```json Object
{
  "__typename": "Object",
  "id": "project-123",
  "collection": "projects",
  "properties": {
    "name": "My project"
  },
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Get an object" slug="get-object">
<ContentColumn>

Retrieve an object in a collection by the id.

### Endpoint

<Endpoint name="get-object" method="GET" path="/objects/:collection/:id" />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
  <Attribute
    name="id"
    type="string"
    description="A unique identifier for the object within the collection."
  />
</Attributes>

### Response

Returns an `Object`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="objects.get" title="Get an object" />

```json Response
{
  "__typename": "Object",
  "id": "project-123",
  "collection": "projects",
  "properties": {
    "name": "My project"
  },
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Set an object" slug="set-object">
<ContentColumn>

Sets an object within a collection, performing an upsert operation. Any existing properties will be merged with the incoming properties.

### Endpoint

<Endpoint name="set-object" method="PUT" path="/objects/:collection/:id" />

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
  <Attribute
    name="id"
    type="string"
    description="A unique identifier for the object within the collection."
  />
</Attributes>

### Body parameters

<Attribute
  name="*"
  type="any"
  description="A collection of key value pairs to set as properties for this object."
/>

### Response

Returns an `Object`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="objects.set" title="Set an object" />

```json Response
{
  "__typename": "Object",
  "id": "project-123",
  "collection": "projects",
  "properties": {
    "name": "My project"
  },
  "created_at": null,
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Delete an object" slug="delete-object">
<ContentColumn>

Deletes an object from a collection by the id provided.

### Endpoint

<Endpoint
  name="delete-object"
  method="DELETE"
  path="/objects/:collection/:id"
/>

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
  <Attribute
    name="id"
    type="string"
    description="A unique identifier for the object within the collection."
  />
</Attributes>

### Response

No response.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock snippet="objects.delete" title="Delete an object" />

</ExampleColumn>
</Section>

<Section title="Bulk set objects in a collection" slug="bulk-set-objects">
<ContentColumn>

Bulk sets up to 100 objects at a time within a collection, returning an asynchronous `BulkOperation` that can be used to monitor the progress of the operation.

### Endpoint

<Endpoint
  name="bulk-set-objects"
  method="POST"
  path="/objects/:collection/bulk/set"
/>

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="objects[].id"
    type="string"
    description="The id of the object to set."
  />
  <Attribute
    name="objects[].*"
    type="any"
    description="Key value pairs to set as properties on this object."
  />
</Attributes>

### Response

Returns a `BulkOperation`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.bulkSet"
  title="Bulk set objects in a collection"
/>

```json Response
{
  "__typename": "BulkOperation",
  "completed_at": nil,
  "estimated_total_rows": 2,
  "failed_at": nil,
  "id": "b4f6f61e-3634-4e80-af0d-9c83e9acc6f3",
  "name": "object.projects.set",
  "processed_rows": 0,
  "progress_path": "/v1/bulk_operations/b4f6f61e-3634-4e80-af0d-9c83e9acc6f3",
  "started_at": nil,
  "status": "queued",
  "inserted_at": "2021-03-05T12:00:00Z",
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>

<Section title="Bulk delete objects in a collection" slug="bulk-delete-objects">
<ContentColumn>

Bulk deletes up to 100 objects at a time within a collection, returning an asynchronous `BulkOperation` that can be used to monitor the progress of the operation.

### Endpoint

<Endpoint
  name="bulk-delete-objects"
  method="POST"
  path="/objects/:collection/bulk/delete"
/>

### Path parameters

<Attributes>
  <Attribute
    name="collection"
    type="string"
    description="The type of object you are storing in Knock."
  />
</Attributes>

### Body parameters

<Attributes>
  <Attribute
    name="object_ids"
    type="string[]"
    description="The ids of the objects to delete within the collection"
  />
</Attributes>

### Response

Returns a `BulkOperation`.

</ContentColumn>
<ExampleColumn>

<MultiLangCodeBlock
  snippet="objects.bulkDelete"
  title="Bulk delete objects in a collection"
/>

```json Response
{
  "__typename": "BulkOperation",
  "completed_at": nil,
  "estimated_total_rows": 2,
  "failed_at": nil,
  "id": "b4f6f61e-3634-4e80-af0d-9c83e9acc6f3",
  "name": "object.projects.delete",
  "processed_rows": 0,
  "progress_path": "/v1/bulk_operations/b4f6f61e-3634-4e80-af0d-9c83e9acc6f3",
  "started_at": nil,
  "status": "queued",
  "inserted_at": "2021-03-05T12:00:00Z",
  "updated_at": "2021-03-05T12:00:00Z"
}
```

</ExampleColumn>
</Section>
