---
title: Setting preferences
---

import MultiLangCodeBlock from "../../components/MultiLangCodeBlock";

You can read more about modeling preferences and preferences in general in the [Preferences](/send-and-manage-data/preferences) guide. In the guide below, we walk through the technical details of integrating the Knock preferences model into your product.

## Backend integration

In the following examples you'll see how to integrate preferences into your backend codebase.

### Getting the user's preferences

You can retrieve a given user's preferences using the `users.getPreferences` method. Please note that even if the preferences are not set for the user you will receive an empty `PreferenceSet` in response.

<MultiLangCodeBlock
  title="Get preferences for a user"
  snippet="users.getPreferences"
/>

### Setting the user's preferences

You can update a user's entire preferences using the `users.setPreferences` method. This will overwrite any existing preferences set for the user:

<MultiLangCodeBlock
  title="Set preferences for a user"
  snippet="users.setPreferences"
/>

### Bulk setting user preferences

You can update the preferences of up to 100 users in a single batch by using the `users.bulkSetPreferences` method. This executes an asynchronous job which will overwrite any existing preferences for the users provided. You can track the progress of the `BulkOperation` returned via the [bulk operation API](/reference#bulk-operations).

<MultiLangCodeBlock
  title="Bulk set preferences for many users"
  snippet="users.bulkSetPreferences"
/>

### Client integration

The preferences API can also be invoked from the client, providing you have authenticated a user first and have a valid API token. Please note only the current user's preferences can be set

### Retrieve the preferences for the current user

```javascript Get preferences
import Knock from "@knocklabs/client";
const knockClient = new Knock("sk_12345");

knockClient.authenticate(currentUser.id, currentUser.knockToken);

// Retrieves the `PreferenceSet` for the user given
const preferences = await knockClient.preferences.get();
```

### Set the preferences for the current user

Preferences can also be updated from the client:

```javascript Setting preferences
import Knock from "@knocklabs/client";
const knockClient = new Knock("sk_12345");

knockClient.authenticate(currentUser.id, currentUser.knockToken);

// Set the entire preference object
await knockClient.preferences.set({
  channel_types: {
    email: true,
  },
  workflows: {
    "dinosaurs-loose": {
      channel_types: {
        email: false,
        in_app_feed: true,
        sms: true,
      },
    },
  },
});

// Update an individual channel type
await knockClient.preferences.setChannelType("email", true);

// Update an individual workflow
await knockClient.preferences.setWorkflow("dinosaurs-loose", {
  channel_types: { email: true },
});
```

### Set preferences for an object

The ability to set notification preferences for an [object](/send-and-manage-data/objects) is not currently supported. If you're interested in us supporting this functionality, please let us know by using the feedback form at the top of this site.
